(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"7mgd":function(t,e,n){(function(t){n("7h0T"),n("hhXQ"),n("OG14"),n("DNiP"),n("91GP"),n("/8Fb"),n("9AAn"),n("dZ+Y"),n("Vd3H"),n("dRSK"),n("Oyvg"),n("knhD"),n("h/M4"),n("fN96"),n("NO8f"),n("bWfx"),n("0l/t"),n("9XZr"),n("SRfc"),n("XfO3"),n("T39b"),n("LK8F"),n("xfY5"),n("Tze0"),n("KKXr"),n("8+KV"),n("eM6i"),n("V+eJ"),n("2Spj"),n("rGqo"),n("yt8O"),n("RW0V"),n("a1Th"),n("h7Nl"),n("pIFo"),n("HAE/"),n("f3/d"),n("jqX0"),n("rE2o"),n("ioFf"),n("VRzm"),n("Btvt"),n("hHhE"),n("/SS/"),function(e){"use strict";try{(function(){e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;var n,r,i,o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function s(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function u(t,e,n,r){return new(n=n||Promise)((function(i,o){function s(t){try{a(r.next(t))}catch(t){o(t)}}function u(t){try{a(r.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):((e=t.value)instanceof n?e:new n((function(t){t(e)}))).then(s,u)}a((r=r.apply(t,e||[])).next())}))}function a(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=0<(i=s.trys).length&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(u){o=[6,u],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}function h(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function c(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function f(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=p[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,c(["["+i+"]  "+t.name+":"],n))}}(i=r=r||{})[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT",r.DEBUG,r.VERBOSE,r.INFO,r.WARN,r.ERROR,r.SILENT;var l=r.INFO,p=((n={})[r.DEBUG]="log",n[r.VERBOSE]="log",n[r.INFO]="info",n[r.WARN]="warn",n[r.ERROR]="error",n),d=(Object.defineProperty(y.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in r))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!0,configurable:!0}),y.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,c([this,r.DEBUG],t)),this._logHandler.apply(this,c([this,r.DEBUG],t))},y.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,c([this,r.VERBOSE],t)),this._logHandler.apply(this,c([this,r.VERBOSE],t))},y.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,c([this,r.INFO],t)),this._logHandler.apply(this,c([this,r.INFO],t))},y.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,c([this,r.WARN],t)),this._logHandler.apply(this,c([this,r.WARN],t))},y.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,c([this,r.ERROR],t)),this._logHandler.apply(this,c([this,r.ERROR],t))},y);function y(t){this.name=t,this._logLevel=l,this._logHandler=f,this._userLogHandler=null}function v(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var g,m=(s(w,g=Error),w);function w(t,e){var n=g.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,b.prototype.create),n}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(T,(function(t,e){var n=r[e];return null!=n?n.toString():"<"+e+"?>"}))):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new m(o,a),c=0,f=Object.keys(i);c<f.length;c++){var l=f[c];"_"!==l.slice(-1)&&(l in h&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),h[l]=i[l])}return h},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var T=/\{\$([^}]+)}/g,I=(N.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},N.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},N.prototype.setServiceProps=function(t){return this.serviceProps=t,this},N);function N(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var _,S="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},k=k||{},D=S||self;function x(){}function O(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function R(t){var e=O(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var V="closure_uid_"+(1e9*Math.random()>>>0),L=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function M(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function U(t,e,n){return(U=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:M).apply(null,arguments)}function j(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var q=Date.now||function(){return+new Date};function F(t,e){function n(){}n.prototype=e.prototype,t.M=e.prototype,t.prototype=new n,t.prototype.constructor=t}function B(){this.j=this.j,this.i=this.i}B.prototype.j=!1,B.prototype.da=function(){var t;!this.j&&(this.j=!0,this.C(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,V)&&t[V]||(t[V]=++L))},B.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var G=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},z=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function W(t){return Array.prototype.concat.apply([],arguments)}function Q(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function K(t){return/^[\s\xa0]*$/.test(t)}var H,Y=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function $(t,e){return t<e?-1:e<t?1:0}t:{var J=D.navigator;if(J){var Z=J.userAgent;if(Z){H=Z;break t}}H=""}function tt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function et(t){var e={};for(var n in t)e[n]=t[n];return e}var nt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<nt.length;o++)n=nt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function it(t){return it[" "](t),t}it[" "]=x;var ot,st,ut=X(H,"Opera"),at=X(H,"Trident")||X(H,"MSIE"),ht=X(H,"Edge"),ct=ht||at,ft=X(H,"Gecko")&&!(X(H.toLowerCase(),"webkit")&&!X(H,"Edge"))&&!(X(H,"Trident")||X(H,"MSIE"))&&!X(H,"Edge"),lt=X(H.toLowerCase(),"webkit")&&!X(H,"Edge");function pt(){var t=D.document;return t?t.documentMode:void 0}t:{var dt="",yt=(st=H,ft?/rv:([^\);]+)(\)|;)/.exec(st):ht?/Edge\/([\d\.]+)/.exec(st):at?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(st):lt?/WebKit\/(\S+)/.exec(st):ut?/(?:Version)[ \/]?(\S+)/.exec(st):void 0);if(yt&&(dt=yt?yt[1]:""),at){var vt=pt();if(null!=vt&&vt>parseFloat(dt)){ot=String(vt);break t}}ot=dt}var gt={};function mt(t){return e=t,n=function(){for(var e=0,n=Y(String(ot)).split("."),r=Y(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=$(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||$(0==s[2].length,0==u[2].length)||$(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e},r=gt,Object.prototype.hasOwnProperty.call(r,e)?r[e]:r[e]=n();var e,n,r}var wt=D.document&&at&&(pt()||parseInt(ot,10))||void 0,bt=!at||9<=Number(wt),Et=at&&!mt("9"),Tt=function(){if(!D.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{D.addEventListener("test",x,e),D.removeEventListener("test",x,e)}catch(t){}return t}();function It(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Nt(t,e){if(It.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ft){t:{try{it(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:At[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}It.prototype.b=function(){this.defaultPrevented=!0},F(Nt,It);var At={2:"touch",3:"pen",4:"mouse"};Nt.prototype.b=function(){Nt.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Et)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var _t="closure_listenable_"+(1e6*Math.random()|0),St=0;function kt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.aa=i,this.key=++St,this.V=this.X=!1}function Dt(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function xt(t){this.src=t,this.a={},this.b=0}function Ot(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=G(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Dt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Rt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.V&&o.listener==e&&o.capture==!!n&&o.aa==r)return i}return-1}xt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Rt(t,e,r,i);return-1<s?(e=t[s],n||(e.X=!1)):((e=new kt(e,this.src,o,!!r,i)).X=n,t.push(e)),e};var Pt="closure_lm_"+(1e6*Math.random()|0),Vt={};function Lt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Gt(r),e&&e[_t]?e.sa(n,r,P(i)?!!i.capture:!!i,o):Ct(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Lt(t,e[o],n,r,i);return null}return n=Gt(n),t&&t[_t]?t.ra(e,n,P(r)?!!r.capture:!!r,i):Ct(t,e,n,!1,r,i)}function Ct(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=P(i)?!!i.capture:!!i;if(s&&!bt)return null;var u,a,h=Ft(t);if(h||(t[Pt]=h=new xt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=qt,r=a=bt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)Tt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ut(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Mt(t){if("number"!=typeof t&&t&&!t.V){var e=t.src;if(e&&e[_t])Ot(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ut(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ft(e))?(Ot(n,t),0==n.b&&(n.src=null,e[Pt]=null)):Dt(t)}}}function Ut(t){return t in Vt?Vt[t]:Vt[t]="on"+t}function jt(t,e){var n=t.listener,r=t.aa||t.src;return t.X&&Mt(t),n.call(r,e)}function qt(t,e){if(t.V)return!0;if(bt)return jt(t,new Nt(e,this));if(!e)t:{e=["window","event"];for(var n=D,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return jt(t,e=new Nt(e,this))}function Ft(t){return(t=t[Pt])instanceof xt?t:null}var Bt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Gt(t){return"function"==O(t)?t:(t[Bt]||(t[Bt]=function(e){return t.handleEvent(e)}),t[Bt])}function zt(){B.call(this),this.c=new xt(this),(this.J=this).A=null}function Wt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.V&&s.capture==n){var u=s.listener,a=s.aa||s.src;s.X&&Ot(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}F(zt,B),zt.prototype[_t]=!0,(_=zt.prototype).addEventListener=function(t,e,n,r){Lt(this,t,e,n,r)},_.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=P(i)?!!i.capture:!!i,r=Gt(r),e&&e[_t]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Rt(s=e.a[n],r,i,o))&&(Dt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ft(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Rt(n,r,i,o)),(r=-1<e?n[e]:null)&&Mt(r))}(this,t,e,n,r)},_.dispatchEvent=function(t){var e,n=this.A;if(n)for(e=[];n;n=n.A)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t)t=new It(t,n);else if(t instanceof It)t.target=t.target||n;else{var i=t;rt(t=new It(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];i=Wt(s,r,!0,t)&&i}if(i=Wt(s=t.a=n,r,!0,t)&&i,i=Wt(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Wt(s=t.a=e[o],r,!1,t)&&i;return i},_.C=function(){if(zt.M.C.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Dt(n[r]);delete e.a[t],e.b--}}this.A=null},_.ra=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},_.sa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Qt=D.JSON.stringify;function Kt(){this.b=this.a=null}var Ht,Yt=(Xt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Xt((function(){return new $t}),(function(t){t.reset()}),100));function Xt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function $t(){this.next=this.b=this.a=null}function Jt(t){D.setTimeout((function(){throw t}),0)}function Zt(t,e){var n;Ht||(n=D.Promise.resolve(void 0),Ht=function(){n.then(ne)}),te||(Ht(),te=!0),ee.add(t,e)}Kt.prototype.add=function(t,e){var n=Yt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},$t.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var te=!($t.prototype.reset=function(){this.next=this.b=this.a=null}),ee=new Kt;function ne(){for(var t;r=n=void 0,r=null,(n=ee).a&&(r=n.a,n.a=n.a.next,n.a||(n.b=null),r.next=null),t=r;){try{t.a.call(t.b)}catch(t){Jt(t)}var e=Yt;e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)}var n,r;te=!1}function re(t,e){zt.call(this),this.b=t||1,this.a=e||D,this.f=U(this.Ua,this),this.g=q()}function ie(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function oe(t,e,n){if("function"==O(t))n&&(t=U(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=U(t.handleEvent,t)}return 2147483647<Number(e)?-1:D.setTimeout(t,e||0)}function se(t,e,n){B.call(this),this.f=null!=n?U(t,n):t,this.c=e,this.b=U(this.Pa,this),this.a=[]}function ue(t){t.T=oe(t.b,t.c),t.f.apply(null,t.a)}function ae(t){B.call(this),this.b=t,this.a={}}F(re,zt),(_=re.prototype).Z=!1,_.L=null,_.Ua=function(){if(this.Z){var t=q()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(ie(this),this.start()))}},_.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=q())},_.C=function(){re.M.C.call(this),ie(this),delete this.a},F(se,B),(_=se.prototype).ba=!1,_.T=null,_.Ia=function(t){this.a=arguments,this.T?this.ba=!0:ue(this)},_.C=function(){se.M.C.call(this),this.T&&(D.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},_.Pa=function(){this.T=null,this.ba&&(this.ba=!1,ue(this))},F(ae,B);var he=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(he[0]=n.toString()),n=he);for(var i=0;i<n.length;i++){var o=Lt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function fe(t){tt(t.a,(function(t,e){this.a.hasOwnProperty(e)&&Mt(t)}),t),t.a={}}function le(){}ae.prototype.C=function(){ae.M.C.call(this),fe(this)},ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var pe=null;function de(){return pe=pe||new zt}function ye(t){It.call(this,"serverreachability",t)}function ve(t){var e=de();e.dispatchEvent(new ye(e))}function ge(t){It.call(this,"statevent",t)}function me(t){var e=de();e.dispatchEvent(new ge(e))}function we(t){It.call(this,"timingevent",t)}function be(t,e){if("function"!=O(t))throw Error("Fn must not be null and must be a function");return D.setTimeout((function(){t()}),e)}F(ye,It),F(ge,It),F(we,It);var Ee={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},Te={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function Ie(){}function Ne(t){var e;return(e=t.a)||(e=t.a={}),e}function Ae(){}Ie.prototype.a=null;var _e,Se={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function ke(){It.call(this,"d")}function De(){It.call(this,"c")}function xe(){}function Oe(t,e,n){this.g=t,this.W=e,this.U=n||1,this.G=new ae(this),this.N=Re,t=ct?125:void 0,this.O=new re(t),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}F(ke,It),F(De,It),F(xe,Ie),_e=new xe;var Re=45e3,Pe={},Ve={};function Le(t,e,n){t.B=1,t.f=rn($e(e)),t.j=n,t.F=!0,Ce(t,null)}function Ce(t,e){t.s=q(),je(t),t.A=$e(t.f);var n=t.A,r=t.U;Array.isArray(r)||(r=[String(r)]),gn(n.b,"t",r),t.w=0,t.a=ar(t.g,t.g.w?e:null),0<t.J&&(t.D=new se(U(t.ya,t,t.a),t.J)),ce(t.G,t.a,"readystatechange",t.Sa),e=t.m?et(t.m):{},t.j?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,e)):(t.v="GET",t.a.$(t.A,t.v,null,e)),ve()}function Me(t,e,n){for(var r=!0;!t.l&&t.w<n.length;){var i=Ue(t,n);if(i==Ve){4==e&&(t.c=4,me(),r=!1);break}if(i==Pe){t.c=4,me(),r=!1;break}ze(t,i)}4==e&&0==n.length&&(t.c=1,me(),r=!1),t.b=t.b&&r,r||(Ge(t),Be(t))}function Ue(t,e){var n=t.w,r=e.indexOf("\n",n);return-1==r?Ve:(n=Number(e.substring(n,r)),isNaN(n)?Pe:(r+=1)+n>e.length?Ve:(e=e.substr(r,n),t.w=r+n,e))}function je(t){t.P=q()+t.N,qe(t,t.N)}function qe(t,e){if(null!=t.h)throw Error("WatchDog timer not null");t.h=be(U(t.Qa,t),e)}function Fe(t){t.h&&(D.clearTimeout(t.h),t.h=null)}function Be(t){0==t.g.u||t.l||rr(t.g,t)}function Ge(t){Fe(t);var e=t.D;e&&"function"==typeof e.da&&e.da(),t.D=null,ie(t.O),fe(t.G),t.a&&(e=t.a,t.a=null,e.abort(),e.da())}function ze(t,e){try{var n=t.g;if(0!=n.u&&(n.a==t||Nn(n.b,t)))if(n.A=t.H,!t.o&&Nn(n.b,t)&&3==n.u){try{var r=n.ja.a.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.i){if(n.a){if(!(n.a.s+3e3<t.s))break t;nr(n),n.a.cancel(),n.a=null}er(n),me()}}else n.ia=i[1],0<n.ia-n.G&&i[2]<37500&&n.U&&0==n.m&&!n.l&&(n.l=be(U(n.Na,n),6e3));if(In(n.b)<=1&&n.O){try{n.O()}catch(t){}n.O=void 0}}else or(n,11)}else if(!t.o&&n.a!=t||nr(n),!K(e))for(e=r=n.ja.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.G=i[0],i=i[1],2==n.u)if("c"==i[0]){n.B=i[1],n.R=i[2];var o=i[3];null!=o&&(n.oa=o);var s=i[5];null!=s&&"number"==typeof s&&0<s&&(n.D=1.5*s);var u=n,a=t.a;if(a){var h=a.a?a.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var c=u.b;!c.a&&(X(h,"spdy")||X(h,"quic")||X(h,"h2"))&&(c.f=c.g,c.a=new Set,c.b&&(An(c,c.b),c.b=null))}if(u.s){var f=a.a?a.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.ha=f,nn(u.v,u.s,f))}}n.u=3,n.c&&n.c.na();var l=t;if((u=n).ea=ur(u,u.w?u.R:null,u.P),l.o){_n(u.b,l);var p=l,d=u.D;d&&p.setTimeout(d),p.h&&(Fe(p),je(p)),u.a=l}else tr(u);0<n.f.length&&Xn(n)}else"stop"!=i[0]&&"close"!=i[0]||or(n,7);else 3==n.u&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?or(n,7):Kn(n):"noop"!=i[0]&&n.c&&n.c.ma(i),n.m=0);ve()}catch(t){}}function We(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(R(t)||"string"==typeof t)z(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.I&&"function"==typeof t.I)n=void 0;else if(R(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"==typeof t)return t.split("");if(R(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Qe)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ke(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];He(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)He(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function He(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(_=Oe.prototype).setTimeout=function(t){this.N=t},_.Sa=function(t){t=t.target;var e=this.D;e&&3==Gn(t)?e.Ia():this.ya(t)},_.ya=function(t){try{if(t==this.a)t:{var e=Gn(this.a),n=this.a.qa();if(this.a.S(),!(e<3||3==e&&!ct&&!this.a.Y())){this.l||4!=e||7==n||ve(),Fe(this);var r=this.a.S();this.H=r;var i=this.a.Y();if(this.b=200==r){if(this.R&&!this.o){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.c=3,me(),Ge(this),Be(this);break t}this.o=!0,ze(this,u)}this.F?(Me(this,e,i),ct&&this.b&&3==e&&(ce(this.G,this.O,"tick",this.Ra),this.O.start())):ze(this,i),4==e&&Ge(this),this.b&&!this.l&&(4==e?rr(this.g,this):(this.b=!1,je(this)))}else 400==r&&0<i.indexOf("Unknown SID")?(this.c=3,me()):(this.c=0,me()),Ge(this),Be(this)}}}catch(t){}},_.Ra=function(){if(this.a){var t=Gn(this.a),e=this.a.Y();this.w<e.length&&(Fe(this),Me(this,t,e),this.b&&4!=t&&je(this))}},_.cancel=function(){this.l=!0,Ge(this)},_.Qa=function(){this.h=null;var t=q();0<=t-this.P?(2!=this.B&&(ve(),me()),Ge(this),this.c=2,Be(this)):qe(this,this.P-t)},(_=Qe.prototype).I=function(){Ke(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},_.K=function(){return Ke(this),this.a.concat()},_.get=function(t,e){return He(this.b,t)?this.b[t]:e},_.set=function(t,e){He(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},_.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ye=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Xe(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Xe){this.a=void 0!==e?e:t.a,Je(this,t.f),this.j=t.j,Ze(this,t.c),tn(this,t.h),this.g=t.g,e=t.b;var n=new pn;n.c=e.c,e.a&&(n.a=new Qe(e.a),n.b=e.b),en(this,n),this.i=t.i}else t&&(n=String(t).match(Ye))?(this.a=!!e,Je(this,n[1]||"",!0),this.j=on(n[2]||""),Ze(this,n[3]||"",!0),tn(this,n[4]),this.g=on(n[5]||"",!0),en(this,n[6]||"",!0),this.i=on(n[7]||"")):(this.a=!!e,this.b=new pn(null,this.a))}function $e(t){return new Xe(t)}function Je(t,e,n){t.f=n?on(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ze(t,e,n){t.c=n?on(e,!0):e}function tn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function en(t,e,n){var r,i;e instanceof pn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(dn(r),r.c=null,r.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(yn(this,e),gn(this,n,t))}),r)),r.f=i):(n||(e=sn(e,fn)),t.b=new pn(e,t.a))}function nn(t,e,n){t.b.set(e,n)}function rn(t){return nn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^q()).toString(36)),t}function on(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function sn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,un),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function un(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Xe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(sn(e,an,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(sn(e,an,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(sn(n,"/"==n.charAt(0)?cn:hn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",sn(n,ln)),t.join("")};var an=/[#\/\?@]/g,hn=/[#\?:]/g,cn=/[#\?]/g,fn=/[#\?@]/g,ln=/#/g;function pn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function dn(t){t.a||(t.a=new Qe,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function yn(t,e){dn(t),e=mn(t,e),He(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,He((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ke(t)))}function vn(t,e){return dn(t),e=mn(t,e),He(t.a.b,e)}function gn(t,e,n){yn(t,e),0<n.length&&(t.c=null,t.a.set(mn(t,e),Q(n)),t.b+=n.length)}function mn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function wn(t,e){this.b=t,this.a=e}function bn(t){this.g=t||En,t=D.PerformanceNavigationTiming?0<(t=D.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(D.ca&&D.ca.ua&&D.ca.ua()&&D.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(_=pn.prototype).add=function(t,e){dn(this),this.c=null,t=mn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},_.forEach=function(t,e){dn(this),this.a.forEach((function(n,r){z(n,(function(n){t.call(e,n,r,this)}),this)}),this)},_.K=function(){dn(this);for(var t=this.a.I(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},_.I=function(t){dn(this);var e=[];if("string"==typeof t)vn(this,t)&&(e=W(e,this.a.get(mn(this,t))));else{t=this.a.I();for(var n=0;n<t.length;n++)e=W(e,t[n])}return e},_.set=function(t,e){return dn(this),this.c=null,vn(this,t=mn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},_.get=function(t,e){return t&&0<(t=this.I(t)).length?String(t[0]):e},_.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.I(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var En=10;function Tn(t){return t.b||t.a&&t.a.size>=t.f}function In(t){return t.b?1:t.a?t.a.size:0}function Nn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function An(t,e){t.a?t.a.add(e):t.b=e}function _n(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Sn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.i);if(null==t.a||0===t.a.size)return Q(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.i)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function kn(){}function Dn(){this.a=new kn}function xn(t,e,n){var r=n||"";try{We(t,(function(t,n){var i=t;P(t)&&(i=Qt(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function On(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}bn.prototype.cancel=function(){var t,e;if(this.c=Sn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},kn.prototype.stringify=function(t){return D.JSON.stringify(t,void 0)},kn.prototype.parse=function(t){return D.JSON.parse(t,void 0)};var Rn=D.JSON.parse;function Pn(t){zt.call(this),this.headers=new Qe,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=Vn,this.B=this.F=!1}F(Pn,zt);var Vn="",Ln=/^https?$/i,Cn=["POST","PUT"];function Mn(t){return"content-type"==t.toLowerCase()}function Un(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,jn(t),Fn(t)}function jn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function qn(t){if(t.b&&void 0!==k&&(!t.s[1]||4!=Gn(t)||2!=t.S()))if(t.l&&4==Gn(t))oe(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==Gn(t)){t.b=!1;try{var e,n=t.S();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.D).match(Ye)[1]||null;if(!o&&D.self&&D.self.location){var s=D.self.location.protocol;o=s.substr(0,s.length-1)}i=!Ln.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Gn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.S()+"]",jn(t)}}finally{Fn(t)}}}function Fn(t,e){if(t.a){Bn(t);var n=t.a,r=t.s[0]?x:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Bn(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(D.clearTimeout(t.m),t.m=null)}function Gn(t){return t.a?t.a.readyState:0}function zn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",tt(n,(function(t,e){i+=e,i+=":",i+=t,i+="\r\n"})),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):nn(t,e,n))}function Wn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Qn(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=Wn("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=Wn("baseRetryDelayMs",5e3,t),this.Ga=Wn("retryDelaySeedMs",1e4,t),this.Da=Wn("forwardChannelMaxRetries",2,t),this.ga=Wn("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new bn(t&&t.concurrentRequestLimit),this.ja=new Dn,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function Kn(t){if(Hn(t),3==t.u){var e=t.H++,n=$e(t.v);nn(n,"SID",t.B),nn(n,"RID",e),nn(n,"TYPE","terminate"),Jn(t,n),(e=new Oe(t,e,void 0)).B=2,e.f=rn($e(n)),n=!1,D.navigator&&D.navigator.sendBeacon&&(n=D.navigator.sendBeacon(e.f.toString(),"")),!n&&D.Image&&((new Image).src=e.f,n=!0),n||(e.a=ar(e.g,null),e.a.$(e.f)),e.s=q(),je(e)}sr(t)}function Hn(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(D.clearTimeout(t.i),t.i=null),nr(t),t.b.cancel(),t.g&&("number"==typeof t.g&&D.clearTimeout(t.g),t.g=null)}function Yn(t,e){t.f.push(new wn(t.Fa++,e)),3==t.u&&Xn(t)}function Xn(t){Tn(t.b)||t.g||(t.g=!0,Zt(t.xa,t),t.o=0)}function $n(t,e){var n;n=e?e.W:t.H++;var r=$e(t.v);nn(r,"SID",t.B),nn(r,"RID",n),nn(r,"AID",t.G),Jn(t,r),t.h&&t.j&&zn(r,t.h,t.j),n=new Oe(t,n,t.o+1),null===t.h&&(n.m=t.j),e&&(t.f=e.i.concat(t.f)),e=Zn(t,n,1e3),n.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),An(t.b,n),Le(n,r,e)}function Jn(t,e){t.c&&We({},(function(t,n){nn(e,n,t)}))}function Zn(t,e,n){n=Math.min(t.f.length,n);var r=t.c?U(t.c.Ha,t.c,t):null;t:for(var i=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{xn(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.f.splice(0,n),e.i=t,r}function tr(t){t.a||t.i||(t.J=1,Zt(t.wa,t),t.m=0)}function er(t){return!(t.a||t.i||3<=t.m)&&(t.J++,t.i=be(U(t.wa,t),ir(t,t.m)),t.m++,1)}function nr(t){null!=t.l&&(D.clearTimeout(t.l),t.l=null)}function rr(t,e){var n=null;if(t.a==e){nr(t),t.a=null;var r=2}else{if(!Nn(t.b,e))return;n=e.i,_n(t.b,e),r=1}if(t.A=e.H,0!=t.u)if(e.b)if(1==r){n=e.j?e.j.length:0,e=q()-e.s;var i=t.o;(r=de()).dispatchEvent(new we(r)),Xn(t)}else tr(t);else if(3==(i=e.c)||0==i&&0<t.A||!(1==r&&function(t,e){if(!(In(t.b)>=t.b.f-(t.g?1:0))){if(t.g)return t.f=e.i.concat(t.f),1;if(!(1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da)))return t.g=be(U(t.xa,t,e),ir(t,t.o)),t.o++,1}}(t,e)||2==r&&er(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:or(t,5);break;case 4:or(t,10);break;case 3:or(t,6);break;default:or(t,2)}}function ir(t,e){var n=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(n*=2),n*e}function or(t,e){if(2==e){var n=null;t.c&&(n=null);var r=U(t.Ta,t);n||(n=new Xe("//www.google.com/images/cleardot.gif"),D.location&&"http"==D.location.protocol||Je(n,"https"),rn(n)),function(t,e){var n=new le;if(D.Image){var r=new Image;r.onload=j(On,n,r,"TestLoadImage: loaded",!0,e),r.onerror=j(On,n,r,"TestLoadImage: error",!1,e),r.onabort=j(On,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=j(On,n,r,"TestLoadImage: timeout",!1,e),D.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else me();t.u=0,t.c&&t.c.la(e),sr(t),Hn(t)}function sr(t){t.u=0,t.A=-1,t.c&&(0==Sn(t.b).length&&0==t.f.length||(t.b.c.length=0,Q(t.f),t.f.length=0),t.c.ka())}function ur(t,e,n){var r,i,o,s,u,a,h=(r=n)instanceof Xe?$e(r):new Xe(r,void 0);if(""!=h.c)e&&Ze(h,e+"."+h.c),tn(h,h.h);else{var c=D.location;i=c.protocol,o=e?e+"."+c.hostname:c.hostname,s=+c.port,u=n,a=new Xe(null,void 0),i&&Je(a,i),o&&Ze(a,o),s&&tn(a,s),u&&(a.g=u),h=a}return t.N&&tt(t.N,(function(t,e){nn(h,e,t)})),e=t.s,n=t.ha,e&&n&&nn(h,e,n),nn(h,"VER",t.oa),Jn(t,h),h}function ar(t,e){if(e&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Pn(t.Ea)).F=t.w,e}function hr(){}function cr(){if(at&&!(10<=Number(wt)))throw Error("Environmental error: no available transport.")}function fr(t,e){zt.call(this),this.a=new Qn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.pa&&(t?t["X-WebChannel-Client-Profile"]=e.pa:t={"X-WebChannel-Client-Profile":e.pa}),this.a.F=t,(t=e&&e.httpHeadersOverwriteParam)&&!K(t)&&(this.a.h=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!K(e)&&(this.a.s=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new dr(this)}function lr(t){ke.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function pr(){De.call(this),this.status=1}function dr(t){this.a=t}(_=Pn.prototype).$=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.G?Ne(this.G):Ne(_e),this.a.onreadystatechange=U(this.va,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Un(this,t)}t=n||"";var i,o=new Qe(this.headers);r&&We(r,(function(t,e){o.set(e,t)})),r=function(t){t:{for(var e=Mn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.K()),n=D.FormData&&t instanceof D.FormData,0<=G(Cn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Bn(this),0<this.o&&((this.B=(i=this.a,at&&mt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=U(this.ta,this)):this.m=oe(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Un(this,t)}},_.ta=function(){void 0!==k&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},_.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Fn(this))},_.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Fn(this,!0)),Pn.M.C.call(this)},_.va=function(){this.j||(this.w||this.l||this.g?qn(this):this.Oa())},_.Oa=function(){qn(this)},_.S=function(){try{return 2<Gn(this)?this.a.status:-1}catch(n){return-1}},_.Y=function(){try{return this.a?this.a.responseText:""}catch(n){return""}},_.Ja=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Rn(e)}},_.qa=function(){return this.h},_.Ma=function(){return"string"==typeof this.f?this.f:String(this.f)},(_=Qn.prototype).oa=8,_.u=1,_.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random());var e,n=new Oe(this,t=this.H++,void 0),r=this.j;if(this.F&&(r?rt(r=et(r),this.F):r=this.F),null===this.h&&(n.m=r),this.fa)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Zn(this,n,e),nn(i=$e(this.v),"RID",t),nn(i,"CVER",22),this.s&&nn(i,"X-HTTP-Session-Id",this.s),Jn(this,i),this.h&&r&&zn(i,this.h,r),An(this.b,n),this.fa?(nn(i,"$req",e),nn(i,"SID","null"),n.R=!0,Le(n,i,null)):Le(n,i,e),this.u=2}}else 3==this.u&&(t?$n(this,t):0==this.f.length||Tn(this.b)||$n(this))},_.wa=function(){this.i=null,this.a=new Oe(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=$e(this.ea);nn(t,"RID","rpc"),nn(t,"SID",this.B),nn(t,"CI",this.U?"0":"1"),nn(t,"AID",this.G),Jn(this,t),nn(t,"TYPE","xmlhttp"),this.h&&this.j&&zn(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var e=this.a,n=this.R;e.B=1,e.f=rn($e(t)),e.j=null,e.F=!0,Ce(e,n)},_.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,er(this),me())},_.Ta=function(t){me()},(_=hr.prototype).na=function(){},_.ma=function(){},_.la=function(){},_.ka=function(){},_.Ha=function(){},cr.prototype.a=function(t,e){return new fr(t,e)},F(fr,zt),(_=fr.prototype).addEventListener=function(t,e,n,r){fr.M.addEventListener.call(this,t,e,n,r)},_.removeEventListener=function(t,e,n,r){fr.M.removeEventListener.call(this,t,e,n,r)},_.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,e=this.l,n=this.b||void 0;me(),t.P=e,t.N=n||{},t.U=t.W,t.v=ur(t,null,t.P),Xn(t)},_.close=function(){Kn(this.a)},_.La=function(t){if("string"==typeof t){var e={};e.__data__=t,Yn(this.a,e)}else this.g?((e={}).__data__=Qt(t),Yn(this.a,e)):Yn(this.a,t)},_.C=function(){this.a.c=null,delete this.f,Kn(this.a),delete this.a,fr.M.C.call(this)},F(lr,ke),F(pr,De),F(dr,hr),dr.prototype.na=function(){this.a.dispatchEvent("a")},dr.prototype.ma=function(t){this.a.dispatchEvent(new lr(t))},dr.prototype.la=function(t){this.a.dispatchEvent(new pr)},dr.prototype.ka=function(){this.a.dispatchEvent("b")},cr.prototype.createWebChannel=cr.prototype.a,fr.prototype.send=fr.prototype.La,fr.prototype.open=fr.prototype.Ka,fr.prototype.close=fr.prototype.close,Ee.NO_ERROR=0,Ee.TIMEOUT=8,Ee.HTTP_ERROR=6,Te.COMPLETE="complete",(Ae.EventType=Se).OPEN="a",Se.CLOSE="b",Se.ERROR="c",Se.MESSAGE="d",zt.prototype.listen=zt.prototype.ra,Pn.prototype.listenOnce=Pn.prototype.sa,Pn.prototype.getLastError=Pn.prototype.Ma,Pn.prototype.getLastErrorCode=Pn.prototype.qa,Pn.prototype.getStatus=Pn.prototype.S,Pn.prototype.getResponseJson=Pn.prototype.Ja,Pn.prototype.getResponseText=Pn.prototype.Y,Pn.prototype.send=Pn.prototype.$;var yr={createWebChannelTransport:function(){return new cr},ErrorCode:Ee,EventType:Te,WebChannel:Ae,XhrIo:Pn},vr=yr.createWebChannelTransport,gr=yr.ErrorCode,mr=yr.EventType,wr=yr.WebChannel,br=yr.XhrIo,Er=e.SDK_VERSION,Tr=(Ir.prototype.t=function(){return null!=this.uid},Ir.prototype.s=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},Ir.prototype.isEqual=function(t){return t.uid===this.uid},Ir);function Ir(t){this.uid=t}function Nr(t,e){this.user=e,this.type="OAuth",this.o={},this.o.Authorization="Bearer "+t}Tr.UNAUTHENTICATED=new Tr(null),Tr.i=new Tr("google-credentials-uid"),Tr.h=new Tr("first-party-uid");var Ar,_r,Sr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},kr=(s(Wr,_r=Error),Wr),Dr=(zr.prototype.getToken=function(){return Promise.resolve(null)},zr.prototype._=function(){},zr.prototype.l=function(t){(this.u=t)(Tr.UNAUTHENTICATED)},zr.prototype.T=function(){this.u=null},zr),xr=(Gr.prototype.getToken=function(){var t=this,e=this.A,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){if(t.A!==e)throw new kr(Sr.ABORTED,"getToken aborted due to token change.");return n?(Zs("string"==typeof n.accessToken),new Nr(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},Gr.prototype._=function(){this.forceRefresh=!0},Gr.prototype.l=function(t){this.u=t,this.R&&t(this.currentUser)},Gr.prototype.T=function(){this.auth&&this.auth.removeAuthTokenListener(this.I),this.I=null,this.u=null},Gr.prototype.m=function(){var t=this.auth&&this.auth.getUid();return Zs(null===t||"string"==typeof t),new Tr(t)},Gr),Or=(Object.defineProperty(Br.prototype,"o",{get:function(){var t={"X-Goog-AuthUser":this.V},e=this.P.auth.g([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),Br),Rr=(Fr.prototype.getToken=function(){return Promise.resolve(new Or(this.P,this.V))},Fr.prototype.l=function(t){t(Tr.h)},Fr.prototype.T=function(){},Fr.prototype._=function(){},Fr),Pr=(qr.now=function(){return qr.fromMillis(Date.now())},qr.fromDate=function(t){return qr.fromMillis(t.getTime())},qr.fromMillis=function(t){var e=Math.floor(t/1e3);return new qr(e,1e6*(t-1e3*e))},qr.prototype.toDate=function(){return new Date(this.toMillis())},qr.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},qr.prototype.p=function(t){return this.seconds===t.seconds?nu(this.nanoseconds,t.nanoseconds):nu(this.seconds,t.seconds)},qr.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},qr.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},qr.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},qr),Vr=(jr.v=function(t){return new jr(t)},jr.min=function(){return new jr(new Pr(0,0))},jr.prototype.S=function(t){return this.timestamp.p(t.timestamp)},jr.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},jr.prototype.D=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},jr.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},jr.prototype.C=function(){return this.timestamp},jr),Lr=(Object.defineProperty(Ur.prototype,"length",{get:function(){return this.F},enumerable:!0,configurable:!0}),Ur.prototype.isEqual=function(t){return 0===Ur.N(this,t)},Ur.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Ur?t.forEach((function(t){e.push(t)})):e.push(t),this.k(e)},Ur.prototype.limit=function(){return this.offset+this.length},Ur.prototype.$=function(t){return t=void 0===t?1:t,this.k(this.segments,this.offset+t,this.length-t)},Ur.prototype.M=function(){return this.k(this.segments,this.offset,this.length-1)},Ur.prototype.L=function(){return this.segments[this.offset]},Ur.prototype.O=function(){return this.get(this.length-1)},Ur.prototype.get=function(t){return this.segments[this.offset+t]},Ur.prototype.B=function(){return 0===this.length},Ur.prototype.q=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Ur.prototype.U=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Ur.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Ur.prototype.W=function(){return this.segments.slice(this.offset,this.limit())},Ur.N=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Ur),Cr=(s(Mr,Ar=Lr),Mr.prototype.k=function(t,e,n){return new Mr(t,e,n)},Mr.prototype.j=function(){return this.W().join("/")},Mr.prototype.toString=function(){return this.j()},Mr.K=function(t){if(0<=t.indexOf("//"))throw new kr(Sr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new Mr(t.split("/").filter((function(t){return 0<t.length})))},Mr);function Mr(){return null!==Ar&&Ar.apply(this,arguments)||this}function Ur(t,e,n){void 0===e?e=0:e>t.length&&Js(),void 0===n?n=t.length-e:n>t.length-e&&Js(),this.segments=t,this.offset=e,this.F=n}function jr(t){this.timestamp=t}function qr(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new kr(Sr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new kr(Sr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new kr(Sr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new kr(Sr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Fr(t,e){this.P=t,this.V=e}function Br(t,e){this.P=t,this.V=e,this.type="FirstParty",this.user=Tr.h}function Gr(t){var e=this;this.I=null,this.currentUser=Tr.UNAUTHENTICATED,this.R=!1,this.A=0,this.u=null,this.forceRefresh=!1,this.I=function(){e.A++,e.currentUser=e.m(),e.R=!0,e.u&&e.u(e.currentUser)},this.A=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.I):(this.I(null),t.get().then((function(t){e.auth=t,e.I&&e.auth.addAuthTokenListener(e.I)}),(function(){})))}function zr(){this.u=null}function Wr(t,e){var n=this;return(n=_r.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}Cr.G=new Cr([]);var Qr,Kr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Hr=(s(Yr,Qr=Lr),Yr.prototype.k=function(t,e,n){return new Yr(t,e,n)},Yr.H=function(t){return Kr.test(t)},Yr.prototype.j=function(){return this.W().map((function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Yr.H(t)||(t="`"+t+"`"),t})).join(".")},Yr.prototype.toString=function(){return this.j()},Yr.prototype.Y=function(){return 1===this.length&&"__name__"===this.get(0)},Yr.J=function(){return new Yr(["__name__"])},Yr.X=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new kr(Sr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new kr(Sr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new kr(Sr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new kr(Sr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Yr(e)},Yr);function Yr(){return null!==Qr&&Qr.apply(this,arguments)||this}Hr.G=new Hr([]);var Xr=($r.Z=function(t){return new $r(Cr.K(t).$(5))},$r.prototype.tt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},$r.prototype.isEqual=function(t){return null!==t&&0===Cr.N(this.path,t.path)},$r.prototype.toString=function(){return this.path.toString()},$r.N=function(t,e){return Cr.N(t.path,e.path)},$r.et=function(t){return t.length%2==0},$r.st=function(t){return new $r(new Cr(t.slice()))},$r);function $r(t){this.path=t}function Jr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Zr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ti(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}Xr.EMPTY=new Xr(new Cr([]));var ei=(ni.fromBase64String=function(t){return new ni(zs.nt().atob(t))},ni.fromUint8Array=function(t){return new ni(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},ni.prototype.toBase64=function(){return zs.nt().btoa(this.it)},ni.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.it)},ni.prototype.rt=function(){return 2*this.it.length},ni.prototype.S=function(t){return nu(this.it,t.it)},ni.prototype.isEqual=function(t){return this.it===t.it},ni);function ni(t){this.it=t}function ri(t){return null==t}function ii(t){return-0===t&&1/t==-1/0}function oi(t){return"number"==typeof t&&Number.isInteger(t)&&!ii(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function si(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ui(t){var e=yi(t.mapValue.fields.__local_write_time__.timestampValue);return new Pr(e.seconds,e.nanos)}ei.ht=new ei("");var ai=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function hi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?si(t)?4:10:Js()}function ci(t,e){var n,r,i,o=hi(t);if(o!==hi(e))return!1;switch(o){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ui(t).isEqual(ui(e));case 3:return function(e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=yi(t.timestampValue),r=yi(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e);case 5:return t.stringValue===e.stringValue;case 6:return i=e,gi(t.bytesValue).isEqual(gi(i.bytesValue));case 7:return t.referenceValue===e.referenceValue;case 8:return r=e,vi((n=t).geoPointValue.latitude)===vi(r.geoPointValue.latitude)&&vi(n.geoPointValue.longitude)===vi(r.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return vi(t.integerValue)===vi(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=vi(t.doubleValue),r=vi(e.doubleValue);return n===r?ii(n)===ii(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return ru(t.arrayValue.values||[],e.arrayValue.values||[],ci);case 10:return function(e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Jr(n)!==Jr(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!ci(n[i],r[i])))return!1;return!0}(e);default:return Js()}}function fi(t,e){return void 0!==(t.values||[]).find((function(t){return ci(t,e)}))}function li(t,e){var n,r,i,o,s,u,a,h,c,f,l=hi(t),p=hi(e);if(l!==p)return nu(l,p);switch(l){case 0:return 0;case 1:return nu(t.booleanValue,e.booleanValue);case 2:return h=e,(c=vi(t.integerValue||t.doubleValue))<(f=vi(h.integerValue||h.doubleValue))?-1:f<c?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1;case 3:return pi(t.timestampValue,e.timestampValue);case 4:return pi(ui(t),ui(e));case 5:return nu(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=gi(o),a=gi(s),u.S(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=nu(n[i],r[i]);if(0!==o)return o}return nu(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=nu(vi(n.latitude),vi(r.latitude)))?i:nu(vi(n.longitude),vi(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=li(n[i],r[i]);if(o)return o}return nu(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=nu(r[s],o[s]);if(0!==u)return u;var a=li(n[r[s]],i[o[s]]);if(0!==a)return a}return nu(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Js()}}function pi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return nu(t,e);var n=yi(t),r=yi(e),i=nu(n.seconds,r.seconds);return 0!==i?i:nu(n.nanos,r.nanos)}function di(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?"time("+(n=yi(e.timestampValue)).seconds+","+n.nanos+")":"stringValue"in e?e.stringValue:"bytesValue"in e?gi(e.bytesValue).toBase64():"referenceValue"in e?(i=e.referenceValue,Xr.Z(i).toString()):"geoPointValue"in e?"geo("+(r=e.geoPointValue).latitude+","+r.longitude+")":"arrayValue"in e?function(){for(var n="[",r=!0,i=0,o=e.arrayValue.values||[];i<o.length;i++)r?r=!1:n+=",",n+=t(o[i]);return n+"]"}():"mapValue"in e?function(e){for(var n="{",r=!0,i=0,o=Object.keys(e.fields||{}).sort();i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=s+":"+t(e.fields[s])}return n+"}"}(e.mapValue):Js();var n,r,i}(t)}function yi(t){if(Zs(!!t),"string"!=typeof t)return{seconds:vi(t.seconds),nanos:vi(t.nanos)};var e=0,n=ai.exec(t);if(Zs(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}function vi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function gi(t){return"string"==typeof t?ei.fromBase64String(t):ei.fromUint8Array(t)}function mi(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.j()}}function wi(t){return t&&"integerValue"in t}function bi(t){return!!t&&"arrayValue"in t}function Ei(t){return t&&"nullValue"in t}function Ti(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ii(t){return t&&"mapValue"in t}var Ni=(Ai.prototype.ot=function(t,e){return n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},t&&(n.fields.__previous_value__=t),{mapValue:n};var n},Ai.prototype.at=function(t,e){return e},Ai.prototype.ut=function(t){return null},Ai.prototype.isEqual=function(t){return t instanceof Ai},Ai);function Ai(){}Ni.instance=new Ni;var _i=(Oi.prototype.ot=function(t,e){return this.apply(t)},Oi.prototype.at=function(t,e){return this.apply(t)},Oi.prototype.apply=function(t){for(var e=Ri(t),n=function(t){e.some((function(e){return ci(e,t)}))||e.push(t)},r=0,i=this.elements;r<i.length;r++)n(i[r]);return{arrayValue:{values:e}}},Oi.prototype.ut=function(t){return null},Oi.prototype.isEqual=function(t){return t instanceof Oi&&ru(this.elements,t.elements,ci)},Oi),Si=(xi.prototype.ot=function(t,e){return this.apply(t)},xi.prototype.at=function(t,e){return this.apply(t)},xi.prototype.apply=function(t){for(var e=Ri(t),n=function(t){e=e.filter((function(e){return!ci(e,t)}))},r=0,i=this.elements;r<i.length;r++)n(i[r]);return{arrayValue:{values:e}}},xi.prototype.ut=function(t){return null},xi.prototype.isEqual=function(t){return t instanceof xi&&ru(this.elements,t.elements,ci)},xi),ki=(Di.prototype.ot=function(t,e){var n=this.ut(t),r=this.asNumber(n)+this.asNumber(this.ct);return wi(n)&&wi(this.ct)?this.serializer._t(r):this.serializer.lt(r)},Di.prototype.at=function(t,e){return e},Di.prototype.ut=function(t){return wi(e=t)||e&&"doubleValue"in e?t:{integerValue:0};var e},Di.prototype.isEqual=function(t){return t instanceof Di&&ci(this.ct,t.ct)},Di.prototype.asNumber=function(t){return vi(t.integerValue||t.doubleValue)},Di);function Di(t,e){this.serializer=t,this.ct=e}function xi(t){this.elements=t}function Oi(t){this.elements=t}function Ri(t){return bi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Pi(t,e){this.version=t,this.transformResults=e}var Vi,Li,Ci,Mi,Ui,ji=(so.prototype.dt=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].q(t))return!0;return!1},so.prototype.isEqual=function(t){return ru(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},so),qi=(oo.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},oo),Fi=(io.ft=function(){return new io},io.exists=function(t){return new io(void 0,t)},io.updateTime=function(t){return new io(t)},Object.defineProperty(io.prototype,"Tt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),io.prototype.Et=function(t){return void 0!==this.updateTime?t instanceof To&&t.version.isEqual(this.updateTime):void 0===this.exists||this.exists===t instanceof To},io.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},io),Bi=(ro.prototype.It=function(t){},ro.wt=function(t){return t instanceof To?t.version:Vr.min()},ro),Gi=(s(no,Ui=Bi),no.prototype.at=function(t,e){this.It(t);var n=e.version;return new To(this.key,n,this.value,{hasCommittedMutations:!0})},no.prototype.ot=function(t,e,n){if(this.It(t),!this.Rt.Et(t))return t;var r=Bi.wt(t);return new To(this.key,r,this.value,{At:!0})},no.prototype.Pt=function(t){return null},no.prototype.isEqual=function(t){return t instanceof no&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Rt.isEqual(t.Rt)},no),zi=(s(eo,Mi=Bi),eo.prototype.at=function(t,e){if(this.It(t),!this.Rt.Et(t))return new No(this.key,e.version);var n=this.gt(t);return new To(this.key,e.version,n,{hasCommittedMutations:!0})},eo.prototype.ot=function(t,e,n){if(this.It(t),!this.Rt.Et(t))return t;var r=Bi.wt(t),i=this.gt(t);return new To(this.key,r,i,{At:!0})},eo.prototype.Pt=function(t){return null},eo.prototype.isEqual=function(t){return t instanceof eo&&this.key.isEqual(t.key)&&this.Vt.isEqual(t.Vt)&&this.Rt.isEqual(t.Rt)},eo.prototype.gt=function(t){var e;return e=t instanceof To?t.data():Hi.empty(),this.pt(e)},eo.prototype.pt=function(t){var e=this,n=new Yi(t);return this.Vt.fields.forEach((function(t){if(!t.B()){var r=e.data.field(t);null!==r?n.set(t,r):n.delete(t)}})),n.yt()},eo),Wi=(s(to,Ci=Bi),to.prototype.at=function(t,e){if(this.It(t),Zs(null!=e.transformResults),!this.Rt.Et(t))return new No(this.key,e.version);var n=this.bt(t),r=this.vt(t,e.transformResults),i=e.version,o=this.St(n.data(),r);return new To(this.key,i,o,{hasCommittedMutations:!0})},to.prototype.ot=function(t,e,n){if(this.It(t),!this.Rt.Et(t))return t;var r=this.bt(t),i=this.Dt(n,t,e),o=this.St(r.data(),i);return new To(this.key,r.version,o,{At:!0})},to.prototype.Pt=function(t){for(var e=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof To?t.field(i.field):void 0,s=i.transform.ut(o||null);null!=s&&(e=null==e?(new Yi).set(i.field,s):e.set(i.field,s))}return e?e.yt():null},to.prototype.isEqual=function(t){return t instanceof to&&this.key.isEqual(t.key)&&ru(this.fieldTransforms,t.fieldTransforms,(function(t,e){return t.isEqual(e)}))&&this.Rt.isEqual(t.Rt)},to.prototype.bt=function(t){return t},to.prototype.vt=function(t,e){var n=[];Zs(this.fieldTransforms.length===e.length);for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,s=null;t instanceof To&&(s=t.field(i.field)),n.push(o.at(s,e[r]))}return n},to.prototype.Dt=function(t,e,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var s=o[i],u=s.transform,a=null;e instanceof To&&(a=e.field(s.field)),null===a&&n instanceof To&&(a=n.field(s.field)),r.push(u.ot(a,t))}return r},to.prototype.St=function(t,e){for(var n=new Yi(t),r=0;r<this.fieldTransforms.length;r++){var i=this.fieldTransforms[r].field;n.set(i,e[r])}return n.yt()},to),Qi=(s(Zi,Li=Bi),Zi.prototype.at=function(t,e){return this.It(t),new Io(this.key,e.version,{hasCommittedMutations:!0})},Zi.prototype.ot=function(t,e,n){return this.It(t),this.Rt.Et(t)?new Io(this.key,Vr.min()):t},Zi.prototype.Pt=function(t){return null},Zi.prototype.isEqual=function(t){return t instanceof Zi&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},Zi),Ki=(s(Ji,Vi=Bi),Ji.prototype.at=function(t,e){Js()},Ji.prototype.ot=function(t,e,n){Js()},Ji.prototype.Pt=function(t){Js()},Ji.prototype.isEqual=function(t){return t instanceof Ji&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},Ji),Hi=($i.empty=function(){return new $i({mapValue:{}})},$i.prototype.field=function(t){if(t.B())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Ii(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.O()])||null},$i.prototype.isEqual=function(t){return ci(this.proto,t.proto)},$i),Yi=(Xi.prototype.set=function(t,e){return this.Nt(t,e),this},Xi.prototype.delete=function(t){return this.Nt(t,null),this},Xi.prototype.Nt=function(t,e){for(var n=this.Ft,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map||(o=o&&10===hi(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),n=o}n.set(t.O(),e)},Xi.prototype.yt=function(){var t=this.kt(Hr.G,this.Ft);return null!=t?new Hi(t):this.Ct},Xi.prototype.kt=function(t,e){var n=this,r=!1,i=this.Ct.field(t),o=Ii(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var s=n.kt(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},Xi);function Xi(t){void 0===t&&(t=Hi.empty()),this.Ct=t,this.Ft=new Map}function $i(t){this.proto=t}function Ji(t,e){var n=this;return(n=Vi.call(this)||this).key=t,n.Rt=e,n.type=4,n}function Zi(t,e){var n=this;return(n=Li.call(this)||this).key=t,n.Rt=e,n.type=3,n}function to(t,e){var n=this;return(n=Ci.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Rt=Fi.exists(!0),n}function eo(t,e,n,r){var i=this;return(i=Mi.call(this)||this).key=t,i.data=e,i.Vt=n,i.Rt=r,i.type=1,i}function no(t,e,n){var r=this;return(r=Ui.call(this)||this).key=t,r.value=e,r.Rt=n,r.type=0,r}function ro(){}function io(t,e){this.updateTime=t,this.exists=e}function oo(t,e){this.field=t,this.transform=e}function so(t){(this.fields=t).sort(Hr.N)}function uo(t){var e=[];return Zr(t.fields||{},(function(t,n){var r=new Hr([t]);if(Ii(n)){var i=uo(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var u=s[o];e.push(r.child(u))}}else e.push(r)})),new ji(e)}function ao(t,e){this.key=t,this.version=e}function ho(t){this.count=t}var co,fo,lo,po,yo,vo,go,mo,wo,bo,Eo,To=(s(Yo,Eo=ao),Yo.prototype.field=function(t){return this.$t.field(t)},Yo.prototype.data=function(){return this.$t},Yo.prototype.Mt=function(){return this.$t.proto},Yo.prototype.isEqual=function(t){return t instanceof Yo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.At===t.At&&this.hasCommittedMutations===t.hasCommittedMutations&&this.$t.isEqual(t.$t)},Yo.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.$t.toString()+", {hasLocalMutations: "+this.At+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Yo.prototype,"hasPendingWrites",{get:function(){return this.At||this.hasCommittedMutations},enumerable:!0,configurable:!0}),Yo),Io=(s(Ho,bo=ao),Ho.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ho.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),Ho.prototype.isEqual=function(t){return t instanceof Ho&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Ho),No=(s(Ko,wo=ao),Ko.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ko.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),Ko.prototype.isEqual=function(t){return t instanceof Ko&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Ko),Ao=(Qo.prototype.canonicalId=function(){if(null===this.Lt){var t=this.path.j();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:",t+=this.filters.map((function(t){return t.canonicalId()})).join(","),t+="|ob:",t+=this.orderBy.map((function(t){return t.canonicalId()})).join(","),ri(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.Lt=t}return this.Lt},Qo.prototype.toString=function(){var t=this.path.j();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),0<this.filters.length&&(t+=", filters: ["+this.filters.join(", ")+"]"),ri(this.limit)||(t+=", limit: "+this.limit),0<this.orderBy.length&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},Qo.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var n=0;n<this.filters.length;n++)if(!this.filters[n].isEqual(t.filters[n]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!!(null!==this.startAt?this.startAt.isEqual(t.startAt):null===t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},Qo.prototype.Ot=function(){return Xr.et(this.path)&&null===this.collectionGroup&&0===this.filters.length},Qo),_o=(Wo.Wt=function(t){return new Wo(t)},Object.defineProperty(Wo.prototype,"orderBy",{get:function(){if(null===this.qt){this.qt=[];var t=this.jt(),e=this.Kt();if(null!==t&&null===e)t.Y()||this.qt.push(new Vo(t)),this.qt.push(new Vo(Hr.J(),"asc"));else{for(var n=!1,r=0,i=this.xt;r<i.length;r++){var o=i[r];this.qt.push(o),o.field.Y()&&(n=!0)}if(!n){var s=0<this.xt.length?this.xt[this.xt.length-1].dir:"asc";this.qt.push(new Vo(Hr.J(),s))}}}return this.qt},enumerable:!0,configurable:!0}),Wo.prototype.Gt=function(t){var e=this.filters.concat([t]);return new Wo(this.path,this.collectionGroup,this.xt.slice(),e,this.limit,this.Bt,this.startAt,this.endAt)},Wo.prototype.zt=function(t){var e=this.xt.concat([t]);return new Wo(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.Bt,this.startAt,this.endAt)},Wo.prototype.Ht=function(t){return new Wo(this.path,this.collectionGroup,this.xt.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},Wo.prototype.Yt=function(t){return new Wo(this.path,this.collectionGroup,this.xt.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},Wo.prototype.Jt=function(t){return new Wo(this.path,this.collectionGroup,this.xt.slice(),this.filters.slice(),this.limit,this.Bt,t,this.endAt)},Wo.prototype.Xt=function(t){return new Wo(this.path,this.collectionGroup,this.xt.slice(),this.filters.slice(),this.limit,this.Bt,this.startAt,t)},Wo.prototype.Zt=function(t){return new Wo(t,null,this.xt.slice(),this.filters.slice(),this.limit,this.Bt,this.startAt,this.endAt)},Wo.prototype.te=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.xt.length||1===this.xt.length&&this.xt[0].field.Y())},Wo.prototype.canonicalId=function(){return this.ee().canonicalId()+"|lt:"+this.Bt},Wo.prototype.toString=function(){return"Query(target="+this.ee().toString()+"; limitType="+this.Bt+")"},Wo.prototype.isEqual=function(t){return this.ee().isEqual(t.ee())&&this.Bt===t.Bt},Wo.prototype.se=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.Y()}return 0},Wo.prototype.matches=function(t){return this.ie(t)&&this.ne(t)&&this.re(t)&&this.he(t)},Wo.prototype.oe=function(){return!ri(this.limit)&&"F"===this.Bt},Wo.prototype.ae=function(){return!ri(this.limit)&&"L"===this.Bt},Wo.prototype.Kt=function(){return 0<this.xt.length?this.xt[0].field:null},Wo.prototype.jt=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof So&&n.ue())return n.field}return null},Wo.prototype.ce=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof So&&0<=t.indexOf(r.op))return r.op}return null},Wo.prototype.Ot=function(){return this.ee().Ot()},Wo.prototype._e=function(){return null!==this.collectionGroup},Wo.prototype.ee=function(){if(!this.Ut)if("F"===this.Bt)this.Ut=new Ao(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e],i="desc"===r.dir?"asc":"desc";t.push(new Vo(r.field,i))}var o=this.endAt?new Po(this.endAt.position,!this.endAt.before):null,s=this.startAt?new Po(this.startAt.position,!this.startAt.before):null;this.Ut=new Ao(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.Ut},Wo.prototype.ie=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.tt(this.collectionGroup)&&this.path.q(e):Xr.et(this.path)?this.path.isEqual(e):this.path.U(e)},Wo.prototype.ne=function(t){for(var e=0,n=this.xt;e<n.length;e++){var r=n[e];if(!r.field.Y()&&null===t.field(r.field))return!1}return!0},Wo.prototype.re=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},Wo.prototype.he=function(t){return!(this.startAt&&!this.startAt.le(this.orderBy,t)||this.endAt&&this.endAt.le(this.orderBy,t))},Wo.prototype.Qt=function(t){},Wo),So=(s(zo,mo=function(){}),zo.create=function(t,e,n){if(t.Y())return"in"===e?new Do(t,n):new ko(t,e,n);if(Ei(n)){if("=="!==e)throw new kr(Sr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new zo(t,e,n)}if(Ti(n)){if("=="!==e)throw new kr(Sr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new zo(t,e,n)}return"array-contains"===e?new xo(t,n):"in"===e?new Oo(t,n):"array-contains-any"===e?new Ro(t,n):new zo(t,e,n)},zo.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&hi(this.value)===hi(e)&&this.de(li(e,this.value))},zo.prototype.de=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Js()}},zo.prototype.ue=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},zo.prototype.canonicalId=function(){return this.field.j()+this.op.toString()+di(this.value)},zo.prototype.isEqual=function(t){return t instanceof zo&&this.op===t.op&&this.field.isEqual(t.field)&&ci(this.value,t.value)},zo.prototype.toString=function(){return this.field.j()+" "+this.op+" "+di(this.value)},zo),ko=(s(Go,go=So),Go.prototype.matches=function(t){var e=Xr.N(t.key,this.key);return this.de(e)},Go),Do=(s(Bo,vo=So),Bo.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},Bo),xo=(s(Fo,yo=So),Fo.prototype.matches=function(t){var e=t.field(this.field);return bi(e)&&fi(e.arrayValue,this.value)},Fo),Oo=(s(qo,po=So),qo.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&fi(this.value.arrayValue,e)},qo),Ro=(s(jo,lo=So),jo.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!bi(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return fi(e.value.arrayValue,t)}))},jo),Po=(Uo.prototype.canonicalId=function(){return(this.before?"b":"a")+":"+this.position.map((function(t){return di(t)})).join(",")},Uo.prototype.le=function(t,e){for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(n=i.field.Y()?Xr.N(Xr.Z(o.referenceValue),e.key):li(o,e.field(i.field)),"desc"===i.dir&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},Uo.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!ci(this.position[e],t.position[e]))return!1;return!0},Uo),Vo=(Mo.prototype.compare=function(t,e){var n,r,i,o,s=this.fe?Xr.N(t.key,e.key):(n=this.field,r=e,i=t.field(n),o=r.field(n),null!==i&&null!==o?li(i,o):Js());switch(this.dir){case"asc":return s;case"desc":return-1*s;default:return Js()}},Mo.prototype.canonicalId=function(){return this.field.j()+this.dir.toString()},Mo.prototype.toString=function(){return this.field.j()+" ("+this.dir+")"},Mo.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},Mo),Lo=(Co.prototype.Ie=function(t){return new Co(this.target,this.targetId,this.Te,t,this.Ee,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Co.prototype.we=function(t,e){return new Co(this.target,this.targetId,this.Te,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Co.prototype.Re=function(t){return new Co(this.target,this.targetId,this.Te,this.sequenceNumber,this.Ee,t,this.resumeToken)},Co);function Co(t,e,n,r,i,o,s){void 0===i&&(i=Vr.min()),void 0===o&&(o=Vr.min()),void 0===s&&(s=ei.ht),this.target=t,this.targetId=e,this.Te=n,this.sequenceNumber=r,this.Ee=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Mo(t,e){this.field=t,void 0===e&&(e="asc"),this.dir=e,this.fe=t.Y()}function Uo(t,e){this.position=t,this.before=e}function jo(t,e){return lo.call(this,t,"array-contains-any",e)||this}function qo(t,e){return po.call(this,t,"in",e)||this}function Fo(t,e){return yo.call(this,t,"array-contains",e)||this}function Bo(t,e){var n=this;return(n=vo.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map((function(t){return Xr.Z(t.referenceValue)})),n}function Go(t,e,n){var r=this;return(r=go.call(this,t,e,n)||this).key=Xr.Z(n.referenceValue),r}function zo(t,e,n){var r=this;return(r=mo.call(this)||this).field=t,r.op=e,r.value=n,r}function Wo(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.xt=n,this.filters=r,this.limit=i,this.Bt=o,this.startAt=s,this.endAt=u,this.qt=null,this.Ut=null,this.startAt&&this.Qt(this.startAt),this.endAt&&this.Qt(this.endAt)}function Qo(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Lt=null}function Ko(){return null!==wo&&wo.apply(this,arguments)||this}function Ho(t,e,n){var r=this;return(r=bo.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Yo(t,e,n,r){var i=this;return(i=Eo.call(this,t,e)||this).$t=n,i.At=!!r.At,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Xo(t){switch(t){case Sr.OK:return Js();case Sr.CANCELLED:case Sr.UNKNOWN:case Sr.DEADLINE_EXCEEDED:case Sr.RESOURCE_EXHAUSTED:case Sr.INTERNAL:case Sr.UNAVAILABLE:case Sr.UNAUTHENTICATED:return;case Sr.INVALID_ARGUMENT:case Sr.NOT_FOUND:case Sr.ALREADY_EXISTS:case Sr.PERMISSION_DENIED:case Sr.FAILED_PRECONDITION:case Sr.ABORTED:case Sr.OUT_OF_RANGE:case Sr.UNIMPLEMENTED:case Sr.DATA_LOSS:return 1;default:return Js()}}function $o(t){if(void 0===t)return Xs("GRPC error has no .code"),Sr.UNKNOWN;switch(t){case co.OK:return Sr.OK;case co.CANCELLED:return Sr.CANCELLED;case co.UNKNOWN:return Sr.UNKNOWN;case co.DEADLINE_EXCEEDED:return Sr.DEADLINE_EXCEEDED;case co.RESOURCE_EXHAUSTED:return Sr.RESOURCE_EXHAUSTED;case co.INTERNAL:return Sr.INTERNAL;case co.UNAVAILABLE:return Sr.UNAVAILABLE;case co.UNAUTHENTICATED:return Sr.UNAUTHENTICATED;case co.INVALID_ARGUMENT:return Sr.INVALID_ARGUMENT;case co.NOT_FOUND:return Sr.NOT_FOUND;case co.ALREADY_EXISTS:return Sr.ALREADY_EXISTS;case co.PERMISSION_DENIED:return Sr.PERMISSION_DENIED;case co.FAILED_PRECONDITION:return Sr.FAILED_PRECONDITION;case co.ABORTED:return Sr.ABORTED;case co.OUT_OF_RANGE:return Sr.OUT_OF_RANGE;case co.UNIMPLEMENTED:return Sr.UNIMPLEMENTED;case co.DATA_LOSS:return Sr.DATA_LOSS;default:return Js()}}(fo=co=co||{})[fo.OK=0]="OK",fo[fo.CANCELLED=1]="CANCELLED",fo[fo.UNKNOWN=2]="UNKNOWN",fo[fo.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",fo[fo.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",fo[fo.NOT_FOUND=5]="NOT_FOUND",fo[fo.ALREADY_EXISTS=6]="ALREADY_EXISTS",fo[fo.PERMISSION_DENIED=7]="PERMISSION_DENIED",fo[fo.UNAUTHENTICATED=16]="UNAUTHENTICATED",fo[fo.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",fo[fo.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",fo[fo.ABORTED=10]="ABORTED",fo[fo.OUT_OF_RANGE=11]="OUT_OF_RANGE",fo[fo.UNIMPLEMENTED=12]="UNIMPLEMENTED",fo[fo.INTERNAL=13]="INTERNAL",fo[fo.UNAVAILABLE=14]="UNAVAILABLE",fo[fo.DATA_LOSS=15]="DATA_LOSS";var Jo=(rs.prototype.Ae=function(t,e){return new rs(this.N,this.root.Ae(t,e,this.N).me(null,null,ts.Pe,null,null))},rs.prototype.remove=function(t){return new rs(this.N,this.root.remove(t,this.N).me(null,null,ts.Pe,null,null))},rs.prototype.get=function(t){for(var e=this.root;!e.B();){var n=this.N(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},rs.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.B();){var r=this.N(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},rs.prototype.B=function(){return this.root.B()},Object.defineProperty(rs.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),rs.prototype.Ve=function(){return this.root.Ve()},rs.prototype.ge=function(){return this.root.ge()},rs.prototype.pe=function(t){return this.root.pe(t)},rs.prototype.forEach=function(t){this.pe((function(e,n){return t(e,n),!1}))},rs.prototype.toString=function(){var t=[];return this.pe((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},rs.prototype.ye=function(t){return this.root.ye(t)},rs.prototype.be=function(){return new Zo(this.root,null,this.N,!1)},rs.prototype.ve=function(t){return new Zo(this.root,t,this.N,!1)},rs.prototype.Se=function(){return new Zo(this.root,null,this.N,!0)},rs.prototype.De=function(t){return new Zo(this.root,t,this.N,!0)},rs),Zo=(ns.prototype.Ne=function(){var t=this.Fe.pop(),e={key:t.key,value:t.value};if(this.Ce)for(t=t.left;!t.B();)this.Fe.push(t),t=t.right;else for(t=t.right;!t.B();)this.Fe.push(t),t=t.left;return e},ns.prototype.ke=function(){return 0<this.Fe.length},ns.prototype.$e=function(){if(0===this.Fe.length)return null;var t=this.Fe[this.Fe.length-1];return{key:t.key,value:t.value}},ns),ts=(es.prototype.me=function(t,e,n,r,i){return new es(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},es.prototype.B=function(){return!1},es.prototype.pe=function(t){return this.left.pe(t)||t(this.key,this.value)||this.right.pe(t)},es.prototype.ye=function(t){return this.right.ye(t)||t(this.key,this.value)||this.left.ye(t)},es.prototype.min=function(){return this.left.B()?this:this.left.min()},es.prototype.Ve=function(){return this.min().key},es.prototype.ge=function(){return this.right.B()?this.key:this.right.ge()},es.prototype.Ae=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.me(null,null,null,r.left.Ae(t,e,n),null):0===i?r.me(null,e,null,null,null):r.me(null,null,null,null,r.right.Ae(t,e,n))).Me()},es.prototype.Le=function(){if(this.left.B())return es.EMPTY;var t=this;return t.left.Oe()||t.left.left.Oe()||(t=t.xe()),(t=t.me(null,null,null,t.left.Le(),null)).Me()},es.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.B()||r.left.Oe()||r.left.left.Oe()||(r=r.xe()),r=r.me(null,null,null,r.left.remove(t,e),null);else{if(r.left.Oe()&&(r=r.Be()),r.right.B()||r.right.Oe()||r.right.left.Oe()||(r=r.qe()),0===e(t,r.key)){if(r.right.B())return es.EMPTY;n=r.right.min(),r=r.me(n.key,n.value,null,null,r.right.Le())}r=r.me(null,null,null,null,r.right.remove(t,e))}return r.Me()},es.prototype.Oe=function(){return this.color},es.prototype.Me=function(){var t=this;return t.right.Oe()&&!t.left.Oe()&&(t=t.Ue()),t.left.Oe()&&t.left.left.Oe()&&(t=t.Be()),t.left.Oe()&&t.right.Oe()&&(t=t.Qe()),t},es.prototype.xe=function(){var t=this.Qe();return t.right.left.Oe()&&(t=(t=(t=t.me(null,null,null,null,t.right.Be())).Ue()).Qe()),t},es.prototype.qe=function(){var t=this.Qe();return t.left.left.Oe()&&(t=(t=t.Be()).Qe()),t},es.prototype.Ue=function(){var t=this.me(null,null,es.RED,null,this.right.left);return this.right.me(null,null,this.color,t,null)},es.prototype.Be=function(){var t=this.me(null,null,es.RED,this.left.right,null);return this.left.me(null,null,this.color,null,t)},es.prototype.Qe=function(){var t=this.left.me(null,null,!this.left.color,null,null),e=this.right.me(null,null,!this.right.color,null,null);return this.me(null,null,!this.color,t,e)},es.prototype.We=function(){var t=this.je();return Math.pow(2,t)<=this.size+1},es.prototype.je=function(){if(this.Oe()&&this.left.Oe())throw Js();if(this.right.Oe())throw Js();var t=this.left.je();if(t!==this.right.je())throw Js();return t+(this.Oe()?0:1)},es);function es(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:es.RED,this.left=null!=r?r:es.EMPTY,this.right=null!=i?i:es.EMPTY,this.size=this.left.size+1+this.right.size}function ns(t,e,n,r){this.Ce=r,this.Fe=[];for(var i=1;!t.B();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Ce?t.left:t.right;else{if(0===i){this.Fe.push(t);break}this.Fe.push(t),t=this.Ce?t.right:t.left}}function rs(t,e){this.N=t,this.root=e||ts.EMPTY}function is(){this.size=0}ts.EMPTY=null,ts.RED=!0,ts.Pe=!1,ts.EMPTY=(Object.defineProperty(is.prototype,"key",{get:function(){throw Js()},enumerable:!0,configurable:!0}),Object.defineProperty(is.prototype,"value",{get:function(){throw Js()},enumerable:!0,configurable:!0}),Object.defineProperty(is.prototype,"color",{get:function(){throw Js()},enumerable:!0,configurable:!0}),Object.defineProperty(is.prototype,"left",{get:function(){throw Js()},enumerable:!0,configurable:!0}),Object.defineProperty(is.prototype,"right",{get:function(){throw Js()},enumerable:!0,configurable:!0}),is.prototype.me=function(t,e,n,r,i){return this},is.prototype.Ae=function(t,e,n){return new ts(t,e)},is.prototype.remove=function(t,e){return this},is.prototype.B=function(){return!0},is.prototype.pe=function(t){return!1},is.prototype.ye=function(t){return!1},is.prototype.Ve=function(){return null},is.prototype.ge=function(){return null},is.prototype.Oe=function(){return!1},is.prototype.We=function(){return!0},is.prototype.je=function(){return 0},new is);var os=(hs.prototype.has=function(t){return null!==this.data.get(t)},hs.prototype.first=function(){return this.data.Ve()},hs.prototype.last=function(){return this.data.ge()},Object.defineProperty(hs.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),hs.prototype.indexOf=function(t){return this.data.indexOf(t)},hs.prototype.forEach=function(t){this.data.pe((function(e,n){return t(e),!1}))},hs.prototype.Ke=function(t,e){for(var n=this.data.ve(t[0]);n.ke();){var r=n.Ne();if(0<=this.N(r.key,t[1]))return;e(r.key)}},hs.prototype.Ge=function(t,e){var n;for(n=void 0!==e?this.data.ve(e):this.data.be();n.ke();)if(!t(n.Ne().key))return},hs.prototype.ze=function(t){var e=this.data.ve(t);return e.ke()?e.Ne().key:null},hs.prototype.be=function(){return new ss(this.data.be())},hs.prototype.ve=function(t){return new ss(this.data.ve(t))},hs.prototype.add=function(t){return this.me(this.data.remove(t).Ae(t,!0))},hs.prototype.delete=function(t){return this.has(t)?this.me(this.data.remove(t)):this},hs.prototype.B=function(){return this.data.B()},hs.prototype.He=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},hs.prototype.isEqual=function(t){if(!(t instanceof hs))return!1;if(this.size!==t.size)return!1;for(var e=this.data.be(),n=t.data.be();e.ke();){var r=e.Ne().key,i=n.Ne().key;if(0!==this.N(r,i))return!1}return!0},hs.prototype.W=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},hs.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},hs.prototype.me=function(t){var e=new hs(this.N);return e.data=t,e},hs),ss=(as.prototype.Ne=function(){return this.Ye.Ne().key},as.prototype.ke=function(){return this.Ye.ke()},as),us=new Jo(Xr.N);function as(t){this.Ye=t}function hs(t){this.N=t,this.data=new Jo(this.N)}function cs(){return us}function fs(){return cs()}var ls=new Jo(Xr.N);function ps(){return ls}var ds=new Jo(Xr.N);function ys(){return ds}var vs=new os(Xr.N);function gs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=vs,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var ms=new os(nu);function ws(){return ms}function bs(t,e,n,r){this.ws=t,this.removedTargetIds=e,this.key=n,this.Rs=r}function Es(t,e){this.targetId=t,this.As=e}function Ts(t,e,n,r){void 0===n&&(n=ei.ht),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Is=(Cs.Ze=function(t){return new Cs(t.N)},Cs.prototype.has=function(t){return null!=this.Je.get(t)},Cs.prototype.get=function(t){return this.Je.get(t)},Cs.prototype.first=function(){return this.Xe.Ve()},Cs.prototype.last=function(){return this.Xe.ge()},Cs.prototype.B=function(){return this.Xe.B()},Cs.prototype.indexOf=function(t){var e=this.Je.get(t);return e?this.Xe.indexOf(e):-1},Object.defineProperty(Cs.prototype,"size",{get:function(){return this.Xe.size},enumerable:!0,configurable:!0}),Cs.prototype.forEach=function(t){this.Xe.pe((function(e,n){return t(e),!1}))},Cs.prototype.add=function(t){var e=this.delete(t.key);return e.me(e.Je.Ae(t.key,t),e.Xe.Ae(t,null))},Cs.prototype.delete=function(t){var e=this.get(t);return e?this.me(this.Je.remove(t),this.Xe.remove(e)):this},Cs.prototype.isEqual=function(t){if(!(t instanceof Cs))return!1;if(this.size!==t.size)return!1;for(var e=this.Xe.be(),n=t.Xe.be();e.ke();){var r=e.Ne().key,i=n.Ne().key;if(!r.isEqual(i))return!1}return!0},Cs.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},Cs.prototype.me=function(t,e){var n=new Cs;return n.N=this.N,n.Je=t,n.Xe=e,n},Cs),Ns=(Ls.prototype.track=function(t){var e=t.doc.key,n=this.ts.get(e);!n||0!==t.type&&3===n.type?this.ts=this.ts.Ae(e,t):3===t.type&&1!==n.type?this.ts=this.ts.Ae(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ts=this.ts.Ae(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ts=this.ts.Ae(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ts=this.ts.remove(e):1===t.type&&2===n.type?this.ts=this.ts.Ae(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ts=this.ts.Ae(e,{type:2,doc:t.doc}):Js()},Ls.prototype.es=function(){var t=[];return this.ts.pe((function(e,n){t.push(n)})),t},Ls),As=(Vs.os=function(t,e,n,r){var i=[];return e.forEach((function(t){i.push({type:0,doc:t})})),new Vs(t,e,Is.Ze(e),i,n,r,!0,!1)},Object.defineProperty(Vs.prototype,"hasPendingWrites",{get:function(){return!this.ns.B()},enumerable:!0,configurable:!0}),Vs.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.rs===t.rs&&this.ns.isEqual(t.ns)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.ss.isEqual(t.ss)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Vs),_s=(Ps.ls=function(t,e){var n=new Map;return n.set(t,Ss.ds(t,e)),new Ps(Vr.min(),n,ws(),cs(),gs())},Ps),Ss=(Rs.ds=function(t,e){return new Rs(ei.ht,e,gs(),gs(),gs())},Rs),ks=(Object.defineProperty(Os.prototype,"fs",{get:function(){return this.gs},enumerable:!0,configurable:!0}),Object.defineProperty(Os.prototype,"resumeToken",{get:function(){return this.Vs},enumerable:!0,configurable:!0}),Object.defineProperty(Os.prototype,"ys",{get:function(){return 0!==this.ms},enumerable:!0,configurable:!0}),Object.defineProperty(Os.prototype,"bs",{get:function(){return this.ps},enumerable:!0,configurable:!0}),Os.prototype.vs=function(t){0<t.rt()&&(this.ps=!0,this.Vs=t)},Os.prototype.Ss=function(){var t=gs(),e=gs(),n=gs();return this.Ps.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Js()}})),new Ss(this.Vs,this.gs,t,e,n)},Os.prototype.Ds=function(){this.ps=!1,this.Ps=Us()},Os.prototype.Cs=function(t,e){this.ps=!0,this.Ps=this.Ps.Ae(t,e)},Os.prototype.Fs=function(t){this.ps=!0,this.Ps=this.Ps.remove(t)},Os.prototype.Ns=function(){this.ms+=1},Os.prototype.ks=function(){--this.ms},Os.prototype.$s=function(){this.ps=!0,this.gs=!0},Os),Ds=(xs.prototype.qs=function(t){for(var e=0,n=t.ws;e<n.length;e++){var r=n[e];t.Rs instanceof To?this.Us(r,t.Rs):t.Rs instanceof Io&&this.Qs(r,t.key,t.Rs)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Qs(s,t.key,t.Rs)}},xs.prototype.Ws=function(t){var e=this;this.js(t,(function(n){var r=e.Ks(n);switch(t.state){case 0:e.Gs(n)&&r.vs(t.resumeToken);break;case 1:r.ks(),r.ys||r.Ds(),r.vs(t.resumeToken);break;case 2:r.ks(),r.ys||e.removeTarget(n);break;case 3:e.Gs(n)&&(r.$s(),r.vs(t.resumeToken));break;case 4:e.Gs(n)&&(e.zs(n),r.vs(t.resumeToken));break;default:Js()}}))},xs.prototype.js=function(t,e){var n=this;0<t.targetIds.length?t.targetIds.forEach(e):this.Ls.forEach((function(t,r){n.Gs(r)&&e(r)}))},xs.prototype.Hs=function(t){var e=t.targetId,n=t.As.count,r=this.Ys(e);if(r){var i=r.target;if(i.Ot())if(0===n){var o=new Xr(i.path);this.Qs(e,o,new Io(o,Vr.min()))}else Zs(1===n);else this.Js(e)!==n&&(this.zs(e),this.Bs=this.Bs.add(e))}},xs.prototype.Xs=function(t){var e=this,n=new Map;this.Ls.forEach((function(r,i){var o=e.Ys(i);if(o){if(r.fs&&o.target.Ot()){var s=new Xr(o.target.path);null!==e.Os.get(s)||e.Zs(i,s)||e.Qs(i,s,new Io(s,t))}r.bs&&(n.set(i,r.Ss()),r.Ds())}}));var r=gs();this.xs.forEach((function(t,n){var i=!0;n.Ge((function(t){var n=e.Ys(t);return!n||2===n.Te||(i=!1)})),i&&(r=r.add(t))}));var i=new _s(t,n,this.Bs,this.Os,r);return this.Os=cs(),this.xs=Ms(),this.Bs=new os(nu),i},xs.prototype.Us=function(t,e){if(this.Gs(t)){var n=this.Zs(t,e.key)?2:0;this.Ks(t).Cs(e.key,n),this.Os=this.Os.Ae(e.key,e),this.xs=this.xs.Ae(e.key,this.ti(e.key).add(t))}},xs.prototype.Qs=function(t,e,n){if(this.Gs(t)){var r=this.Ks(t);this.Zs(t,e)?r.Cs(e,1):r.Fs(e),this.xs=this.xs.Ae(e,this.ti(e).delete(t)),n&&(this.Os=this.Os.Ae(e,n))}},xs.prototype.removeTarget=function(t){this.Ls.delete(t)},xs.prototype.Js=function(t){var e=this.Ks(t).Ss();return this.Ms.ei(t).size+e.Ts.size-e.Is.size},xs.prototype.Ns=function(t){this.Ks(t).Ns()},xs.prototype.Ks=function(t){var e=this.Ls.get(t);return e||(e=new ks,this.Ls.set(t,e)),e},xs.prototype.ti=function(t){var e=this.xs.get(t);return e||(e=new os(nu),this.xs=this.xs.Ae(t,e)),e},xs.prototype.Gs=function(t){var e=null!==this.Ys(t);return e||Ys("WatchChangeAggregator","Detected inactive target",t),e},xs.prototype.Ys=function(t){var e=this.Ls.get(t);return e&&e.ys?null:this.Ms.si(t)},xs.prototype.zs=function(t){var e=this;this.Ls.set(t,new ks),this.Ms.ei(t).forEach((function(n){e.Qs(t,n,null)}))},xs.prototype.Zs=function(t,e){return this.Ms.ei(t).has(e)},xs);function xs(t){this.Ms=t,this.Ls=new Map,this.Os=cs(),this.xs=Ms(),this.Bs=new os(nu)}function Os(){this.ms=0,this.Ps=Us(),this.Vs=ei.ht,this.gs=!1,this.ps=!0}function Rs(t,e,n,r,i){this.resumeToken=t,this.fs=e,this.Ts=n,this.Es=r,this.Is=i}function Ps(t,e,n,r,i){this.Ee=t,this.as=e,this.us=n,this.cs=r,this._s=i}function Vs(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.ss=n,this.docChanges=r,this.ns=i,this.fromCache=o,this.rs=s,this.hs=u}function Ls(){this.ts=new Jo(Xr.N)}function Cs(t){this.N=t?function(e,n){return t(e,n)||Xr.N(e.key,n.key)}:function(t,e){return Xr.N(t.key,e.key)},this.Je=ps(),this.Xe=new Jo(this.N)}function Ms(){return new Jo(Xr.N)}function Us(){return new Jo(Xr.N)}var js={asc:"ASCENDING",desc:"DESCENDING"},qs={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Fs=(Bs.prototype.ni=function(t){var e=void 0===t.code?Sr.UNKNOWN:$o(t.code);return new kr(e,t.message||"")},Bs.prototype.ri=function(t){return this.options.hi||ri(t)?t:{value:t}},Bs.prototype.oi=function(t){var e;return ri(e="object"==typeof t?t.value:t)?null:e},Bs.prototype._t=function(t){return{integerValue:""+t}},Bs.prototype.lt=function(t){if(this.options.hi){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ii(t)?"-0":t}},Bs.prototype.ai=function(t){return oi(t)?this._t(t):this.lt(t)},Bs.prototype.C=function(t){return this.options.hi?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},Bs.prototype.v=function(t){var e=yi(t);return new Pr(e.seconds,e.nanos)},Bs.prototype.ui=function(t){return this.options.hi?t.toBase64():t.toUint8Array()},Bs.prototype.ci=function(t){return this.options.hi?(Zs(void 0===t||"string"==typeof t),ei.fromBase64String(t||"")):(Zs(void 0===t||t instanceof Uint8Array),ei.fromUint8Array(t||new Uint8Array))},Bs.prototype.toVersion=function(t){return this.C(t.C())},Bs.prototype.fromVersion=function(t){return Zs(!!t),Vr.v(this.v(t))},Bs.prototype._i=function(t,e){return this.li(e||this.ii).child("documents").child(t).j()},Bs.prototype.di=function(t){var e=Cr.K(t);return Zs(Gs(e)),e},Bs.prototype.fi=function(t){return this._i(t.path)},Bs.prototype.Z=function(t){var e=this.di(t);return Zs(e.get(1)===this.ii.projectId),Zs(!e.get(3)&&!this.ii.database||e.get(3)===this.ii.database),new Xr(this.Ti(e))},Bs.prototype.Ei=function(t){return this._i(t)},Bs.prototype.Ii=function(t){var e=this.di(t);return 4===e.length?Cr.G:this.Ti(e)},Object.defineProperty(Bs.prototype,"wi",{get:function(){return new Cr(["projects",this.ii.projectId,"databases",this.ii.database]).j()},enumerable:!0,configurable:!0}),Bs.prototype.li=function(t){return new Cr(["projects",t.projectId,"databases",t.database])},Bs.prototype.Ti=function(t){return Zs(4<t.length&&"documents"===t.get(4)),t.$(5)},Bs.prototype.Ri=function(t,e){return{name:this.fi(t),fields:e.proto.mapValue.fields}},Bs.prototype.Ai=function(t){return{name:this.fi(t.key),fields:t.Mt().mapValue.fields,updateTime:this.C(t.version.C())}},Bs.prototype.mi=function(t,e){var n=this.Z(t.name),r=this.fromVersion(t.updateTime),i=new Hi({mapValue:{fields:t.fields}});return new To(n,r,i,{hasCommittedMutations:!!e})},Bs.prototype.Pi=function(t){Zs(!!t.found),t.found.name,t.found.updateTime;var e=this.Z(t.found.name),n=this.fromVersion(t.found.updateTime),r=new Hi({mapValue:{fields:t.found.fields}});return new To(e,n,r,{})},Bs.prototype.Vi=function(t){Zs(!!t.missing),Zs(!!t.readTime);var e=this.Z(t.missing),n=this.fromVersion(t.readTime);return new Io(e,n)},Bs.prototype.gi=function(t){return"found"in t?this.Pi(t):"missing"in t?this.Vi(t):Js()},Bs.prototype.pi=function(t){var e;if("targetChange"in t){t.targetChange;var n=this.yi(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],i=this.ci(t.targetChange.resumeToken),o=t.targetChange.cause;e=new Ts(n,r,i,o&&this.ni(o)||null)}else if("documentChange"in t){t.documentChange;var s=t.documentChange;s.document,s.document.name,s.document.updateTime;var u=this.Z(s.document.name),a=this.fromVersion(s.document.updateTime),h=new Hi({mapValue:{fields:s.document.fields}}),c=new To(u,a,h,{});e=new bs(s.targetIds||[],s.removedTargetIds||[],c.key,c)}else if("documentDelete"in t){t.documentDelete;var f=t.documentDelete;f.document;var l=this.Z(f.document),p=f.readTime?this.fromVersion(f.readTime):Vr.min(),d=new Io(l,p);e=new bs([],f.removedTargetIds||[],d.key,d)}else if("documentRemove"in t){t.documentRemove;var y=t.documentRemove;y.document;var v=this.Z(y.document);e=new bs([],y.removedTargetIds||[],v,null)}else{if(!("filter"in t))return Js();t.filter;var g=t.filter;g.targetId;var m=new ho(g.count||0);e=new Es(g.targetId,m)}return e},Bs.prototype.yi=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Js()},Bs.prototype.bi=function(t){if(!("targetChange"in t))return Vr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Vr.min():this.fromVersion(e.readTime)},Bs.prototype.vi=function(t){var e,n=this;if(t instanceof Gi)e={update:this.Ri(t.key,t.value)};else if(t instanceof Qi)e={delete:this.fi(t.key)};else if(t instanceof zi)e={update:this.Ri(t.key,t.data),updateMask:this.Si(t.Vt)};else if(t instanceof Wi)e={transform:{document:this.fi(t.key),fieldTransforms:t.fieldTransforms.map((function(t){return n.Di(t)}))}};else{if(!(t instanceof Ki))return Js();e={verify:this.fi(t.key)}}return t.Rt.Tt||(e.currentDocument=this.Ci(t.Rt)),e},Bs.prototype.Fi=function(t){var e=this,n=t.currentDocument?this.Ni(t.currentDocument):Fi.ft();if(t.update){t.update.name;var r=this.Z(t.update.name),i=new Hi({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=this.ki(t.updateMask);return new zi(r,i,o,n)}return new Gi(r,i,n)}if(t.delete){var s=this.Z(t.delete);return new Qi(s,n)}if(t.transform){var u=this.Z(t.transform.document),a=t.transform.fieldTransforms.map((function(t){return e.$i(t)}));return Zs(!0===n.exists),new Wi(u,a)}if(t.verify){var h=this.Z(t.verify);return new Ki(h,n)}return Js()},Bs.prototype.Ci=function(t){return void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Js()},Bs.prototype.Ni=function(t){return void 0!==t.updateTime?Fi.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?Fi.exists(t.exists):Fi.ft()},Bs.prototype.Mi=function(t,e){var n=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);n.isEqual(Vr.min())&&(n=this.fromVersion(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new Pi(n,r)},Bs.prototype.Li=function(t,e){var n=this;return t&&0<t.length?(Zs(void 0!==e),t.map((function(t){return n.Mi(t,e)}))):[]},Bs.prototype.Di=function(t){var e=t.transform;if(e instanceof Ni)return{fieldPath:t.field.j(),setToServerValue:"REQUEST_TIME"};if(e instanceof _i)return{fieldPath:t.field.j(),appendMissingElements:{values:e.elements}};if(e instanceof Si)return{fieldPath:t.field.j(),removeAllFromArray:{values:e.elements}};if(e instanceof ki)return{fieldPath:t.field.j(),increment:e.ct};throw Js()},Bs.prototype.$i=function(t){var e=null;if("setToServerValue"in t)Zs("REQUEST_TIME"===t.setToServerValue),e=Ni.instance;else if("appendMissingElements"in t){var n=t.appendMissingElements.values||[];e=new _i(n)}else if("removeAllFromArray"in t){var r=t.removeAllFromArray.values||[];e=new Si(r)}else"increment"in t?e=new ki(this,t.increment):Js();var i=Hr.X(t.fieldPath);return new qi(i,e)},Bs.prototype.Oi=function(t){return{documents:[this.Ei(t.path)]}},Bs.prototype.xi=function(t){Zs(1===t.documents.length);var e=t.documents[0];return _o.Wt(this.Ii(e)).ee()},Bs.prototype.Bi=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(e.parent=this.Ei(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=this.Ei(n.M()),e.structuredQuery.from=[{collectionId:n.O()}]);var r=this.qi(t.filters);r&&(e.structuredQuery.where=r);var i=this.Ui(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.ri(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.Qi(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Qi(t.endAt)),e},Bs.prototype.Wi=function(t){var e=this.Ii(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(0<r){Zs(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=this.ji(n.where));var u=[];n.orderBy&&(u=this.Ki(n.orderBy));var a=null;n.limit&&(a=this.oi(n.limit));var h=null;n.startAt&&(h=this.Gi(n.startAt));var c=null;return n.endAt&&(c=this.Gi(n.endAt)),new _o(e,i,u,s,a,"F",h,c).ee()},Bs.prototype.zi=function(t){var e=this.Hi(t.Te);return null==e?null:{"goog-listen-tags":e}},Bs.prototype.Hi=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Js()}},Bs.prototype.ee=function(t){var e,n=t.target;return(e=n.Ot()?{documents:this.Oi(n)}:{query:this.Bi(n)}).targetId=t.targetId,0<t.resumeToken.rt()&&(e.resumeToken=this.ui(t.resumeToken)),e},Bs.prototype.qi=function(t){var e=this;if(0!==t.length){var n=t.map((function(t){return t instanceof So?e.Yi(t):Js()}));return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},Bs.prototype.ji=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.Ji(t)]:void 0!==t.fieldFilter?[this.Xi(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return e.ji(t)})).reduce((function(t,e){return t.concat(e)})):Js():[]},Bs.prototype.Ui=function(t){var e=this;if(0!==t.length)return t.map((function(t){return e.Zi(t)}))},Bs.prototype.Ki=function(t){var e=this;return t.map((function(t){return e.tn(t)}))},Bs.prototype.Qi=function(t){return{before:t.before,values:t.position}},Bs.prototype.Gi=function(t){var e=!!t.before,n=t.values||[];return new Po(n,e)},Bs.prototype.en=function(t){return js[t]},Bs.prototype.sn=function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}},Bs.prototype.nn=function(t){return qs[t]},Bs.prototype.rn=function(t){switch(t){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Js()}},Bs.prototype.hn=function(t){return{fieldPath:t.j()}},Bs.prototype.on=function(t){return Hr.X(t.fieldPath)},Bs.prototype.Zi=function(t){return{field:this.hn(t.field),direction:this.en(t.dir)}},Bs.prototype.tn=function(t){return new Vo(this.on(t.field),this.sn(t.direction))},Bs.prototype.Xi=function(t){return So.create(this.on(t.fieldFilter.field),this.rn(t.fieldFilter.op),t.fieldFilter.value)},Bs.prototype.Yi=function(t){if("=="===t.op){if(Ti(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NAN"}};if(Ei(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.hn(t.field),op:this.nn(t.op),value:t.value}}},Bs.prototype.Ji=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.on(t.unaryFilter.field);return So.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=this.on(t.unaryFilter.field);return So.create(n,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Js()}},Bs.prototype.Si=function(t){var e=[];return t.fields.forEach((function(t){return e.push(t.j())})),{fieldPaths:e}},Bs.prototype.ki=function(t){var e=t.fieldPaths||[];return new ji(e.map((function(t){return Hr.X(t)})))},Bs);function Bs(t,e){this.ii=t,this.options=e}function Gs(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var zs=(Qs.an=function(t){Qs.platform&&Js(),Qs.platform=t},Qs.nt=function(){return Qs.platform||Js(),Qs.platform},Qs),Ws=new d("@firebase/firestore");function Qs(){}function Ks(){return Ws.logLevel}function Hs(t){Ws.logLevel=t}function Ys(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ws.logLevel<=r.DEBUG){var i=e.map($s);Ws.debug.apply(Ws,h(["Firestore ("+Er+"): "+t],i))}}function Xs(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ws.logLevel<=r.ERROR){var i=e.map($s);Ws.error.apply(Ws,h(["Firestore ("+Er+"): "+t],i))}}function $s(t){if("string"==typeof t)return t;var e=zs.nt();try{return e.un(t)}catch(e){return t}}function Js(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+Er+") INTERNAL ASSERTION FAILED: "+t;throw Xs(e),new Error(e)}function Zs(t){t||Js()}var tu=(eu.cn=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=zs.nt()._n(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},eu);function eu(){}function nu(t,e){return t<e?-1:e<t?1:0}function ru(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function iu(t){return t+"\0"}function ou(t,e,n,r,i){this.ii=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var su=(Object.defineProperty(_u.prototype,"ln",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),_u.prototype.isEqual=function(t){return t instanceof _u&&t.projectId===this.projectId&&t.database===this.database},_u.prototype.S=function(t){return nu(this.projectId,t.projectId)||nu(this.database,t.database)},_u),uu=(Au.prototype.get=function(t){var e=this.dn(t),n=this.fn[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(s.isEqual(t))return u}},Au.prototype.has=function(t){return void 0!==this.get(t)},Au.prototype.set=function(t,e){var n=this.dn(t),r=this.fn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.fn[n]=[[t,e]]},Au.prototype.delete=function(t){var e=this.dn(t),n=this.fn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.fn[e]:n.splice(r,1),!0;return!1},Au.prototype.forEach=function(t){Zr(this.fn,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];t(s,u)}}))},Au.prototype.B=function(){return ti(this.fn)},Au),au=(Nu.prototype.at=function(t,e,n){for(var r=n.En,i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(t)){var s=r[i];e=o.at(e,s)}}return e},Nu.prototype.ot=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=i.ot(e,e,this.Tn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=a.ot(e,o,this.Tn))}return e},Nu.prototype.In=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.ot(r.key,t.get(r.key));i&&(n=n.Ae(r.key,i))})),n},Nu.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),gs())},Nu.prototype.isEqual=function(t){return this.batchId===t.batchId&&ru(this.mutations,t.mutations,(function(t,e){return t.isEqual(e)}))&&ru(this.baseMutations,t.baseMutations,(function(t,e){return t.isEqual(e)}))},Nu),hu=(Iu.from=function(t,e,n,r){Zs(t.mutations.length===n.length);for(var i=ys(),o=t.mutations,s=0;s<o.length;s++)i=i.Ae(o[s].key,n[s].version);return new Iu(t,e,n,r,i)},Iu),cu=(Tu.prototype.catch=function(t){return this.next(void 0,t)},Tu.prototype.next=function(t,e){var n=this;return this.Vn&&Js(),this.Vn=!0,this.Pn?this.error?this.gn(e,this.error):this.pn(t,this.result):new Tu((function(r,i){n.An=function(e){n.pn(t,e).next(r,i)},n.mn=function(t){n.gn(e,t).next(r,i)}}))},Tu.prototype.yn=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},Tu.prototype.bn=function(t){try{var e=t();return e instanceof Tu?e:Tu.resolve(e)}catch(t){return Tu.reject(t)}},Tu.prototype.pn=function(t,e){return t?this.bn((function(){return t(e)})):Tu.resolve(e)},Tu.prototype.gn=function(t,e){return t?this.bn((function(){return t(e)})):Tu.reject(e)},Tu.resolve=function(t){return new Tu((function(e,n){e(t)}))},Tu.reject=function(t){return new Tu((function(e,n){n(t)}))},Tu.vn=function(t){return new Tu((function(e,n){var r=0,i=0,o=!1;t.forEach((function(t){++r,t.next((function(){++i,o&&i===r&&e()}),(function(t){return n(t)}))})),o=!0,i===r&&e()}))},Tu.Sn=function(t){for(var e=Tu.resolve(!1),n=function(t){e=e.next((function(e){return e?Tu.resolve(e):t()}))},r=0,i=t;r<i.length;r++)n(i[r]);return e},Tu.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.vn(r)},Tu),fu=(Object.defineProperty(Eu.prototype,"readTime",{get:function(){return this.Fn},set:function(t){this.Fn=t},enumerable:!0,configurable:!0}),Eu.prototype.Nn=function(t,e){this.kn(),this.readTime=e,this.Dn.set(t.key,t)},Eu.prototype.$n=function(t,e){this.kn(),e&&(this.readTime=e),this.Dn.set(t,null)},Eu.prototype.Mn=function(t,e){this.kn();var n=this.Dn.get(e);return void 0!==n?cu.resolve(n):this.Ln(t,e)},Eu.prototype.getEntries=function(t,e){return this.On(t,e)},Eu.prototype.apply=function(t){return this.kn(),this.Cn=!0,this.xn(t)},Eu.prototype.kn=function(){},Eu),lu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",pu=(bu.prototype.qn=function(t){this.Bn.push(t)},bu.prototype.Un=function(){this.Bn.forEach((function(t){return t()}))},bu),du=(wu.prototype.Kn=function(t,e){var n=this;return this.Wn.Gn(t,e).next((function(r){return n.zn(t,e,r)}))},wu.prototype.zn=function(t,e,n){return this.Qn.Mn(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].ot(e,t);return t}))},wu.prototype.Hn=function(t,e,n){var r=fs();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].ot(t,e);r=r.Ae(t,e)})),r},wu.prototype.Yn=function(t,e){var n=this;return this.Qn.getEntries(t,e).next((function(e){return n.Jn(t,e)}))},wu.prototype.Jn=function(t,e){var n=this;return this.Wn.Xn(t,e).next((function(r){var i=n.Hn(t,e,r),o=cs();return i.forEach((function(t,e){e=e||new Io(t,Vr.min()),o=o.Ae(t,e)})),o}))},wu.prototype.Zn=function(t,e,n){return e.Ot()?this.tr(t,e.path):e._e()?this.er(t,e,n):this.sr(t,e,n)},wu.prototype.tr=function(t,e){return this.Kn(t,new Xr(e)).next((function(t){var e=ps();return t instanceof To&&(e=e.Ae(t.key,t)),e}))},wu.prototype.er=function(t,e,n){var r=this,i=e.collectionGroup,o=ps();return this.jn.ir(t,i).next((function(s){return cu.forEach(s,(function(s){var u=e.Zt(s.child(i));return r.sr(t,u,n).next((function(t){t.forEach((function(t,e){o=o.Ae(t,e)}))}))})).next((function(){return o}))}))},wu.prototype.sr=function(t,e,n){var r,i,o=this;return this.Qn.Zn(t,e,n).next((function(n){return r=n,o.Wn.nr(t,e)})).next((function(e){return i=e,o.rr(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],h=a.key,c=r.get(h),f=a.ot(c,c,o.Tn);r=f instanceof To?r.Ae(h,f):r.remove(h)}}))})).next((function(){return r.forEach((function(t,n){e.matches(n)||(r=r.remove(t))})),r}))},wu.prototype.rr=function(t,e,n){for(var r=gs(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof zi&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Qn.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof To&&(h=h.Ae(t,e))})),h}))},wu),yu=(mu.ar=function(t,e){for(var n=gs(),r=gs(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new mu(t,e.fromCache,n,r)},mu),vu=(gu.prototype.cr=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},gu.prototype.next=function(){var t=++this.previousValue;return this._r&&this._r(t),t},gu);function gu(t,e){var n=this;this.previousValue=t,e&&(e.ur=function(t){return n.cr(t)},this._r=function(t){return e.lr(t)})}function mu(t,e,n,r){this.targetId=t,this.fromCache=e,this.hr=n,this.or=r}function wu(t,e,n){this.Qn=t,this.Wn=e,this.jn=n}function bu(){this.Bn=[]}function Eu(){this.Dn=new uu((function(t){return t.toString()})),this.Cn=!1}function Tu(t){var e=this;this.An=null,this.mn=null,this.result=void 0,this.error=void 0,this.Pn=!1,this.Vn=!1,t((function(t){e.Pn=!0,e.result=t,e.An&&e.An(t)}),(function(t){e.Pn=!0,e.error=t,e.mn&&e.mn(t)}))}function Iu(t,e,n,r,i){this.batch=t,this.wn=e,this.En=n,this.streamToken=r,this.Rn=i}function Nu(t,e,n,r){this.batchId=t,this.Tn=e,this.baseMutations=n,this.mutations=r}function Au(t){this.dn=t,this.fn={}}function _u(t,e){this.projectId=t,this.database=e||"(default)"}function Su(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}vu.dr=-1;var ku=(Pu.prototype.reset=function(){this.Ar=0},Pu.prototype.Vr=function(){this.Ar=this.Rr},Pu.prototype.gr=function(t){var e=this;this.cancel();var n=Math.floor(this.Ar+this.pr()),r=Math.max(0,Date.now()-this.Pr),i=Math.max(0,n-r);0<i&&Ys("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ar+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.mr=this.Tr.yr(this.Er,i,(function(){return e.Pr=Date.now(),t()})),this.Ar*=this.wr,this.Ar<this.Ir&&(this.Ar=this.Ir),this.Ar>this.Rr&&(this.Ar=this.Rr)},Pu.prototype.cancel=function(){null!==this.mr&&(this.mr.cancel(),this.mr=null)},Pu.prototype.pr=function(){return(Math.random()-.5)*this.Ar},Pu),Du=(Ru.Cr=function(t,e,n,r,i){var o=new Ru(t,e,Date.now()+n,r,i);return o.start(n),o},Ru.prototype.start=function(t){var e=this;this.Fr=setTimeout((function(){return e.Nr()}),t)},Ru.prototype.kr=function(){return this.Nr()},Ru.prototype.cancel=function(t){null!==this.Fr&&(this.clearTimeout(),this.Dr.reject(new kr(Sr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ru.prototype.Nr=function(){var t=this;this.br.$r((function(){return null!==t.Fr?(t.clearTimeout(),t.op().then((function(e){return t.Dr.resolve(e)}))):Promise.resolve()}))},Ru.prototype.clearTimeout=function(){null!==this.Fr&&(this.Sr(this),clearTimeout(this.Fr),this.Fr=null)},Ru),xu=(Object.defineProperty(Ou.prototype,"Kr",{get:function(){return this.Or},enumerable:!0,configurable:!0}),Ou.prototype.$r=function(t){this.enqueue(t)},Ou.prototype.Gr=function(t){this.zr(),this.Hr(t)},Ou.prototype.Yr=function(t){return this.zr(),this.Hr(t)},Ou.prototype.Jr=function(t){return u(this,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return this.zr(),this.Or?[3,2]:(this.Or=!0,(e=zs.nt().window)&&e.removeEventListener("visibilitychange",this.Wr),[4,this.Yr(t)]);case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},Ou.prototype.enqueue=function(t){return this.zr(),this.Or?new Promise((function(t){})):this.Hr(t)},Ou.prototype.Xr=function(t){var e=this;this.zr(),this.Or||(this.Lr=this.Lr.then((function(){var n=new Su;return e.$r((function r(){return u(e,void 0,void 0,(function(){var e;return a(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,t()];case 1:return i.sent(),n.resolve(),this.Qr.reset(),[3,3];case 2:if("IndexedDbTransactionError"!==(e=i.sent()).name)throw n.resolve(),e;return Ys("AsyncQueue","Operation failed with retryable error: "+e),this.Qr.gr(r),[3,3];case 3:return[2]}}))}))})),n.promise})))},Ou.prototype.Hr=function(t){var e=this,n=this.Mr.then((function(){return e.qr=!0,t().catch((function(t){throw e.Br=t,e.qr=!1,Xs("INTERNAL UNHANDLED ERROR: ",t.stack||t.message||""),t})).then((function(t){return e.qr=!1,t}))}));return this.Mr=n},Ou.prototype.yr=function(t,e,n){var r=this;this.zr(),-1<this.Ur.indexOf(t)&&(e=0);var i=Du.Cr(this,t,e,n,(function(t){return r.Zr(t)}));return this.xr.push(i),i},Ou.prototype.zr=function(){this.Br&&Js()},Ou.prototype.th=function(){},Ou.prototype.eh=function(){return u(this,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:return[4,t=this.Mr];case 1:e.sent(),e.label=2;case 2:if(t!==this.Mr)return[3,0];e.label=3;case 3:return[2]}}))}))},Ou.prototype.sh=function(t){for(var e=0,n=this.xr;e<n.length;e++)if(n[e].Er===t)return!0;return!1},Ou.prototype.jr=function(t){var e=this;return this.eh().then((function(){e.xr.sort((function(t,e){return t.vr-e.vr}));for(var n=0,r=e.xr;n<r.length;n++){var i=r[n];if(i.kr(),"all"!==t&&i.Er===t)break}return e.eh()}))},Ou.prototype.ih=function(t){this.Ur.push(t)},Ou.prototype.Zr=function(t){var e=this.xr.indexOf(t);this.xr.splice(e,1)},Ou);function Ou(){var t=this;this.Mr=Promise.resolve(),this.Lr=Promise.resolve(),this.Or=!1,this.xr=[],this.Br=null,this.qr=!1,this.Ur=[],this.Qr=new ku(this,"async_queue_retry"),this.Wr=function(){t.jr("async_queue_retry")};var e=zs.nt().window;e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Wr)}function Ru(t,e,n,r,i){this.br=t,this.Er=e,this.vr=n,this.op=r,this.Sr=i,this.Dr=new Su,this.then=this.Dr.promise.then.bind(this.Dr.promise),this.catch=this.Dr.promise.catch.bind(this.Dr.promise),this.Dr.promise.catch((function(t){}))}function Pu(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Tr=t,this.Er=e,this.Ir=n,this.wr=r,this.Rr=i,this.Ar=0,this.mr=null,this.Pr=Date.now(),this.reset()}function Vu(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=nu(n,i);return 0===s?nu(r,o):s}var Lu=(ju.prototype.hh=function(){return++this.rh},ju.prototype.oh=function(t){var e=[t,this.hh()];if(this.buffer.size<this.nh)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Vu(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(ju.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),ju),Cu={ah:!1,uh:0,_h:0,lh:0},Mu=(Uu.Eh=function(t){return new Uu(t,Uu.Ih,Uu.wh)},Uu);function Uu(t,e,n){this.dh=t,this.fh=e,this.Th=n}function ju(t){this.nh=t,this.buffer=new os(Vu),this.rh=0}Mu.Rh=-1,Mu.Ah=1048576,Mu.mh=41943040,Mu.Ih=10,Mu.wh=1e3,Mu.Ph=new Mu(Mu.mh,Mu.Ih,Mu.wh),Mu.DISABLED=new Mu(Mu.Rh,0,0);var qu=(Gu.prototype.start=function(t){this.Vh.yh.dh!==Mu.Rh&&this.bh(t)},Gu.prototype.stop=function(){this.ph&&(this.ph.cancel(),this.ph=null)},Object.defineProperty(Gu.prototype,"vh",{get:function(){return null!==this.ph},enumerable:!0,configurable:!0}),Gu.prototype.bh=function(t){var e=this,n=this.gh?3e5:6e4;Ys("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ph=this.br.yr("lru_garbage_collection",n,(function(){return u(e,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:this.ph=null,this.gh=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.Sh(this.Vh)];case 2:return n.sent(),[3,7];case 3:return"IndexedDbTransactionError"!==(e=n.sent()).name?[3,4]:(Ys("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]);case 4:return[4,Th(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.bh(t)];case 8:return n.sent(),[2]}}))}))}))},Gu),Fu=(Bu.prototype.Ch=function(t,e){return this.Dh.Fh(t).next((function(t){return Math.floor(e/100*t)}))},Bu.prototype.Nh=function(t,e){var n=this;if(0===e)return cu.resolve(vu.dr);var r=new Lu(e);return this.Dh.js(t,(function(t){return r.oh(t.sequenceNumber)})).next((function(){return n.Dh.kh(t,(function(t){return r.oh(t)}))})).next((function(){return r.maxValue}))},Bu.prototype.$h=function(t,e,n){return this.Dh.$h(t,e,n)},Bu.prototype.Mh=function(t,e){return this.Dh.Mh(t,e)},Bu.prototype.Lh=function(t,e){var n=this;return this.yh.dh===Mu.Rh?(Ys("LruGarbageCollector","Garbage collection skipped; disabled"),cu.resolve(Cu)):this.Oh(t).next((function(r){return r<n.yh.dh?(Ys("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.yh.dh),Cu):n.xh(t,e)}))},Bu.prototype.Oh=function(t){return this.Dh.Oh(t)},Bu.prototype.xh=function(t,e){var n,i,o,s,u,a,h,c=this,f=Date.now();return this.Ch(t,this.yh.fh).next((function(e){return i=e>c.yh.Th?(Ys("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.yh.Th+" from "+e),c.yh.Th):e,s=Date.now(),c.Nh(t,i)})).next((function(r){return n=r,u=Date.now(),c.$h(t,n,e)})).next((function(e){return o=e,a=Date.now(),c.Mh(t,n)})).next((function(t){return h=Date.now(),Ks()<=r.DEBUG&&Ys("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(h-a)+"ms\nTotal Duration: "+(h-f)+"ms"),cu.resolve({ah:!0,uh:i,_h:o,lh:t})}))},Bu);function Bu(t,e){this.Dh=t,this.yh=e}function Gu(t,e){this.Vh=t,this.br=e,this.gh=!1,this.ph=null}function zu(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=Qu(e)),e=Wu(t.get(n),e);return Qu(e)}function Wu(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Qu(t){return t+""}function Ku(t){var e=t.length;if(Zs(2<=e),2===e)return Zs(""===t.charAt(0)&&""===t.charAt(1)),Cr.G;for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Js(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Js()}o=s+2}return new Cr(r)}var Hu,Yu=(ia.qh=function(t,e,n){return Ys("SimpleDb","Opening database:",t),new cu((function(r,i){var o=window.indexedDB.open(t,e);o.onsuccess=function(t){var e=t.target.result;r(new ia(e))},o.onblocked=function(){i(new kr(Sr.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},o.onerror=function(t){var e=t.target.error;"VersionError"===e.name?i(new kr(Sr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):i(e)},o.onupgradeneeded=function(e){Ys("SimpleDb",'Database "'+t+'" requires upgrade from version:',e.oldVersion);var r=e.target.result;n.createOrUpgrade(r,o.transaction,e.oldVersion,Va).next((function(){Ys("SimpleDb","Database upgrade to version "+Va+" complete")}))}})).yn()},ia.delete=function(t){return Ys("SimpleDb","Removing database:",t),oa(window.indexedDB.deleteDatabase(t)).yn()},ia.Uh=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(ia.Qh())return!0;if(void 0===window.navigator)return!1;var t=v(),e=ia.Bh(t),n=0<e&&e<10,r=ia.Wh(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},ia.Qh=function(){var t;return"undefined"!=typeof __PRIVATE_process&&"YES"===(null===(t=__PRIVATE_process.__PRIVATE_env)||void 0===t?void 0:t.jh)},ia.Kh=function(t,e){return t.store(e)},ia.Bh=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},ia.Wh=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},ia.prototype.Gh=function(t){this.db.onversionchange=function(e){return t(e)}},ia.prototype.runTransaction=function(t,e,n){return u(this,void 0,void 0,(function(){var r,i,o,s,u;return a(this,(function(h){switch(h.label){case 0:r="readonly"===t,i=0,o=function(){var t,o,u,h,c;return a(this,(function(a){switch(a.label){case 0:++i,t=Ju.open(s.db,r?"readonly":"readwrite",e),a.label=1;case 1:return a.trys.push([1,3,,4]),o=n(t).catch((function(e){return t.abort(e),cu.reject(e)})).yn(),u={},o.catch((function(){})),[4,t.zh];case 2:return[2,(u.value=(a.sent(),o),u)];case 3:return h=a.sent(),c="FirebaseError"!==h.name&&i<3,Ys("SimpleDb","Transaction failed with error: %s. Retrying: %s.",h.message,c),c?[3,4]:[2,{value:Promise.reject(h)}];case 4:return[2]}}))},s=this,h.label=1;case 1:return[5,o()];case 2:if("object"==typeof(u=h.sent()))return[2,u.value];h.label=3;case 3:return[3,1];case 4:return[2]}}))}))},ia.prototype.close=function(){this.db.close()},ia),Xu=(Object.defineProperty(ra.prototype,"Pn",{get:function(){return this.Yh},enumerable:!0,configurable:!0}),Object.defineProperty(ra.prototype,"Xh",{get:function(){return this.Jh},enumerable:!0,configurable:!0}),Object.defineProperty(ra.prototype,"cursor",{set:function(t){this.Hh=t},enumerable:!0,configurable:!0}),ra.prototype.done=function(){this.Yh=!0},ra.prototype.Zh=function(t){this.Jh=t},ra.prototype.delete=function(){return oa(this.Hh.delete())},ra),$u=(s(na,Hu=kr),na),Ju=(ea.open=function(t,e,n){return new ea(t.transaction(n,e))},Object.defineProperty(ea.prototype,"zh",{get:function(){return this.to.promise},enumerable:!0,configurable:!0}),ea.prototype.abort=function(t){t&&this.to.reject(t),this.aborted||(Ys("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},ea.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Zu(e)},ea),Zu=(ta.prototype.put=function(t,e){return oa(void 0!==e?(Ys("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Ys("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},ta.prototype.add=function(t){return Ys("SimpleDb","ADD",this.store.name,t,t),oa(this.store.add(t))},ta.prototype.get=function(t){var e=this;return oa(this.store.get(t)).next((function(n){return void 0===n&&(n=null),Ys("SimpleDb","GET",e.store.name,t,n),n}))},ta.prototype.delete=function(t){return Ys("SimpleDb","DELETE",this.store.name,t),oa(this.store.delete(t))},ta.prototype.count=function(){return Ys("SimpleDb","COUNT",this.store.name),oa(this.store.count())},ta.prototype.eo=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.so(n,(function(t,e){r.push(e)})).next((function(){return r}))},ta.prototype.io=function(t,e){Ys("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.no=!1;var r=this.cursor(n);return this.so(r,(function(t,e,n){return n.delete()}))},ta.prototype.ro=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.so(r,e)},ta.prototype.ho=function(t){var e=this.cursor({});return new cu((function(n,r){e.onerror=function(t){var e=ua(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},ta.prototype.so=function(t,e){var n=[];return new cu((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Xu(i),s=e(i.primaryKey,i.value,o);if(s instanceof cu){var u=s.catch((function(t){return o.done(),cu.reject(t)}));n.push(u)}o.Pn?r():null===o.Xh?i.continue():i.continue(o.Xh)}else r()}})).next((function(){return cu.vn(n)}))},ta.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},ta.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.no?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},ta);function ta(t){this.store=t}function ea(t){var e=this;this.transaction=t,this.aborted=!1,this.to=new Su,this.transaction.oncomplete=function(){e.to.resolve()},this.transaction.onabort=function(){t.error?e.to.reject(new $u(t.error)):e.to.resolve()},this.transaction.onerror=function(t){var n=ua(t.target.error);e.to.reject(new $u(n))}}function na(t){var e=this;return(e=Hu.call(this,Sr.UNAVAILABLE,"IndexedDB transaction failed: "+t)||this).name="IndexedDbTransactionError",e}function ra(t){this.Hh=t,this.Yh=!1,this.Jh=null}function ia(t){this.db=t,12.2===ia.Bh(v())&&Xs("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function oa(t){return new cu((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=ua(t.target.error);n(e)}}))}var sa=!1;function ua(t){var e=Yu.Bh(v());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new kr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return sa||(sa=!0,setTimeout((function(){throw r}),0)),r}}return t}var aa=(ha.uo=function(t,e,n,r){return Zs(""!==t.uid),new ha(t.t()?t.uid:"",e,n,r)},ha.prototype.co=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return la(t).ro({index:Fa.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},ha.prototype._o=function(t,e,n){return this.lo(t).next((function(e){return e.lastStreamToken=n.toBase64(),da(t).put(e)}))},ha.prototype.do=function(t){return this.lo(t).next((function(t){return ei.fromBase64String(t.lastStreamToken)}))},ha.prototype.fo=function(t,e){return this.lo(t).next((function(n){return n.lastStreamToken=e.toBase64(),da(t).put(n)}))},ha.prototype.To=function(t,e,n,r){var i=this,o=pa(t),s=la(t);return s.add({}).next((function(u){Zs("number"==typeof u);for(var a=new au(u,e,n,r),h=i.serializer.Eo(i.userId,a),c=[],f=new os((function(t,e){return nu(t.j(),e.j())})),l=0,p=r;l<p.length;l++){var d=p[l],y=Ba.key(i.userId,d.key.path,u);f=f.add(d.key.path.M()),c.push(s.put(h)),c.push(o.put(y,Ba.PLACEHOLDER))}return f.forEach((function(e){c.push(i.jn.Io(t,e))})),t.qn((function(){i.ao[u]=a.keys()})),cu.vn(c).next((function(){return a}))}))},ha.prototype.wo=function(t,e){var n=this;return la(t).get(e).next((function(t){return t?(Zs(t.userId===n.userId),n.serializer.Ro(t)):null}))},ha.prototype.Ao=function(t,e){var n=this;return this.ao[e]?cu.resolve(this.ao[e]):this.wo(t,e).next((function(t){if(t){var r=t.keys();return n.ao[e]=r}return null}))},ha.prototype.mo=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return la(t).ro({index:Fa.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(Zs(e.batchId>=r),o=n.serializer.Ro(e)),i.done()})).next((function(){return o}))},ha.prototype.Po=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return la(t).ro({index:Fa.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},ha.prototype.Vo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return la(t).eo(Fa.userMutationsIndex,n).next((function(t){return t.map((function(t){return e.serializer.Ro(t)}))}))},ha.prototype.Gn=function(t,e){var n=this,r=Ba.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return pa(t).ro({range:i},(function(r,i,s){var u=r[0],a=r[1],h=r[2],c=Ku(a);if(u===n.userId&&e.path.isEqual(c))return la(t).get(h).next((function(t){if(!t)throw Js();Zs(t.userId===n.userId),o.push(n.serializer.Ro(t))}));s.done()})).next((function(){return o}))},ha.prototype.Xn=function(t,e){var n=this,r=new os(nu),i=[];return e.forEach((function(e){var o=Ba.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=pa(t).ro({range:s},(function(t,i,o){var s=t[0],u=t[1],a=t[2],h=Ku(u);s===n.userId&&e.path.isEqual(h)?r=r.add(a):o.done()}));i.push(u)})),cu.vn(i).next((function(){return n.po(t,r)}))},ha.prototype.nr=function(t,e){var n=this,r=e.path,i=r.length+1,o=Ba.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new os(nu);return pa(t).ro({range:s},(function(t,e,o){var s=t[0],a=t[1],h=t[2],c=Ku(a);s===n.userId&&r.q(c)?c.length===i&&(u=u.add(h)):o.done()})).next((function(){return n.po(t,u)}))},ha.prototype.po=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(la(t).get(e).next((function(t){if(null===t)throw Js();Zs(t.userId===n.userId),r.push(n.serializer.Ro(t))})))})),cu.vn(i).next((function(){return r}))},ha.prototype.yo=function(t,e){var n=this;return fa(t.bo,this.userId,e).next((function(r){return t.qn((function(){n.vo(e.batchId)})),cu.forEach(r,(function(e){return n.oo.So(t,e)}))}))},ha.prototype.vo=function(t){delete this.ao[t]},ha.prototype.Do=function(t){var e=this;return this.co(t).next((function(n){if(!n)return cu.resolve();var r=IDBKeyRange.lowerBound(Ba.prefixForUser(e.userId)),i=[];return pa(t).ro({range:r},(function(t,n,r){if(t[0]===e.userId){var o=Ku(t[1]);i.push(o)}else r.done()})).next((function(){Zs(0===i.length)}))}))},ha.prototype.Co=function(t,e){return ca(t,this.userId,e)},ha.prototype.lo=function(t){var e=this;return da(t).get(this.userId).next((function(t){return t||new qa(e.userId,-1,"")}))},ha);function ha(t,e,n,r){this.userId=t,this.serializer=e,this.jn=n,this.oo=r,this.ao={}}function ca(t,e,n){var r=Ba.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return pa(t).ro({range:o,no:!0},(function(t,n,r){var o=t[0],u=t[1];t[2],o===e&&u===i&&(s=!0),r.done()})).next((function(){return s}))}function fa(t,e,n){var r=t.store(Fa.store),i=t.store(Ba.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.ro({range:s},(function(t,e,n){return u++,n.delete()}));o.push(a.next((function(){Zs(1===u)})));for(var h=[],c=0,f=n.mutations;c<f.length;c++){var l=f[c],p=Ba.key(e,l.key.path,n.batchId);o.push(i.delete(p)),h.push(l.key)}return cu.vn(o).next((function(){return h}))}function la(t){return ah.Kh(t,Fa.store)}function pa(t){return ah.Kh(t,Ba.store)}function da(t){return ah.Kh(t,qa.store)}var ya=(ma.prototype.next=function(){return this.Fo+=2,this.Fo},ma.No=function(){return new ma(0)},ma.ko=function(){return new ma(-1)},ma),va=(ga.prototype.$o=function(t){var e=this;return this.Mo(t).next((function(n){var r=new ya(n.highestTargetId);return n.highestTargetId=r.next(),e.Lo(t,n).next((function(){return n.highestTargetId}))}))},ga.prototype.Oo=function(t){return this.Mo(t).next((function(t){return Vr.v(new Pr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},ga.prototype.xo=function(t){return Ea(t.bo)},ga.prototype.Bo=function(t,e,n){var r=this;return this.Mo(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.C()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Lo(t,i)}))},ga.prototype.qo=function(t,e){var n=this;return this.Uo(t,e).next((function(){return n.Mo(t).next((function(r){return r.targetCount+=1,n.Qo(e,r),n.Lo(t,r)}))}))},ga.prototype.Wo=function(t,e){return this.Uo(t,e)},ga.prototype.jo=function(t,e){var n=this;return this.Ko(t,e.targetId).next((function(){return wa(t).delete(e.targetId)})).next((function(){return n.Mo(t)})).next((function(e){return Zs(0<e.targetCount),--e.targetCount,n.Lo(t,e)}))},ga.prototype.$h=function(t,e,n){var r=this,i=0,o=[];return wa(t).ro((function(s,u){var a=r.serializer.Go(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.jo(t,a)))})).next((function(){return cu.vn(o)})).next((function(){return i}))},ga.prototype.js=function(t,e){var n=this;return wa(t).ro((function(t,r){var i=n.serializer.Go(r);e(i)}))},ga.prototype.Mo=function(t){return ba(t.bo)},ga.prototype.Lo=function(t,e){return ah.Kh(t,Xa.store).put(Xa.key,e)},ga.prototype.Uo=function(t,e){return wa(t).put(this.serializer.zo(e))},ga.prototype.Qo=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},ga.prototype.Ho=function(t){return this.Mo(t).next((function(t){return t.targetCount}))},ga.prototype.Yo=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return wa(t).ro({range:i,index:Ha.queryTargetsIndexName},(function(t,r,i){var s=n.serializer.Go(r);e.isEqual(s.target)&&(o=s,i.done())})).next((function(){return o}))},ga.prototype.Jo=function(t,e,n){var r=this,i=[],o=Ta(t);return e.forEach((function(e){var s=zu(e.path);i.push(o.put(new Ya(n,s))),i.push(r.oo.Xo(t,n,e))})),cu.vn(i)},ga.prototype.Zo=function(t,e,n){var r=this,i=Ta(t);return cu.forEach(e,(function(e){var o=zu(e.path);return cu.vn([i.delete([n,o]),r.oo.ta(t,n,e)])}))},ga.prototype.Ko=function(t,e){var n=Ta(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},ga.prototype.ea=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Ta(t),i=gs();return r.ro({range:n,no:!0},(function(t,e,n){var r=Ku(t[1]),o=new Xr(r);i=i.add(o)})).next((function(){return i}))},ga.prototype.Co=function(t,e){var n=zu(e.path),r=IDBKeyRange.bound([n],[iu(n)],!1,!0),i=0;return Ta(t).ro({index:Ya.documentTargetsIndex,no:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return 0<i}))},ga.prototype.si=function(t,e){var n=this;return wa(t).get(e).next((function(t){return t?n.serializer.Go(t):null}))},ga);function ga(t,e){this.oo=t,this.serializer=e}function ma(t){this.Fo=t}function wa(t){return ah.Kh(t,Ha.store)}function ba(t){return Yu.Kh(t,Xa.store).get(Xa.key).next((function(t){return Zs(null!==t),t}))}function Ea(t){return ba(t).next((function(t){return t.highestListenSequenceNumber}))}function Ta(t){return ah.Kh(t,Ya.store)}var Ia,Na=(Aa.prototype.Nn=function(t,e,n){return Sa(t).put(ka(e),n)},Aa.prototype.$n=function(t,e){var n=Sa(t),r=ka(e);return n.delete(r)},Aa.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.sa(t,r)}))},Aa.prototype.Mn=function(t,e){var n=this;return Sa(t).get(ka(e)).next((function(t){return n.ia(t)}))},Aa.prototype.na=function(t,e){var n=this;return Sa(t).get(ka(e)).next((function(t){var e=n.ia(t);return e?{ra:e,size:Da(t)}:null}))},Aa.prototype.getEntries=function(t,e){var n=this,r=fs();return this.ha(t,e,(function(t,e){var i=n.ia(e);r=r.Ae(t,i)})).next((function(){return r}))},Aa.prototype.oa=function(t,e){var n=this,r=fs(),i=new Jo(Xr.N);return this.ha(t,e,(function(t,e){var o=n.ia(e);i=o?(r=r.Ae(t,o),i.Ae(t,Da(e))):(r=r.Ae(t,null),i.Ae(t,0))})).next((function(){return{aa:r,ua:i}}))},Aa.prototype.ha=function(t,e,n){if(e.B())return cu.resolve();var r=IDBKeyRange.bound(e.first().path.W(),e.last().path.W()),i=e.be(),o=i.Ne();return Sa(t).ro({range:r},(function(t,e,r){for(var s=Xr.st(t);o&&Xr.N(o,s)<0;)n(o,null),o=i.Ne();o&&o.isEqual(s)&&(n(o,e),o=i.ke()?i.Ne():null),o?r.Zh(o.path.W()):r.done()})).next((function(){for(;o;)n(o,null),o=i.ke()?i.Ne():null}))},Aa.prototype.Zn=function(t,e,n){var r=this,i=ps(),o=e.path.length+1,s={};if(n.isEqual(Vr.min())){var u=e.path.W();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.W(),h=this.serializer.ca(n);s.range=IDBKeyRange.lowerBound([a,h],!0),s.index=Qa.collectionReadTimeIndex}return Sa(t).ro(s,(function(t,n,s){if(t.length===o){var u=r.serializer._a(n);e.path.q(u.key.path)?u instanceof To&&e.matches(u)&&(i=i.Ae(u.key,u)):s.done()}})).next((function(){return i}))},Aa.prototype.la=function(t,e){var n=this,r=cs(),i=this.serializer.ca(e),o=Sa(t),s=IDBKeyRange.lowerBound(i,!0);return o.ro({index:Qa.readTimeIndex,range:s},(function(t,e){var o=n.serializer._a(e);r=r.Ae(o.key,o),i=e.readTime})).next((function(){return{da:r,readTime:n.serializer.fa(i)}}))},Aa.prototype.Ta=function(t){var e=this,n=Sa(t),r=Vr.min();return n.ro({index:Qa.readTimeIndex,reverse:!0},(function(t,n,i){n.readTime&&(r=e.serializer.fa(n.readTime)),i.done()})).next((function(){return r}))},Aa.prototype.Ea=function(t){return new Aa.Ia(this,!!t&&t.wa)},Aa.prototype.Ra=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},Aa.prototype.getMetadata=function(t){return _a(t).get(Ka.key).next((function(t){return Zs(!!t),t}))},Aa.prototype.sa=function(t,e){return _a(t).put(Ka.key,e)},Aa.prototype.ia=function(t){if(t){var e=this.serializer._a(t);return e instanceof Io&&e.version.isEqual(Vr.min())?null:e}return null},Aa);function Aa(t,e){this.serializer=t,this.jn=e}function _a(t){return ah.Kh(t,Ka.store)}function Sa(t){return ah.Kh(t,Qa.store)}function ka(t){return t.path.W()}function Da(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Js();e=t.noDocument}return JSON.stringify(e).length}function xa(t,e){var n=this;return(n=Ia.call(this)||this).Aa=t,n.wa=e,n.ma=new uu((function(t){return t.toString()})),n}function Oa(t,e){this.seconds=t,this.nanoseconds=e}Na.Ia=(s(xa,Ia=fu),xa.prototype.xn=function(t){var e=this,n=[],r=0,i=new os((function(t,e){return nu(t.j(),e.j())}));return this.Dn.forEach((function(o,s){var u=e.ma.get(o);if(s){var a=e.Aa.serializer.Pa(s,e.readTime);i=i.add(o.path.M());var h=Da(a);r+=h-u,n.push(e.Aa.Nn(t,o,a))}else if(r-=u,e.wa){var c=e.Aa.serializer.Pa(new Io(o,Vr.min()),e.readTime);n.push(e.Aa.Nn(t,o,c))}else n.push(e.Aa.$n(t,o))})),i.forEach((function(r){n.push(e.Aa.jn.Io(t,r))})),n.push(this.Aa.updateMetadata(t,r)),cu.vn(n)},xa.prototype.Ln=function(t,e){var n=this;return this.Aa.na(t,e).next((function(t){return null===t?(n.ma.set(e,0),null):(n.ma.set(e,t.size),t.ra)}))},xa.prototype.On=function(t,e){var n=this;return this.Aa.oa(t,e).next((function(t){var e=t.aa;return t.ua.forEach((function(t,e){n.ma.set(t,e)})),e}))},xa);var Ra=(ja.prototype.Io=function(t,e){return this.Va.add(e),cu.resolve()},ja.prototype.ir=function(t,e){return cu.resolve(this.Va.getEntries(e))},ja),Pa=(Ua.prototype.add=function(t){var e=t.O(),n=t.M(),r=this.index[e]||new os(Cr.N),i=!r.has(n);return this.index[e]=r.add(n),i},Ua.prototype.has=function(t){var e=t.O(),n=t.M(),r=this.index[e];return r&&r.has(n)},Ua.prototype.getEntries=function(t){return(this.index[t]||new os(Cr.N)).W()},Ua),Va=10,La=(Ma.prototype.createOrUpgrade=function(t,e,n,r){var i=this;Zs(n<r&&0<=n&&r<=Va);var o,s=new Ju(e);n<1&&1<=r&&(t.createObjectStore(Ca.store),(o=t).createObjectStore(qa.store,{keyPath:qa.keyPath}),o.createObjectStore(Fa.store,{keyPath:Fa.keyPath,autoIncrement:!0}).createIndex(Fa.userMutationsIndex,Fa.userMutationsKeyPath,{unique:!0}),o.createObjectStore(Ba.store),Ja(t),t.createObjectStore(Qa.store));var u,a=cu.resolve();return n<3&&3<=r&&(0!==n&&((u=t).deleteObjectStore(Ya.store),u.deleteObjectStore(Ha.store),u.deleteObjectStore(Xa.store),Ja(t)),a=a.next((function(){return t=s.store(Xa.store),e=new Xa(0,0,Vr.min().C(),0),t.put(Xa.key,e);var t,e}))),n<4&&4<=r&&(0!==n&&(a=a.next((function(){return e=t,(n=s).store(Fa.store).eo().next((function(t){e.deleteObjectStore(Fa.store),e.createObjectStore(Fa.store,{keyPath:Fa.keyPath,autoIncrement:!0}).createIndex(Fa.userMutationsIndex,Fa.userMutationsKeyPath,{unique:!0});var r=n.store(Fa.store),i=t.map((function(t){return r.put(t)}));return cu.vn(i)}));var e,n}))),a=a.next((function(){t.createObjectStore(Za.store,{keyPath:Za.keyPath})}))),n<5&&5<=r&&(a=a.next((function(){return i.removeAcknowledgedMutations(s)}))),n<6&&6<=r&&(a=a.next((function(){return t.createObjectStore(Ka.store),i.addDocumentGlobal(s)}))),n<7&&7<=r&&(a=a.next((function(){return i.ensureSequenceNumbers(s)}))),n<8&&8<=r&&(a=a.next((function(){return i.createCollectionParentIndex(t,s)}))),n<9&&9<=r&&(a=a.next((function(){var n,r;(r=t).objectStoreNames.contains("remoteDocumentChanges")&&r.deleteObjectStore("remoteDocumentChanges"),(n=e.objectStore(Qa.store)).createIndex(Qa.readTimeIndex,Qa.readTimeIndexPath,{unique:!1}),n.createIndex(Qa.collectionReadTimeIndex,Qa.collectionReadTimeIndexPath,{unique:!1})}))),n<10&&10<=r&&(a=a.next((function(){return i.rewriteCanonicalIds(s)}))),a},Ma.prototype.addDocumentGlobal=function(t){var e=0;return t.store(Qa.store).ro((function(t,n){e+=Da(n)})).next((function(){var n=new Ka(e);return t.store(Ka.store).put(Ka.key,n)}))},Ma.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(qa.store),r=t.store(Fa.store);return n.eo().next((function(n){return cu.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.eo(Fa.userMutationsIndex,i).next((function(r){return cu.forEach(r,(function(r){Zs(r.userId===n.userId);var i=e.serializer.Ro(r);return fa(t,n.userId,i).next((function(){}))}))}))}))}))},Ma.prototype.ensureSequenceNumbers=function(t){var e=t.store(Ya.store),n=t.store(Qa.store);return Ea(t).next((function(t){var r=[];return n.ro((function(n,i){var o=new Cr(n),s=[0,zu(o)];r.push(e.get(s).next((function(n){return n?cu.resolve():(r=o,e.put(new Ya(0,zu(r),t)));var r})))})).next((function(){return cu.vn(r)}))}))},Ma.prototype.createCollectionParentIndex=function(t,e){function n(t){if(i.add(t)){var e=t.O(),n=t.M();return r.put({collectionId:e,parent:zu(n)})}}t.createObjectStore($a.store,{keyPath:$a.keyPath});var r=e.store($a.store),i=new Pa;return e.store(Qa.store).ro({no:!0},(function(t,e){return n(new Cr(t).M())})).next((function(){return e.store(Ba.store).ro({no:!0},(function(t,e){t[0];var r=t[1];return n((t[2],Ku(r)).M())}))}))},Ma.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(Ha.store);return n.ro((function(t,r){var i=e.serializer.Go(r),o=e.serializer.zo(i);return n.put(o)}))},Ma),Ca=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Ma(t){this.serializer=t}function Ua(){this.index={}}function ja(){this.Va=new Pa}Ca.store="owner",Ca.key="owner";var qa=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};qa.store="mutationQueues",qa.keyPath="userId";var Fa=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Fa.store="mutations",Fa.keyPath="batchId",Fa.userMutationsIndex="userMutationsIndex",Fa.userMutationsKeyPath=["userId","batchId"];var Ba=(Ga.prefixForUser=function(t){return[t]},Ga.prefixForPath=function(t,e){return[t,zu(e)]},Ga.key=function(t,e,n){return[t,zu(e),n]},Ga);function Ga(){}function za(t,e){this.path=t,this.readTime=e}function Wa(t,e){this.path=t,this.version=e}Ba.store="documentMutations",Ba.PLACEHOLDER=new Ba;var Qa=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Qa.store="remoteDocuments",Qa.readTimeIndex="readTimeIndex",Qa.readTimeIndexPath="readTime",Qa.collectionReadTimeIndex="collectionReadTimeIndex",Qa.collectionReadTimeIndexPath=["parentPath","readTime"];var Ka=function(t){this.byteSize=t};Ka.store="remoteDocumentGlobal",Ka.key="remoteDocumentGlobalKey";var Ha=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Ha.store="targets",Ha.keyPath="targetId",Ha.queryTargetsIndexName="queryTargetsIndex",Ha.queryTargetsKeyPath=["canonicalId","targetId"];var Ya=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ya.store="targetDocuments",Ya.keyPath=["targetId","path"],Ya.documentTargetsIndex="documentTargetsIndex",Ya.documentTargetsKeyPath=["path","targetId"];var Xa=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Xa.key="targetGlobalKey",Xa.store="targetGlobal";var $a=function(t,e){this.collectionId=t,this.parent=e};function Ja(t){t.createObjectStore(Ya.store,{keyPath:Ya.keyPath}).createIndex(Ya.documentTargetsIndex,Ya.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ha.store,{keyPath:Ha.keyPath}).createIndex(Ha.queryTargetsIndexName,Ha.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Xa.store)}$a.store="collectionParents",$a.keyPath=["collectionId","parent"];var Za=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Za.store="clientMetadata",Za.keyPath="clientId";var th=h(h(h([qa.store,Fa.store,Ba.store,Qa.store,Ha.store,Ca.store,Xa.store,Ya.store],[Za.store]),[Ka.store]),[$a.store]),eh=(nh.prototype.Io=function(t,e){var n=this;if(this.ga.has(e))return cu.resolve();var r=e.O(),i=e.M();t.qn((function(){n.ga.add(e)}));var o={collectionId:r,parent:zu(i)};return rh(t).put(o)},nh.prototype.ir=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[iu(e),""],!1,!0);return rh(t).eo(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Ku(o.parent))}return n}))},nh);function nh(){this.ga=new Pa}function rh(t){return ah.Kh(t,$a.store)}var ih,oh=(fh.prototype._a=function(t){if(t.document)return this.pa.mi(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=Xr.st(t.noDocument.path),n=this.ya(t.noDocument.readTime);return new Io(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}if(t.unknownDocument){var r=Xr.st(t.unknownDocument.path),i=this.ya(t.unknownDocument.version);return new No(r,i)}return Js()},fh.prototype.Pa=function(t,e){var n=this.ca(e),r=t.key.path.M().W();if(t instanceof To){var i=this.pa.Ai(t),o=t.hasCommittedMutations;return new Qa(null,null,i,o,n,r)}if(t instanceof Io){var s=t.key.path.W(),u=this.ba(t.version),a=t.hasCommittedMutations;return new Qa(null,new za(s,u),null,a,n,r)}if(t instanceof No){var h=t.key.path.W(),c=this.ba(t.version);return new Qa(new Wa(h,c),null,null,!0,n,r)}return Js()},fh.prototype.ca=function(t){var e=t.C();return[e.seconds,e.nanoseconds]},fh.prototype.fa=function(t){var e=new Pr(t[0],t[1]);return Vr.v(e)},fh.prototype.ba=function(t){var e=t.C();return new Oa(e.seconds,e.nanoseconds)},fh.prototype.ya=function(t){var e=new Pr(t.seconds,t.nanoseconds);return Vr.v(e)},fh.prototype.Eo=function(t,e){var n=this,r=e.baseMutations.map((function(t){return n.pa.vi(t)})),i=e.mutations.map((function(t){return n.pa.vi(t)}));return new Fa(t,e.batchId,e.Tn.toMillis(),r,i)},fh.prototype.Ro=function(t){var e=this,n=(t.baseMutations||[]).map((function(t){return e.pa.Fi(t)})),r=t.mutations.map((function(t){return e.pa.Fi(t)})),i=Pr.fromMillis(t.localWriteTimeMs);return new au(t.batchId,i,n,r)},fh.prototype.Go=function(t){var e,n=this.ya(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?this.ya(t.lastLimboFreeSnapshotVersion):Vr.min();return e=void 0!==t.query.documents?this.pa.xi(t.query):this.pa.Wi(t.query),new Lo(e,t.targetId,0,t.lastListenSequenceNumber,n,r,ei.fromBase64String(t.resumeToken))},fh.prototype.zo=function(t){var e,n=this.ba(t.Ee),r=this.ba(t.lastLimboFreeSnapshotVersion);e=t.target.Ot()?this.pa.Oi(t.target):this.pa.Bi(t.target);var i=t.resumeToken.toBase64();return new Ha(t.targetId,t.target.canonicalId(),n,i,t.sequenceNumber,r,e)},fh),sh="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",uh=(s(ch,ih=pu),ch),ah=(hh.Kh=function(t,e){if(t instanceof uh)return Yu.Kh(t.bo,e);throw Js()},hh.prototype.start=function(){var t=this;return Yu.qh(this.Ma,Va,new La(this.serializer)).then((function(e){return t.Ba=e,t.qa()})).then((function(){return t.Ua(),t.Qa(),t.Wa(),t.Ba.runTransaction("readonly",[Xa.store],(function(t){return Ea(t)}))})).then((function(e){t.ja=new vu(e,t.Sa)})).then((function(){t.Da=!0})).catch((function(e){return t.Ba&&t.Ba.close(),Promise.reject(e)}))},hh.prototype.Ka=function(t){var e=this;return this.$a=function(n){return u(e,void 0,void 0,(function(){return a(this,(function(e){return this.vh?[2,t(n)]:[2]}))}))},t(this.isPrimary)},hh.prototype.Ga=function(t){var e=this;this.Ba.Gh((function(n){return u(e,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},hh.prototype.za=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Tr.$r((function(){return u(e,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return this.vh?[4,this.qa()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},hh.prototype.qa=function(){var t=this;return this.Ba.runTransaction("readwrite",th,(function(e){return ph(e).put(new Za(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Ha(e).next((function(e){e||(t.isPrimary=!1,t.Tr.$r((function(){return t.$a(!1)})))}))})).next((function(){return t.Ya(e)})).next((function(n){return t.isPrimary&&!n?t.Ja(e).next((function(){return!1})):!!n&&t.Xa(e).next((function(){return!0}))}))})).catch((function(e){if(!t.allowTabSynchronization)throw e;return Ys("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Tr.$r((function(){return t.$a(e)})),t.isPrimary=e}))},hh.prototype.Ha=function(t){var e=this;return lh(t).get(Ca.key).next((function(t){return cu.resolve(e.Za(t))}))},hh.prototype.tu=function(t){return ph(t).delete(this.clientId)},hh.prototype.eu=function(){return u(this,void 0,void 0,(function(){var t=this;return a(this,(function(e){switch(e.label){case 0:return!this.isPrimary||this.su(this.ka,18e5)?[3,2]:(this.ka=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var n=hh.Kh(e,Za.store);return n.eo().next((function(e){var r=t.iu(e,18e5),i=e.filter((function(t){return-1===r.indexOf(t)}));return cu.forEach(i,(function(t){return n.delete(t.clientId)})).next((function(){return i}))}))})).catch((function(){return[]}))]);case 1:e.sent().forEach((function(e){t.window.localStorage.removeItem(t.nu(e.clientId))})),e.label=2;case 2:return[2]}}))}))},hh.prototype.Wa=function(){var t=this;this.Na=this.Tr.yr("client_metadata_refresh",4e3,(function(){return t.qa().then((function(){return t.eu()})).then((function(){return t.Wa()}))}))},hh.prototype.Za=function(t){return!!t&&t.ownerId===this.clientId},hh.prototype.Ya=function(t){var e=this;return lh(t).get(Ca.key).next((function(n){if(null!==n&&e.su(n.leaseTimestampMs,5e3)&&!e.ru(n.ownerId)){if(e.Za(n)&&e.networkEnabled)return!0;if(!e.Za(n)){if(!n.allowTabSynchronization)throw new kr(Sr.FAILED_PRECONDITION,sh);return!1}}return!(!e.networkEnabled||!e.inForeground)||ph(t).eo().next((function(t){return void 0===e.iu(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&Ys("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},hh.prototype.hu=function(){return u(this,void 0,void 0,(function(){var t=this;return a(this,(function(e){switch(e.label){case 0:return this.Da=!1,this.ou(),this.Na&&(this.Na.cancel(),this.Na=null),this.au(),this.uu(),[4,this.Ba.runTransaction("readwrite",[Ca.store,Za.store],(function(e){return t.Ja(e).next((function(){return t.tu(e)}))}))];case 1:return e.sent(),this.Ba.close(),this.cu(),[2]}}))}))},hh.prototype.iu=function(t,e){var n=this;return t.filter((function(t){return n.su(t.updateTimeMs,e)&&!n.ru(t.clientId)}))},hh.prototype._u=function(){var t=this;return this.Ba.runTransaction("readonly",[Za.store],(function(e){return ph(e).eo().next((function(e){return t.iu(e,18e5).map((function(t){return t.clientId}))}))}))},hh.clearPersistence=function(t){return u(this,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return hh.Uh()?(e=t+hh.La,[4,Yu.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))},Object.defineProperty(hh.prototype,"vh",{get:function(){return this.Da},enumerable:!0,configurable:!0}),hh.prototype.lu=function(t){return aa.uo(t,this.serializer,this.jn,this.oo)},hh.prototype.du=function(){return this.Oa},hh.prototype.fu=function(){return this.Qn},hh.prototype.Tu=function(){return this.jn},hh.prototype.runTransaction=function(t,e,n){var r=this;Ys("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Ba.runTransaction(o,th,(function(o){return i=new uh(o,r.ja.next()),"readwrite-primary"===e?r.Ha(o).next((function(t){return!!t||r.Ya(o)})).next((function(e){if(!e)throw Xs("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Tr.$r((function(){return r.$a(!1)})),new kr(Sr.FAILED_PRECONDITION,lu);return n(i)})).next((function(t){return r.Xa(o).next((function(){return t}))})):r.Eu(o).next((function(){return n(i)}))})).then((function(t){return i.Un(),t}))},hh.prototype.Eu=function(t){var e=this;return lh(t).get(Ca.key).next((function(t){if(null!==t&&e.su(t.leaseTimestampMs,5e3)&&!e.ru(t.ownerId)&&!e.Za(t)&&!t.allowTabSynchronization)throw new kr(Sr.FAILED_PRECONDITION,sh)}))},hh.prototype.Xa=function(t){var e=new Ca(this.clientId,this.allowTabSynchronization,Date.now());return lh(t).put(Ca.key,e)},hh.Uh=function(){return Yu.Uh()},hh.Iu=function(t){var e=t.ii.projectId;return t.ii.ln||(e+="."+t.ii.database),"firestore/"+t.persistenceKey+"/"+e+"/"},hh.prototype.Ja=function(t){var e=this,n=lh(t);return n.get(Ca.key).next((function(t){return e.Za(t)?(Ys("IndexedDbPersistence","Releasing primary lease."),n.delete(Ca.key)):cu.resolve()}))},hh.prototype.su=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Xs("Detected an update time that is in the future: "+t+" > "+n),1))},hh.prototype.Ua=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Fa=function(){t.Tr.$r((function(){return t.inForeground="visible"===t.document.visibilityState,t.qa()}))},this.document.addEventListener("visibilitychange",this.Fa),this.inForeground="visible"===this.document.visibilityState)},hh.prototype.au=function(){this.Fa&&(this.document.removeEventListener("visibilitychange",this.Fa),this.Fa=null)},hh.prototype.Qa=function(){var t=this;"function"==typeof this.window.addEventListener&&(this.Ca=function(){t.ou(),t.Tr.$r((function(){return t.hu()}))},this.window.addEventListener("unload",this.Ca))},hh.prototype.uu=function(){this.Ca&&(this.window.removeEventListener("unload",this.Ca),this.Ca=null)},hh.prototype.ru=function(t){try{var e=null!==this.xa.getItem(this.nu(t));return Ys("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Xs("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},hh.prototype.ou=function(){try{this.xa.setItem(this.nu(this.clientId),String(Date.now()))}catch(n){Xs("Failed to set zombie client id.",n)}},hh.prototype.cu=function(){try{this.xa.removeItem(this.nu(this.clientId))}catch(n){}},hh.prototype.nu=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},hh);function hh(t,e,n,r,i,o,s,u){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Tr=o,this.Sa=u,this.Da=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ca=null,this.inForeground=!1,this.Fa=null,this.Na=null,this.ka=Number.NEGATIVE_INFINITY,this.$a=function(t){return Promise.resolve()},!hh.Uh())throw new kr(Sr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");if(this.oo=new dh(this,i),this.Ma=e+hh.La,this.serializer=new oh(s),this.document=r.document,this.Oa=new va(this.oo,this.serializer),this.jn=new eh,this.Qn=new Na(this.serializer,this.jn),!r.window||!r.window.localStorage)throw new kr(Sr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=r.window,this.xa=this.window.localStorage}function ch(t,e){var n=this;return(n=ih.call(this)||this).bo=t,n.va=e,n}function fh(t){this.pa=t}function lh(t){return t.store(Ca.store)}function ph(t){return t.store(Za.store)}ah.La="main";var dh=(yh.prototype.Fh=function(t){var e=this.wu(t);return this.db.du().Ho(t).next((function(t){return e.next((function(e){return t+e}))}))},yh.prototype.wu=function(t){var e=0;return this.kh(t,(function(t){e++})).next((function(){return e}))},yh.prototype.js=function(t,e){return this.db.du().js(t,e)},yh.prototype.kh=function(t,e){return this.Ru(t,(function(t,n){return e(n)}))},yh.prototype.Xo=function(t,e,n){return vh(t,n)},yh.prototype.ta=function(t,e,n){return vh(t,n)},yh.prototype.$h=function(t,e,n){return this.db.du().$h(t,e,n)},yh.prototype.So=function(t,e){return vh(t,e)},yh.prototype.Au=function(t,e){return r=e,i=!1,da(n=t).ho((function(t){return ca(n,t,r).next((function(t){return t&&(i=!0),cu.resolve(!t)}))})).next((function(){return i}));var n,r,i},yh.prototype.Mh=function(t,e){var n=this,r=this.db.fu().Ea(),i=[],o=0;return this.Ru(t,(function(s,u){if(u<=e){var a=n.Au(t,s).next((function(e){if(!e)return o++,r.Mn(t,s).next((function(){return r.$n(s),Ta(t).delete([0,zu(s.path)])}))}));i.push(a)}})).next((function(){return cu.vn(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},yh.prototype.removeTarget=function(t,e){var n=e.Ie(t.va);return this.db.du().Wo(t,n)},yh.prototype.mu=function(t,e){return vh(t,e)},yh.prototype.Ru=function(t,e){var n,r=Ta(t),i=vu.dr;return r.ro({index:Ya.documentTargetsIndex},(function(t,r){var o=t[0],s=(t[1],r.path),u=r.sequenceNumber;0===o?(i!==vu.dr&&e(new Xr(Ku(n)),i),i=u,n=s):i=vu.dr})).next((function(){i!==vu.dr&&e(new Xr(Ku(n)),i)}))},yh.prototype.Oh=function(t){return this.db.fu().Ra(t)},yh);function yh(t,e){this.db=t,this.Vh=new Fu(this,e)}function vh(t,e){return Ta(t).put((n=e,r=t.va,new Ya(0,zu(n.path),r)));var n,r}var gh=(mh.prototype.start=function(){return Promise.resolve()},mh.prototype.Su=function(t){return u(this,void 0,void 0,(function(){var e,n,r,i=this;return a(this,(function(o){switch(o.label){case 0:return e=this.Wn,n=this.bu,[4,this.persistence.runTransaction("Handle user change","readonly",(function(r){var o;return i.Wn.Vo(r).next((function(s){return o=s,e=i.persistence.lu(t),n=new du(i.yu,e,i.persistence.Tu()),e.Vo(r)})).next((function(t){for(var e=[],i=[],s=gs(),u=0,a=o;u<a.length;u++){var h=a[u];e.push(h.batchId);for(var c=0,f=h.mutations;c<f.length;c++){var l=f[c];s=s.add(l.key)}}for(var p=0,d=t;p<d.length;p++){var y=d[p];i.push(y.batchId);for(var v=0,g=y.mutations;v<g.length;v++){var m=g[v];s=s.add(m.key)}}return n.Yn(r,s).next((function(t){return{Du:t,Cu:e,Fu:i}}))}))}))];case 1:return r=o.sent(),[2,(this.Wn=e,this.bu=n,this.Pu.vu(this.bu),r)]}}))}))},mh.prototype.Nu=function(t){var e,n=this,r=Pr.now(),i=t.reduce((function(t,e){return t.add(e.key)}),gs());return this.persistence.runTransaction("Locally write mutations","readwrite",(function(o){return n.bu.Yn(o,i).next((function(i){e=i;for(var s=[],u=0,a=t;u<a.length;u++){var h=a[u],c=h.Pt(e.get(h.key));null!=c&&s.push(new zi(h.key,c,uo(c.proto.mapValue),Fi.exists(!0)))}return n.Wn.To(o,r,s,t)}))})).then((function(t){var n=t.In(e);return{batchId:t.batchId,Dn:n}}))},mh.prototype._o=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(n){var r=t.batch.keys(),i=e.yu.Ea({wa:!0});return e.Wn._o(n,t.batch,t.streamToken).next((function(){return e.ku(n,t,i)})).next((function(){return i.apply(n)})).next((function(){return e.Wn.Do(n)})).next((function(){return e.bu.Yn(n,r)}))}))},mh.prototype.$u=function(t){var e=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",(function(n){var r;return e.Wn.wo(n,t).next((function(t){return Zs(null!==t),r=t.keys(),e.Wn.yo(n,t)})).next((function(){return e.Wn.Do(n)})).next((function(){return e.bu.Yn(n,r)}))}))},mh.prototype.Po=function(){var t=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(e){return t.Wn.Po(e)}))},mh.prototype.do=function(){var t=this;return this.persistence.runTransaction("Get last stream token","readonly",(function(e){return t.Wn.do(e)}))},mh.prototype.fo=function(t){var e=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",(function(n){return e.Wn.fo(n,t)}))},mh.prototype.Oo=function(){var t=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",(function(e){return t.Oa.Oo(e)}))},mh.prototype.Mu=function(t){var e=this,n=t.Ee,r=this.Vu;return this.persistence.runTransaction("Apply remote event","readwrite-primary",(function(i){var o=e.yu.Ea({wa:!0});r=e.Vu;var s=[];t.as.forEach((function(t,o){var u=r.get(o);if(u){s.push(e.Oa.Zo(i,t.Is,o).next((function(){return e.Oa.Jo(i,t.Ts,o)})));var a=t.resumeToken;if(0<a.rt()){var h=u.we(a,n).Ie(i.va);r=r.Ae(o,h),mh.Lu(u,h,t)&&s.push(e.Oa.Wo(i,h))}}}));var u=cs(),a=gs();if(t.cs.forEach((function(t,e){a=a.add(t)})),s.push(o.getEntries(i,a).next((function(r){t.cs.forEach((function(a,h){var c=r.get(a);h instanceof Io&&h.version.isEqual(Vr.min())?(o.$n(a,n),u=u.Ae(a,h)):null==c||0<h.version.S(c.version)||0===h.version.S(c.version)&&c.hasPendingWrites?(o.Nn(h,n),u=u.Ae(a,h)):Ys("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",h.version),t._s.has(a)&&s.push(e.persistence.oo.mu(i,a))}))}))),!n.isEqual(Vr.min())){var h=e.Oa.Oo(i).next((function(t){return e.Oa.Bo(i,i.va,n)}));s.push(h)}return cu.vn(s).next((function(){return o.apply(i)})).next((function(){return e.bu.Jn(i,u)}))})).then((function(t){return e.Vu=r,t}))},mh.Lu=function(t,e,n){return Zs(0<e.resumeToken.rt()),0===t.resumeToken.rt()||e.Ee.D()-t.Ee.D()>=this.Ou||0<n.Ts.size+n.Es.size+n.Is.size},mh.prototype.xu=function(t){var e=this;return this.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(n){return cu.forEach(t,(function(t){return cu.forEach(t.hr,(function(r){return e.persistence.oo.Xo(n,t.targetId,r)})).next((function(){return cu.forEach(t.or,(function(r){return e.persistence.oo.ta(n,t.targetId,r)}))}))}))})).then((function(){for(var n=0,r=t;n<r.length;n++){var i=r[n],o=i.targetId;if(!i.fromCache){var s=e.Vu.get(o),u=s.Ee,a=s.Re(u);e.Vu=e.Vu.Ae(o,a)}}}))},mh.prototype.Bu=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch","readonly",(function(n){return void 0===t&&(t=-1),e.Wn.mo(n,t)}))},mh.prototype.qu=function(t){var e=this;return this.persistence.runTransaction("read document","readonly",(function(n){return e.bu.Kn(n,t)}))},mh.prototype.Uu=function(t){var e=this;return this.persistence.runTransaction("Allocate target","readwrite",(function(n){var r;return e.Oa.Yo(n,t).next((function(i){return i?(r=i,cu.resolve(r)):e.Oa.$o(n).next((function(i){return r=new Lo(t,i,0,n.va),e.Oa.qo(n,r).next((function(){return r}))}))}))})).then((function(n){return null===e.Vu.get(n.targetId)&&(e.Vu=e.Vu.Ae(n.targetId,n),e.gu.set(t,n.targetId)),n}))},mh.prototype.Yo=function(t,e){var n=this.gu.get(e);return void 0!==n?cu.resolve(this.Vu.get(n)):this.Oa.Yo(t,e)},mh.prototype.Qu=function(t,e){var n=this,r=this.Vu.get(t),i=e?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",i,(function(t){return e?cu.resolve():n.persistence.oo.removeTarget(t,r)})).then((function(){n.Vu=n.Vu.remove(t),n.gu.delete(r.target)}))},mh.prototype.Wu=function(t,e){var n=this,r=Vr.min(),i=gs();return this.persistence.runTransaction("Execute query","readonly",(function(o){return n.Yo(o,t.ee()).next((function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,n.Oa.ea(o,t.targetId).next((function(t){i=t}))})).next((function(){return n.Pu.Zn(o,t,e?r:Vr.min(),e?i:gs())})).next((function(t){return{documents:t,ju:i}}))}))},mh.prototype.ku=function(t,e,n){var r=this,i=e.batch,o=i.keys(),s=cu.resolve();return o.forEach((function(r){s=s.next((function(){return n.Mn(t,r)})).next((function(t){var o=t,s=e.Rn.get(r);Zs(null!==s),(!o||o.version.S(s)<0)&&(o=i.at(r,o,e))&&n.Nn(o,e.wn)}))})),s.next((function(){return r.Wn.yo(t,i)}))},mh.prototype.Sh=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.Lh(n,e.Vu)}))},mh);function mh(t,e,n){this.persistence=t,this.Pu=e,this.Vu=new Jo(nu),this.gu=new uu((function(t){return t.canonicalId()})),this.pu=Vr.min(),this.Wn=t.lu(n),this.yu=t.fu(),this.Oa=t.du(),this.bu=new du(this.yu,this.Wn,this.persistence.Tu()),this.Pu.vu(this.bu)}gh.Ou=3e8;var wh,bh=(s(Eh,wh=gh),Eh.prototype.start=function(){return this.Ku()},Eh.prototype.Gu=function(t){var e=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",(function(n){return e.Wn.Ao(n,t).next((function(t){return t?e.bu.Yn(n,t):cu.resolve(null)}))}))},Eh.prototype.zu=function(t){this.Wn.vo(t)},Eh.prototype.za=function(t){this.persistence.za(t)},Eh.prototype._u=function(){return this.persistence._u()},Eh.prototype.Hu=function(t){var e=this,n=this.Vu.get(t);return n?Promise.resolve(n.target):this.persistence.runTransaction("Get target data","readonly",(function(n){return e.Oa.si(n,t).next((function(t){return t?t.target:null}))}))},Eh.prototype.la=function(){var t=this;return this.persistence.runTransaction("Get new document changes","readonly",(function(e){return t.yu.la(e,t.pu)})).then((function(e){var n=e.da,r=e.readTime;return t.pu=r,n}))},Eh.prototype.Ku=function(){return u(this,void 0,void 0,(function(){var t,e=this;return a(this,(function(n){switch(n.label){case 0:return[4,(t=this).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return e.yu.Ta(t)}))];case 1:return t.pu=n.sent(),[2]}}))}))},Eh);function Eh(t,e,n){var r=this;return(r=wh.call(this,t,e,n)||this).persistence=t,r.Wn=t.lu(n),r.yu=t.fu(),r.Oa=t.du(),r}function Th(t){return u(this,void 0,void 0,(function(){return a(this,(function(e){if(t.code!==Sr.FAILED_PRECONDITION||t.message!==lu)throw t;return Ys("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}var Ih=(_h.prototype.B=function(){return this.Yu.B()},_h.prototype.Xo=function(t,e){var n=new Nh(t,e);this.Yu=this.Yu.add(n),this.Xu=this.Xu.add(n)},_h.prototype.tc=function(t,e){var n=this;t.forEach((function(t){return n.Xo(t,e)}))},_h.prototype.ta=function(t,e){this.ec(new Nh(t,e))},_h.prototype.sc=function(t,e){var n=this;t.forEach((function(t){return n.ta(t,e)}))},_h.prototype.ic=function(t){var e=this,n=Xr.EMPTY,r=new Nh(n,t),i=new Nh(n,t+1),o=[];return this.Xu.Ke([r,i],(function(t){e.ec(t),o.push(t.key)})),o},_h.prototype.nc=function(){var t=this;this.Yu.forEach((function(e){return t.ec(e)}))},_h.prototype.ec=function(t){this.Yu=this.Yu.delete(t),this.Xu=this.Xu.delete(t)},_h.prototype.rc=function(t){var e=Xr.EMPTY,n=new Nh(e,t),r=new Nh(e,t+1),i=gs();return this.Xu.Ke([n,r],(function(t){i=i.add(t.key)})),i},_h.prototype.Co=function(t){var e=new Nh(t,0),n=this.Yu.ze(e);return null!==n&&t.isEqual(n.key)},_h),Nh=(Ah.Ju=function(t,e){return Xr.N(t.key,e.key)||nu(t.hc,e.hc)},Ah.Zu=function(t,e){return nu(t.hc,e.hc)||Xr.N(t.key,e.key)},Ah);function Ah(t,e){this.key=t,this.hc=e}function _h(){this.Yu=new os(Nh.Ju),this.Xu=new os(Nh.Zu)}function Sh(t,e){if(0!==e.length)throw new kr(Sr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+zh(e.length,"argument")+".")}function kh(t,e,n){if(e.length!==n)throw new kr(Sr.INVALID_ARGUMENT,"Function "+t+"() requires "+zh(n,"argument")+", but was called with "+zh(e.length,"argument")+".")}function Dh(t,e,n){if(e.length<n)throw new kr(Sr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+zh(n,"argument")+", but was called with "+zh(e.length,"argument")+".")}function xh(t,e,n,r){if(e.length<n||e.length>r)throw new kr(Sr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+zh(e.length,"argument")+".")}function Oh(t,e,n,r){Ch(t,e,Gh(n)+" argument",r)}function Rh(t,e,n,r){void 0!==r&&Oh(t,e,n,r)}function Ph(t,e,n,r){Ch(t,e,n+" option",r)}function Vh(t,e,n,r){void 0!==r&&Ph(t,e,n,r)}function Lh(t,e,n,r,i){void 0!==r&&function(t,e,n){for(var r=[],o=0,s=i;o<s.length;o++){var u=s[o];if(u===n)return;r.push(Uh(u))}var a=Uh(n);throw new kr(Sr.INVALID_ARGUMENT,"Invalid value "+a+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function Ch(t,e,n,r){if(!("object"===e?Mh(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Uh(r);throw new kr(Sr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Mh(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Uh(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return 20<t.length&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"!=typeof t)return"function"==typeof t?"a function":Js();if(t instanceof Array)return"an array";var e=function(){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&1<e.length)return e[1]}return null}();return e?"a custom "+e+" object":"an object"}function jh(t,e,n){if(void 0===n)throw new kr(Sr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Gh(e)+" argument, but it was undefined.")}function qh(t,e,n){Zr(e,(function(e,r){if(n.indexOf(e)<0)throw new kr(Sr.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))}))}function Fh(t,e,n,r){var i=Uh(r);return new kr(Sr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Gh(n)+" argument to be a "+e+", but it was: "+i)}function Bh(t,e,n){if(n<=0)throw new kr(Sr.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+Gh(e)+" argument to be a positive number, but it was: "+n+".")}function Gh(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function zh(t,e){return t+" "+e+(1===t?"":"s")}function Wh(){if("undefined"==typeof Uint8Array)throw new kr(Sr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Qh(){if(!zs.nt().oc)throw new kr(Sr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Kh=(Xh.fromBase64String=function(t){kh("Blob.fromBase64String",arguments,1),Oh("Blob.fromBase64String","string",1,t),Qh();try{return new Xh(ei.fromBase64String(t))}catch(t){throw new kr(Sr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Xh.fromUint8Array=function(t){if(kh("Blob.fromUint8Array",arguments,1),Wh(),!(t instanceof Uint8Array))throw Fh("Blob.fromUint8Array","Uint8Array",1,t);return new Xh(ei.fromUint8Array(t))},Xh.prototype.toBase64=function(){return kh("Blob.toBase64",arguments,0),Qh(),this.ac.toBase64()},Xh.prototype.toUint8Array=function(){return kh("Blob.toUint8Array",arguments,0),Wh(),this.ac.toUint8Array()},Xh.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Xh.prototype.isEqual=function(t){return this.ac.isEqual(t.ac)},Xh),Hh=(Yh.documentId=function(){return Yh.cc},Yh.prototype.isEqual=function(t){if(!(t instanceof Yh))throw Fh("isEqual","FieldPath",1,t);return this.uc.isEqual(t.uc)},Yh);function Yh(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(){if(!(t instanceof Array)||t.length<1)throw new kr(Sr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var n=0;n<t.length;++n)if(Oh("FieldPath","string",n,t[n]),0===t[n].length)throw new kr(Sr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.uc=new Hr(t)}function Xh(t){Qh(),this.ac=t}Hh.cc=new Hh(Hr.J().j());var $h,Jh,Zh,tc,ec,nc=new RegExp("[~\\*/\\[\\]]"),rc=function(t){this._c=t},ic=(s(bc,ec=rc),bc.prototype.Di=function(t){if(2!==t.lc)throw 1===t.lc?t.dc("FieldValue.delete() can only appear at the top level of your update data"):t.dc("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");return t.Vt.push(t.path),null},bc.prototype.isEqual=function(t){return t instanceof bc},bc),oc=(s(wc,tc=rc),wc.prototype.Di=function(t){return new qi(t.path,Ni.instance)},wc.prototype.isEqual=function(t){return t instanceof wc},wc),sc=(s(mc,Zh=rc),mc.prototype.Di=function(t){var e=new Tc({lc:3,methodName:this._c,Tc:!0},t.ii,t.serializer),n=this.fc.map((function(t){return _c(t,e)})),r=new _i(n);return new qi(t.path,r)},mc.prototype.isEqual=function(t){return this===t},mc),uc=(s(gc,Jh=rc),gc.prototype.Di=function(t){var e=new Tc({lc:3,methodName:this._c,Tc:!0},t.ii,t.serializer),n=this.fc.map((function(t){return _c(t,e)})),r=new Si(n);return new qi(t.path,r)},gc.prototype.isEqual=function(t){return this===t},gc),ac=(s(vc,$h=rc),vc.prototype.Di=function(t){var e=new Tc({lc:3,methodName:this._c},t.ii,t.serializer),n=_c(this.Ec,e),r=new ki(t.serializer,n);return new qi(t.path,r)},vc.prototype.isEqual=function(t){return this===t},vc),hc=(Object.defineProperty(yc.prototype,"latitude",{get:function(){return this.Ic},enumerable:!0,configurable:!0}),Object.defineProperty(yc.prototype,"longitude",{get:function(){return this.wc},enumerable:!0,configurable:!0}),yc.prototype.isEqual=function(t){return this.Ic===t.Ic&&this.wc===t.wc},yc.prototype.p=function(t){return nu(this.Ic,t.Ic)||nu(this.wc,t.wc)},yc),cc=/^__.*__$/,fc=(dc.prototype.Rc=function(t,e){var n=[];return null!==this.Vt?n.push(new zi(t,this.data,this.Vt,e)):n.push(new Gi(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Wi(t,this.fieldTransforms)),n},dc),lc=(pc.prototype.Rc=function(t,e){var n=[new zi(t,this.data,this.Vt,e)];return 0<this.fieldTransforms.length&&n.push(new Wi(t,this.fieldTransforms)),n},pc);function pc(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}function dc(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}function yc(t,e){if(kh("GeoPoint",arguments,2),Oh("GeoPoint","number",1,t),Oh("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new kr(Sr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new kr(Sr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Ic=t,this.wc=e}function vc(t){var e=this;return(e=$h.call(this,"FieldValue.increment")||this).Ec=t,e}function gc(t){var e=this;return(e=Jh.call(this,"FieldValue.arrayRemove")||this).fc=t,e}function mc(t){var e=this;return(e=Zh.call(this,"FieldValue.arrayUnion")||this).fc=t,e}function wc(){return tc.call(this,"FieldValue.serverTimestamp")||this}function bc(){return ec.call(this,"FieldValue.delete")||this}function Ec(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Js()}}var Tc=(Object.defineProperty(Ac.prototype,"path",{get:function(){return this.settings.path},enumerable:!0,configurable:!0}),Object.defineProperty(Ac.prototype,"lc",{get:function(){return this.settings.lc},enumerable:!0,configurable:!0}),Ac.prototype.mc=function(t){return new Ac(Object.assign(Object.assign({},this.settings),t),this.ii,this.serializer,this.fieldTransforms,this.Vt)},Ac.prototype.Pc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.mc({path:n,Tc:!1});return r.Vc(t),r},Ac.prototype.gc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.mc({path:n,Tc:!1});return r.Ac(),r},Ac.prototype.pc=function(t){return this.mc({path:void 0,Tc:!0})},Ac.prototype.dc=function(t){var e=!this.path||this.path.B()?"":" (found in field "+this.path.toString()+")";return new kr(Sr.INVALID_ARGUMENT,"Function "+this.settings.methodName+"() called with invalid data. "+t+e)},Ac.prototype.contains=function(t){return void 0!==this.Vt.find((function(e){return t.q(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.q(e.field)}))},Ac.prototype.Ac=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Vc(this.path.get(t))},Ac.prototype.Vc=function(t){if(0===t.length)throw this.dc("Document fields must not be empty");if(Ec(this.lc)&&cc.test(t))throw this.dc('Document fields cannot begin and end with "__"')},Ac),Ic=(Nc.prototype.bc=function(t,e){var n=this.vc(0,t);Dc("Data must be an object, but it was:",n,e);var r=Sc(e,n);return new fc(new Hi(r),null,n.fieldTransforms)},Nc.prototype.Sc=function(t,e,n){var r=this.vc(2,t);Dc("Data must be an object, but it was:",r,e);var i,o,s=Sc(e,r);if(n){for(var u=[],a=0,h=n;a<h.length;a++){var c=h[a],f=void 0;if(c instanceof Hh)f=c.uc;else{if("string"!=typeof c)throw Js();f=Oc(t,c)}if(!r.contains(f))throw new kr(Sr.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");Rc(u,f)||u.push(f)}i=new ji(u),o=r.fieldTransforms.filter((function(t){return i.dt(t.field)}))}else i=new ji(r.Vt),o=r.fieldTransforms;return new fc(new Hi(s),i,o)},Nc.prototype.Dc=function(t,e){var n=this.vc(1,t);Dc("Data must be an object, but it was:",n,e);var r=[],i=new Yi;Zr(e,(function(e,o){var s=Oc(t,e),u=n.gc(s);if(o instanceof ic)r.push(s);else{var a=_c(o,u);null!=a&&(r.push(s),i.set(s,a))}}));var o=new ji(r);return new lc(i.yt(),o,n.fieldTransforms)},Nc.prototype.Cc=function(t,e,n,r){var i=this.vc(1,t),o=[xc(t,e)],s=[n];if(r.length%2!=0)throw new kr(Sr.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var u=0;u<r.length;u+=2)o.push(xc(t,r[u])),s.push(r[u+1]);for(var a=[],h=new Yi,c=o.length-1;0<=c;--c)if(!Rc(a,o[c])){var f=o[c],l=s[c],p=i.gc(f);if(l instanceof ic)a.push(f);else{var d=_c(l,p);null!=d&&(a.push(f),h.set(f,d))}}var y=new ji(a);return new lc(h.yt(),y,i.fieldTransforms)},Nc.prototype.vc=function(t,e){return new Tc({lc:t,methodName:e,path:Hr.G,Tc:!1},this.ii,this.serializer)},Nc.prototype.Fc=function(t,e,n){return void 0===n&&(n=!1),_c(e,this.vc(n?4:3,t))},Nc);function Nc(t,e){this.ii=t,this.serializer=e||zs.nt().yc(t)}function Ac(t,e,n,r,i){this.settings=t,this.ii=e,this.serializer=n,void 0===r&&this.Ac(),this.fieldTransforms=r||[],this.Vt=i||[]}function _c(t,e){if(kc(t))return Dc("Unsupported field value:",e,t),Sc(t,e);if(t instanceof rc)return function(t,e){if(!Ec(e.lc))throw e.dc(t._c+"() can only be used with update() and set()");if(null===e.path)throw e.dc(t._c+"() is not currently supported inside arrays");var n=t.Di(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.Vt.push(e.path),t instanceof Array){if(e.settings.Tc&&4!==e.lc)throw e.dc("Nested arrays are not supported");return function(e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=_c(o[i],e.pc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(e)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return e.serializer.ai(t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Pr.fromDate(t);return{timestampValue:e.serializer.C(n)}}if(t instanceof Pr){var r=new Pr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:e.serializer.C(r)}}if(t instanceof hc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Kh)return{bytesValue:e.serializer.ui(t)};if(t instanceof pl){var i=e.ii,o=t.firestore.Nc;if(!o.isEqual(i))throw e.dc("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:e.serializer._i(t.kc.path,t.firestore.Nc)}}throw e.dc("Unsupported field value: "+Uh(t))}(t,e)}function Sc(t,e){var n={};return ti(t)?e.path&&0<e.path.length&&e.Vt.push(e.path):Zr(t,(function(t,r){var i=_c(r,e.Pc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function kc(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Pr||t instanceof hc||t instanceof Kh||t instanceof pl||t instanceof rc)}function Dc(t,e,n){if(!kc(n)||!Mh(n)){var r=Uh(n);throw"an object"===r?e.dc(t+" a custom object"):e.dc(t+" "+r)}}function xc(t,e){if(e instanceof Hh)return e.uc;if("string"==typeof e)return Oc(t,e);throw new kr(Sr.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Oc(t,e){try{return function(e){if(0<=e.search(nc))throw new kr(Sr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Hh.bind.apply(Hh,h([void 0],e.split("."))))}catch(t){throw new kr(Sr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).uc}catch(e){var n=e instanceof Error?e.message:e.toString();throw new kr(Sr.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function Rc(t,e){return t.some((function(t){return t.isEqual(e)}))}var Pc,Vc,Lc,Cc=(Yc.prototype.Bc=function(){return 1===this.state||2===this.state||4===this.state},Yc.prototype.qc=function(){return 2===this.state},Yc.prototype.start=function(){3!==this.state?this.auth():this.Uc()},Yc.prototype.stop=function(){return u(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return this.Bc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},Yc.prototype.Qc=function(){this.state=0,this.Qr.reset()},Yc.prototype.Wc=function(){var t=this;this.qc()&&null===this.xc&&(this.xc=this.Tr.yr(this.$c,6e4,(function(){return t.jc()})))},Yc.prototype.Kc=function(t){this.Gc(),this.stream.send(t)},Yc.prototype.jc=function(){return u(this,void 0,void 0,(function(){return a(this,(function(t){return this.qc()?[2,this.close(0)]:[2]}))}))},Yc.prototype.Gc=function(){this.xc&&(this.xc.cancel(),this.xc=null)},Yc.prototype.close=function(t,e){return u(this,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:return this.Gc(),this.Qr.cancel(),this.Oc++,3!==t?this.Qr.reset():e&&e.code===Sr.RESOURCE_EXHAUSTED?(Xs(e.toString()),Xs("Using maximum backoff delay to prevent overloading the backend."),this.Qr.Vr()):e&&e.code===Sr.UNAUTHENTICATED&&this.Lc._(),null!==this.stream&&(this.zc(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Hc(e)];case 1:return n.sent(),[2]}}))}))},Yc.prototype.zc=function(){},Yc.prototype.auth=function(){var t=this;this.state=1;var e=this.Yc(this.Oc),n=this.Oc;this.Lc.getToken().then((function(e){t.Oc===n&&t.Jc(e)}),(function(n){e((function(){var e=new kr(Sr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.Xc(e)}))}))},Yc.prototype.Jc=function(t){var e=this,n=this.Yc(this.Oc);this.stream=this.Zc(t),this.stream.t_((function(){n((function(){return e.state=2,e.listener.t_()}))})),this.stream.Hc((function(t){n((function(){return e.Xc(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},Yc.prototype.Uc=function(){var t=this;this.state=4,this.Qr.gr((function(){return u(t,void 0,void 0,(function(){return a(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},Yc.prototype.Xc=function(t){return Ys("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Yc.prototype.Yc=function(t){var e=this;return function(n){e.Tr.$r((function(){return e.Oc===t?n():(Ys("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},Yc),Mc=(s(Hc,Lc=Cc),Hc.prototype.Zc=function(t){return this.Mc.e_("Listen",t)},Hc.prototype.onMessage=function(t){this.Qr.reset();var e=this.serializer.pi(t),n=this.serializer.bi(t);return this.listener.s_(e,n)},Hc.prototype.i_=function(t){var e={};e.database=this.serializer.wi,e.addTarget=this.serializer.ee(t);var n=this.serializer.zi(t);n&&(e.labels=n),this.Kc(e)},Hc.prototype.n_=function(t){var e={};e.database=this.serializer.wi,e.removeTarget=t,this.Kc(e)},Hc),Uc=(s(Kc,Vc=Cc),Object.defineProperty(Kc.prototype,"h_",{get:function(){return this.r_},enumerable:!0,configurable:!0}),Kc.prototype.start=function(){this.r_=!1,Vc.prototype.start.call(this)},Kc.prototype.zc=function(){this.r_&&this.o_([])},Kc.prototype.Zc=function(t){return this.Mc.e_("Write",t)},Kc.prototype.onMessage=function(t){if(Zs(!!t.streamToken),this.lastStreamToken=this.serializer.ci(t.streamToken),this.r_){this.Qr.reset();var e=this.serializer.Li(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.a_(n,e)}return Zs(!t.writeResults||0===t.writeResults.length),this.r_=!0,this.listener.u_()},Kc.prototype.c_=function(){var t={};t.database=this.serializer.wi,this.Kc(t)},Kc.prototype.o_=function(t){var e=this,n={streamToken:this.serializer.ui(this.lastStreamToken),writes:t.map((function(t){return e.serializer.vi(t)}))};this.Kc(n)},Kc),jc=(s(Qc,Pc=function(){this.__=void 0}),Qc.prototype.l_=function(t,e){var n=this;return this.credentials.getToken().then((function(r){return n.Mc.l_(t,e,r)})).catch((function(t){throw t.code===Sr.UNAUTHENTICATED&&n.credentials._(),t}))},Qc.prototype.d_=function(t,e){var n=this;return this.credentials.getToken().then((function(r){return n.Mc.d_(t,e,r)})).catch((function(t){throw t.code===Sr.UNAUTHENTICATED&&n.credentials._(),t}))},Qc),qc=(Wc.prototype.R_=function(t){return u(this,void 0,void 0,(function(){var e,n=this;return a(this,(function(r){switch(r.label){case 0:if(this.A_(),0<this.mutations.length)throw new kr(Sr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return u(this,void 0,void 0,(function(){var n,r,i,o,s;return a(this,(function(u){switch(u.label){case 0:return r={database:(n=t).serializer.wi,documents:e.map((function(t){return n.serializer.fi(t)}))},[4,n.d_("BatchGetDocuments",r)];case 1:return i=u.sent(),o=new Map,i.forEach((function(t){var e=n.serializer.gi(t);o.set(e.key.toString(),e)})),s=[],[2,(e.forEach((function(t){var e=o.get(t.toString());Zs(!!e),s.push(e)})),s)]}}))}))}(this.f_,t)];case 1:return[2,((e=r.sent()).forEach((function(t){t instanceof Io||t instanceof To?n.m_(t):Js()})),e)]}}))}))},Wc.prototype.set=function(t,e){this.write(e.Rc(t,this.Rt(t))),this.w_.add(t)},Wc.prototype.update=function(t,e){try{this.write(e.Rc(t,this.P_(t)))}catch(t){this.I_=t}this.w_.add(t)},Wc.prototype.delete=function(t){this.write([new Qi(t,this.Rt(t))]),this.w_.add(t)},Wc.prototype.commit=function(){return u(this,void 0,void 0,(function(){var t,e=this;return a(this,(function(n){switch(n.label){case 0:if(this.A_(),this.I_)throw this.I_;return t=this.T_,this.mutations.forEach((function(e){t=t.remove(e.key)})),t.forEach((function(t,n){e.mutations.push(new Ki(t,e.Rt(t)))})),[4,function(t,e){return u(this,void 0,void 0,(function(){var n,r,i;return a(this,(function(o){switch(o.label){case 0:return r={database:(n=t).serializer.wi,writes:e.map((function(t){return n.serializer.vi(t)}))},[4,n.l_("Commit",r)];case 1:return i=o.sent(),[2,n.serializer.Li(i.writeResults,i.commitTime)]}}))}))}(this.f_,this.mutations)];case 1:return n.sent(),this.E_=!0,[2]}}))}))},Wc.prototype.m_=function(t){var e;if(t instanceof To)e=t.version;else{if(!(t instanceof Io))throw Js();e=Vr.min()}var n=this.T_.get(t.key);if(null!==n){if(!e.isEqual(n))throw new kr(Sr.ABORTED,"Document version changed between two reads.")}else this.T_=this.T_.Ae(t.key,e)},Wc.prototype.Rt=function(t){var e=this.T_.get(t);return!this.w_.has(t)&&e?Fi.updateTime(e):Fi.ft()},Wc.prototype.P_=function(t){var e=this.T_.get(t);if(this.w_.has(t)||!e)return Fi.exists(!0);if(e.isEqual(Vr.min()))throw new kr(Sr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Fi.updateTime(e)},Wc.prototype.write=function(t){this.A_(),this.mutations=this.mutations.concat(t)},Wc.prototype.A_=function(){},Wc),Fc=(zc.prototype.b_=function(){var t=this;0===this.g_&&(this.v_("Unknown"),this.p_=this.br.yr("online_state_timeout",1e4,(function(){return t.p_=null,t.S_("Backend didn't respond within 10 seconds."),t.v_("Offline"),Promise.resolve()})))},zc.prototype.D_=function(t){"Online"===this.state?this.v_("Unknown"):(this.g_++,1<=this.g_&&(this.C_(),this.S_("Connection failed 1 times. Most recent error: "+t.toString()),this.v_("Offline")))},zc.prototype.set=function(t){this.C_(),this.g_=0,"Online"===t&&(this.y_=!1),this.v_(t)},zc.prototype.v_=function(t){t!==this.state&&(this.state=t,this.V_(t))},zc.prototype.S_=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.y_?(Xs(e),this.y_=!1):Ys("OnlineStateTracker",e)},zc.prototype.C_=function(){null!==this.p_&&(this.p_.cancel(),this.p_=null)},zc),Bc=(Gc.prototype.start=function(){return this.enableNetwork()},Gc.prototype.enableNetwork=function(){return this.networkEnabled=!0,this.J_()},Gc.prototype.J_=function(){return u(this,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:return this.B_()?(t=this.G_,[4,this.F_.do()]):[3,3];case 1:return t.lastStreamToken=e.sent(),this.X_()?this.Z_():this.U_.set("Unknown"),[4,this.tl()];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},Gc.prototype.disableNetwork=function(){return u(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.el()];case 1:return t.sent(),this.U_.set("Offline"),[2]}}))}))},Gc.prototype.el=function(){return u(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,this.G_.stop()];case 1:return t.sent(),[4,this.Q_.stop()];case 2:return t.sent(),0<this.N_.length&&(Ys("RemoteStore","Stopping write stream with "+this.N_.length+" pending writes"),this.N_=[]),this.sl(),[2]}}))}))},Gc.prototype.hu=function(){return u(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return Ys("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.el()];case 1:return t.sent(),this.O_.hu(),this.U_.set("Unknown"),[2]}}))}))},Gc.prototype.listen=function(t){this.k_.has(t.targetId)||(this.k_.set(t.targetId,t),this.X_()?this.Z_():this.Q_.qc()&&this.il(t))},Gc.prototype.nl=function(t){this.k_.delete(t),this.Q_.qc()&&this.rl(t),0===this.k_.size&&(this.Q_.qc()?this.Q_.Wc():this.B_()&&this.U_.set("Unknown"))},Gc.prototype.si=function(t){return this.k_.get(t)||null},Gc.prototype.ei=function(t){return this.hl.ei(t)},Gc.prototype.il=function(t){this.M_.Ns(t.targetId),this.Q_.i_(t)},Gc.prototype.rl=function(t){this.M_.Ns(t),this.Q_.n_(t)},Gc.prototype.Z_=function(){this.M_=new Ds(this),this.Q_.start(),this.U_.b_()},Gc.prototype.X_=function(){return this.B_()&&!this.Q_.Bc()&&0<this.k_.size},Gc.prototype.B_=function(){return!this.L_&&this.isPrimary&&this.networkEnabled},Gc.prototype.sl=function(){this.M_=null},Gc.prototype.W_=function(){return u(this,void 0,void 0,(function(){var t=this;return a(this,(function(e){return this.k_.forEach((function(e,n){t.il(e)})),[2]}))}))},Gc.prototype.j_=function(t){return u(this,void 0,void 0,(function(){return a(this,(function(e){return this.sl(),this.X_()?(this.U_.D_(t),this.Z_()):this.U_.set("Unknown"),[2]}))}))},Gc.prototype.K_=function(t,e){return u(this,void 0,void 0,(function(){var n,r,i;return a(this,(function(o){switch(o.label){case 0:if(this.U_.set("Online"),!(t instanceof Ts&&2===t.state&&t.cause))return[3,6];o.label=1;case 1:return o.trys.push([1,3,,5]),[4,this.ol(t)];case 2:return o.sent(),[3,5];case 3:return n=o.sent(),Ys("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),[4,this.al(n)];case 4:return o.sent(),[3,5];case 5:return[3,13];case 6:if(t instanceof bs?this.M_.qs(t):t instanceof Es?this.M_.Hs(t):this.M_.Ws(t),e.isEqual(Vr.min()))return[3,13];o.label=7;case 7:return o.trys.push([7,11,,13]),[4,this.F_.Oo()];case 8:return r=o.sent(),0<=e.S(r)?[4,this.ul(e)]:[3,10];case 9:o.sent(),o.label=10;case 10:return[3,13];case 11:return Ys("RemoteStore","Failed to raise snapshot:",i=o.sent()),[4,this.al(i)];case 12:return o.sent(),[3,13];case 13:return[2]}}))}))},Gc.prototype.al=function(t){return u(this,void 0,void 0,(function(){var e=this;return a(this,(function(n){switch(n.label){case 0:if("IndexedDbTransactionError"!==t.name)throw t;return this.L_=!0,[4,this.el()];case 1:return n.sent(),this.U_.set("Offline"),this.br.Xr((function(){return u(e,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return Ys("RemoteStore","Retrying IndexedDB access"),[4,this.F_.Oo()];case 1:return t.sent(),this.L_=!1,[4,this.J_()];case 2:return t.sent(),[2]}}))}))})),[2]}}))}))},Gc.prototype.ul=function(t){var e=this,n=this.M_.Xs(t);return n.as.forEach((function(n,r){if(0<n.resumeToken.rt()){var i=e.k_.get(r);i&&e.k_.set(r,i.we(n.resumeToken,t))}})),n.us.forEach((function(t){var n=e.k_.get(t);if(n){e.k_.set(t,n.we(ei.ht,n.Ee)),e.rl(t);var r=new Lo(n.target,t,1,n.sequenceNumber);e.il(r)}})),this.hl.Mu(n)},Gc.prototype.ol=function(t){return u(this,void 0,void 0,(function(){var e,n,r,i;return a(this,(function(o){switch(o.label){case 0:e=t.cause,n=0,r=t.targetIds,o.label=1;case 1:return n<r.length?(i=r[n],this.k_.has(i)?[4,this.hl.cl(i,e)]:[3,3]):[3,5];case 2:o.sent(),this.k_.delete(i),this.M_.removeTarget(i),o.label=3;case 3:o.label=4;case 4:return n++,[3,1];case 5:return[2]}}))}))},Gc.prototype.tl=function(){return u(this,void 0,void 0,(function(){var t,e;return a(this,(function(n){switch(n.label){case 0:return this._l()?(t=0<this.N_.length?this.N_[this.N_.length-1].batchId:-1,[4,this.F_.Bu(t)]):[3,5];case 1:return null!==(e=n.sent())?[3,2]:(0===this.N_.length&&this.G_.Wc(),[3,4]);case 2:return this.ll(e),[4,this.tl()];case 3:n.sent(),n.label=4;case 4:n.label=5;case 5:return this.dl()&&this.fl(),[2]}}))}))},Gc.prototype._l=function(){return this.B_()&&this.N_.length<10},Gc.prototype.Tl=function(){return this.N_.length},Gc.prototype.ll=function(t){this.N_.push(t),this.G_.qc()&&this.G_.h_&&this.G_.o_(t.mutations)},Gc.prototype.dl=function(){return this.B_()&&!this.G_.Bc()&&0<this.N_.length},Gc.prototype.fl=function(){this.G_.start()},Gc.prototype.z_=function(){return u(this,void 0,void 0,(function(){return a(this,(function(t){return this.G_.c_(),[2]}))}))},Gc.prototype.Y_=function(){var t=this;return this.F_.fo(this.G_.lastStreamToken).then((function(){for(var e=0,n=t.N_;e<n.length;e++){var r=n[e];t.G_.o_(r.mutations)}})).catch(Th)},Gc.prototype.a_=function(t,e){var n=this,r=this.N_.shift(),i=hu.from(r,t,e,this.G_.lastStreamToken);return this.hl.El(i).then((function(){return n.tl()}))},Gc.prototype.H_=function(t){return u(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return t&&0<this.N_.length?this.G_.h_?[4,this.Il(t)]:[3,2]:[3,5];case 1:return e.sent(),[3,4];case 2:return[4,this.wl(t)];case 3:e.sent(),e.label=4;case 4:this.dl()&&this.fl(),e.label=5;case 5:return[2]}}))}))},Gc.prototype.wl=function(t){return u(this,void 0,void 0,(function(){return a(this,(function(e){return Xo(t.code)?[2,(Ys("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.G_.lastStreamToken),this.G_.lastStreamToken=ei.ht,this.F_.fo(ei.ht).catch(Th))]:[2]}))}))},Gc.prototype.Il=function(t){return u(this,void 0,void 0,(function(){var e,n,r=this;return a(this,(function(i){return Xo(n=t.code)&&n!==Sr.ABORTED?(e=this.N_.shift(),[2,(this.G_.Qc(),this.hl.Rl(e.batchId,t).then((function(){return r.tl()})))]):[2]}))}))},Gc.prototype.Al=function(){return new qc(this.f_)},Gc.prototype.q_=function(){return u(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.el()];case 1:return t.sent(),this.U_.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}}))}))},Gc.prototype.ml=function(){return u(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return this.B_()?(Ys("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.q_()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},Gc.prototype.Pl=function(t){return u(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return(this.isPrimary=t)&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return e.sent(),[3,5];case 2:return t?[3,4]:[4,this.el()];case 3:e.sent(),this.U_.set("Unknown"),e.label=4;case 4:e.label=5;case 5:return[2]}}))}))},Gc);function Gc(t,e,n,r,i){var o,s,h,c,f,l,p,d,y=this;this.F_=t,this.f_=e,this.br=n,this.N_=[],this.k_=new Map,this.M_=null,this.networkEnabled=!1,this.isPrimary=!1,this.L_=!1,this.O_=i,this.O_.x_((function(t){n.$r((function(){return u(y,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return this.B_()?(Ys("RemoteStore","Restarting streams for network reachability change."),[4,this.q_()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.U_=new Fc(n,r),this.Q_=(f=this.f_,l=n,p={t_:this.W_.bind(this),Hc:this.j_.bind(this),s_:this.K_.bind(this)},new Mc(l,(d=f).Mc,d.credentials,d.serializer,p)),this.G_=(o=this.f_,s=n,h={t_:this.z_.bind(this),Hc:this.H_.bind(this),u_:this.Y_.bind(this),a_:this.a_.bind(this)},new Uc(s,(c=o).Mc,c.credentials,c.serializer,h))}function zc(t,e){this.br=t,this.V_=e,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}function Wc(t){this.f_=t,this.T_=ys(),this.mutations=[],this.E_=!1,this.I_=null,this.w_=new Set}function Qc(t,e,n){var r=this;return(r=Pc.call(this)||this).Mc=t,r.credentials=e,r.serializer=n,r}function Kc(t,e,n,r,i){var o=this;return(o=Vc.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.r_=!1,o.lastStreamToken=ei.ht,o}function Hc(t,e,n,r,i){var o=this;return(o=Lc.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Yc(t,e,n,r,i,o){this.Tr=t,this.$c=n,this.Mc=r,this.Lc=i,this.listener=o,this.state=0,this.Oc=0,this.xc=null,this.stream=null,this.Qr=new ku(t,e)}function Xc(t,e){return"firestore_clients_"+t+"_"+e}function $c(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.t()&&(r+="_"+e.uid),r}function Jc(t,e){return"firestore_targets_"+t+"_"+e}function Zc(t){this.key=t}function tf(t){this.key=t}function ef(t,e,n){this.query=t,this.targetId=e,this.view=n}function nf(t){this.key=t,this.Bd=!1}function rf(){this.Pf=void 0,this.Vf=[]}var of,sf,uf=(Uf.Vl=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new kr(r.error.code,r.error.message)),i?new Uf(t,e,r.state,o):(Xs("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Uf.prototype.gl=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Uf),af=(Mf.Vl=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new kr(n.error.code,n.error.message)),r?new Mf(t,n.state,i):(Xs("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Mf.prototype.gl=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Mf),hf=(Cf.Vl=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=ws(),o=0;r&&o<n.activeTargetIds.length;++o)r=oi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Cf(t,i):(Xs("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Cf),cf=(Lf.Vl=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Lf(e.clientId,e.onlineState):(Xs("SharedClientState","Failed to parse online state: "+t),null)},Lf),ff=(Vf.prototype.pl=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Vf.prototype.yl=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Vf.prototype.gl=function(){var t={activeTargetIds:this.activeTargetIds.W(),updateTimeMs:Date.now()};return JSON.stringify(t)},Vf),lf=(Pf.Uh=function(t){return!(!t.window||null==t.window.localStorage)},Pf.prototype.start=function(){return u(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,u,h,c,f,l=this;return a(this,(function(a){switch(a.label){case 0:return[4,this.hl._u()];case 1:for(t=a.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.bl&&(i=this.getItem(Xc(this.persistenceKey,r)))&&(o=hf.Vl(r,i))&&(this.Dl=this.Dl.Ae(o.clientId,o));for(this.Ol(),(s=this.storage.getItem(this.Ll))&&(u=this.xl(s))&&this.Bl(u),h=0,c=this.Cl;h<c.length;h++)f=c[h],this.Sl(f);return this.Cl=[],this.platform.window.addEventListener("unload",(function(){return l.hu()})),this.vh=!0,[2]}}))}))},Pf.prototype.lr=function(t){this.setItem(this.Nl,JSON.stringify(t))},Pf.prototype.ql=function(){return this.Ul(this.Dl)},Pf.prototype.Ql=function(t){var e=!1;return this.Dl.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},Pf.prototype.Wl=function(t){this.jl(t,"pending")},Pf.prototype.Kl=function(t,e,n){this.jl(t,e,n),this.Gl(t)},Pf.prototype.zl=function(t){var e="not-current";if(this.Ql(t)){var n=this.storage.getItem(Jc(this.persistenceKey,t));if(n){var r=af.Vl(t,n);r&&(e=r.state)}}return this.Hl.pl(t),this.Ol(),e},Pf.prototype.Yl=function(t){this.Hl.yl(t),this.Ol()},Pf.prototype.Jl=function(t){return this.Hl.activeTargetIds.has(t)},Pf.prototype.Xl=function(t){this.removeItem(Jc(this.persistenceKey,t))},Pf.prototype.Zl=function(t,e,n){this.td(t,e,n)},Pf.prototype.Su=function(t,e,n){var r=this;e.forEach((function(t){r.Gl(t)})),this.currentUser=t,n.forEach((function(t){r.Wl(t)}))},Pf.prototype.ed=function(t){this.sd(t)},Pf.prototype.hu=function(){this.vh&&(this.platform.window.removeEventListener("storage",this.vl),this.removeItem(this.Fl),this.vh=!1)},Pf.prototype.getItem=function(t){var e=this.storage.getItem(t);return Ys("SharedClientState","READ",t,e),e},Pf.prototype.setItem=function(t,e){Ys("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Pf.prototype.removeItem=function(t){Ys("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Pf.prototype.Sl=function(t){var e=this;if(t.storageArea===this.storage){if(Ys("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Fl)return void Xs("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Tr.Xr((function(){return u(e,void 0,void 0,(function(){var e,n,r,i,o,s;return a(this,(function(u){if(this.vh){if(null!==t.key)if(this.kl.test(t.key)){if(null==t.newValue)return e=this.nd(t.key),[2,this.rd(e,null)];if(n=this.hd(t.key,t.newValue))return[2,this.rd(n.clientId,n)]}else if(this.$l.test(t.key)){if(null!==t.newValue&&(r=this.od(t.key,t.newValue)))return[2,this.ad(r)]}else if(this.Ml.test(t.key)){if(null!==t.newValue&&(i=this.ud(t.key,t.newValue)))return[2,this._d(i)]}else if(t.key===this.Ll){if(null!==t.newValue&&(o=this.xl(t.newValue)))return[2,this.Bl(o)]}else t.key===this.Nl&&(s=function(t){var e=vu.dr;if(null!=t)try{var n=JSON.parse(t);Zs("number"==typeof n),e=n}catch(t){Xs("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(t.newValue))!==vu.dr&&this.ur(s)}else this.Cl.push(t);return[2]}))}))}))}},Object.defineProperty(Pf.prototype,"Hl",{get:function(){return this.Dl.get(this.bl)},enumerable:!0,configurable:!0}),Pf.prototype.Ol=function(){this.setItem(this.Fl,this.Hl.gl())},Pf.prototype.jl=function(t,e,n){var r=new uf(this.currentUser,t,e,n),i=$c(this.persistenceKey,this.currentUser,t);this.setItem(i,r.gl())},Pf.prototype.Gl=function(t){var e=$c(this.persistenceKey,this.currentUser,t);this.removeItem(e)},Pf.prototype.sd=function(t){var e={clientId:this.bl,onlineState:t};this.storage.setItem(this.Ll,JSON.stringify(e))},Pf.prototype.td=function(t,e,n){var r=Jc(this.persistenceKey,t),i=new af(t,e,n);this.setItem(r,i.gl())},Pf.prototype.nd=function(t){var e=this.kl.exec(t);return e?e[1]:null},Pf.prototype.hd=function(t,e){var n=this.nd(t);return hf.Vl(n,e)},Pf.prototype.od=function(t,e){var n=this.$l.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return uf.Vl(new Tr(i),r,e)},Pf.prototype.ud=function(t,e){var n=this.Ml.exec(t),r=Number(n[1]);return af.Vl(r,e)},Pf.prototype.xl=function(t){return cf.Vl(t)},Pf.prototype.ad=function(t){return u(this,void 0,void 0,(function(){return a(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.hl.ld(t.batchId,t.state,t.error)]:(Ys("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},Pf.prototype._d=function(t){return this.hl.dd(t.targetId,t.state,t.error)},Pf.prototype.rd=function(t,e){var n=this,r=e?this.Dl.Ae(t,e):this.Dl.remove(t),i=this.Ul(this.Dl),o=this.Ul(r),s=[],u=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||u.push(t)})),this.hl.fd(s,u).then((function(){n.Dl=r}))},Pf.prototype.Bl=function(t){this.Dl.get(t.clientId)&&this.V_(t.onlineState)},Pf.prototype.Ul=function(t){var e=ws();return t.forEach((function(t,n){e=e.He(n.activeTargetIds)})),e},Pf),pf=(Rf.prototype.Wl=function(t){},Rf.prototype.Kl=function(t,e,n){},Rf.prototype.zl=function(t){return this.Td.pl(t),this.Ed[t]||"not-current"},Rf.prototype.Zl=function(t,e,n){this.Ed[t]=e},Rf.prototype.Yl=function(t){this.Td.yl(t)},Rf.prototype.Jl=function(t){return this.Td.activeTargetIds.has(t)},Rf.prototype.Xl=function(t){delete this.Ed[t]},Rf.prototype.ql=function(){return this.Td.activeTargetIds},Rf.prototype.Ql=function(t){return this.Td.activeTargetIds.has(t)},Rf.prototype.start=function(){return this.Td=new ff,Promise.resolve()},Rf.prototype.Su=function(t,e,n){},Rf.prototype.ed=function(t){},Rf.prototype.hu=function(){},Rf.prototype.lr=function(t){},Rf),df=(Object.defineProperty(Of.prototype,"md",{get:function(){return this.Id},enumerable:!0,configurable:!0}),Of.prototype.Pd=function(t,e){var n=this,r=e?e.Vd:new Ns,i=e?e.Ad:this.Ad,o=e?e.ns:this.ns,s=i,u=!1,a=this.query.oe()&&i.size===this.query.limit?i.last():null,h=this.query.ae()&&i.size===this.query.limit?i.first():null;if(t.pe((function(t,e){var c=i.get(t),f=e instanceof To?e:null;f=f&&(n.query.matches(f)?f:null);var l=!!c&&n.ns.has(c.key),p=!!f&&(f.At||n.ns.has(f.key)&&f.hasCommittedMutations),d=!1;c&&f?c.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.gd(c,f)||(r.track({type:2,doc:f}),d=!0,(a&&0<n.query.se(f,a)||h&&n.query.se(f,h)<0)&&(u=!0)):!c&&f?(r.track({type:0,doc:f}),d=!0):c&&!f&&(r.track({type:1,doc:c}),d=!0,(a||h)&&(u=!0)),d&&(o=f?(s=s.add(f),p?o.add(t):o.delete(t)):(s=s.delete(t),o.delete(t)))})),this.query.oe()||this.query.ae())for(;s.size>this.query.limit;){var c=this.query.oe()?s.last():s.first();s=s.delete(c.key),o=o.delete(c.key),r.track({type:1,doc:c})}return{Ad:s,Vd:r,pd:u,ns:o}},Of.prototype.gd=function(t,e){return t.At&&e.hasCommittedMutations&&!e.At},Of.prototype.xn=function(t,e,n){var r=this,i=this.Ad;this.Ad=t.Ad,this.ns=t.ns;var o=t.Vd.es();o.sort((function(t,e){return i=t.type,o=e.type,n(i)-n(o)||r.query.se(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Js()}}var i,o})),this.yd(n);var s=e?this.bd():[],u=0===this.Rd.size&&this.fs?1:0,a=u!==this.wd;return this.wd=u,0!==o.length||a?{snapshot:new As(this.query,t.Ad,i,o,t.ns,0==u,a,!1),vd:s}:{vd:s}},Of.prototype.Sd=function(t){return this.fs&&"Offline"===t?(this.fs=!1,this.xn({Ad:this.Ad,Vd:new Ns,ns:this.ns,pd:!1},!1)):{vd:[]}},Of.prototype.Dd=function(t){return!this.Id.has(t)&&!!this.Ad.has(t)&&!this.Ad.get(t).At},Of.prototype.yd=function(t){var e=this;t&&(t.Ts.forEach((function(t){return e.Id=e.Id.add(t)})),t.Es.forEach((function(t){})),t.Is.forEach((function(t){return e.Id=e.Id.delete(t)})),this.fs=t.fs)},Of.prototype.bd=function(){var t=this;if(!this.fs)return[];var e=this.Rd;this.Rd=gs(),this.Ad.forEach((function(e){t.Dd(e.key)&&(t.Rd=t.Rd.add(e.key))}));var n=[];return e.forEach((function(e){t.Rd.has(e)||n.push(new tf(e))})),this.Rd.forEach((function(t){e.has(t)||n.push(new Zc(t))})),n},Of.prototype.Cd=function(t){this.Id=t.ju,this.Rd=gs();var e=this.Pd(t.documents);return this.xn(e,!0)},Of.prototype.Fd=function(){return As.os(this.query,this.Ad,this.ns,0===this.wd)},Of),yf=(xf.prototype.$d=function(){this.Md()},xf.prototype.Md=function(){var t=this;this.Qr.gr((function(){return u(t,void 0,void 0,(function(){var t,e,n=this;return a(this,(function(r){return t=this.Nd.Al(),(e=this.Ld(t))&&e.then((function(e){n.br.$r((function(){return t.commit().then((function(){n.Dr.resolve(e)})).catch((function(t){n.Od(t)}))}))})).catch((function(t){n.Od(t)})),[2]}))}))}))},xf.prototype.Ld=function(t){try{var e=this.updateFunction(t);return!ri(e)&&e.catch&&e.then?e:(this.Dr.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Dr.reject(t),null}},xf.prototype.Od=function(t){var e=this;0<this.kd&&this.xd(t)?(--this.kd,this.br.$r((function(){return e.Md(),Promise.resolve()}))):this.Dr.reject(t)},xf.prototype.xd=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Xo(e)},xf),vf=(Object.defineProperty(Df.prototype,"Zd",{get:function(){return!0},enumerable:!0,configurable:!0}),Df.prototype.subscribe=function(t){this.Qd=t},Df.prototype.listen=function(t){return u(this,void 0,void 0,(function(){var e,n,r,i,o;return a(this,(function(s){switch(s.label){case 0:return this.tf("listen()"),(r=this.Wd.get(t))?(e=r.targetId,this.qd.zl(e),n=r.view.Fd(),[3,4]):[3,1];case 1:return[4,this.F_.Uu(t.ee())];case 2:return i=s.sent(),o=this.qd.zl(i.targetId),e=i.targetId,[4,this.ef(t,e,"current"===o)];case 3:n=s.sent(),this.Zd&&this.Nd.listen(i),s.label=4;case 4:return[2,n]}}))}))},Df.prototype.ef=function(t,e,n){return u(this,void 0,void 0,(function(){var r,i,o,s,u,h;return a(this,(function(a){switch(a.label){case 0:return[4,this.F_.Wu(t,!0)];case 1:return r=a.sent(),i=new df(t,r.ju),o=i.Pd(r.documents),s=Ss.ds(e,n&&"Offline"!==this.onlineState),u=i.xn(o,this.Zd,s),this.sf(e,u.vd),h=new ef(t,e,i),[2,(this.Wd.set(t,h),this.jd.has(e)?this.jd.get(e).push(t):this.jd.set(e,[t]),u.snapshot)]}}))}))},Df.prototype.nl=function(t){return u(this,void 0,void 0,(function(){var e,n,r=this;return a(this,(function(i){switch(i.label){case 0:return this.tf("unlisten()"),e=this.Wd.get(t),1<(n=this.jd.get(e.targetId)).length?[2,(this.jd.set(e.targetId,n.filter((function(e){return!e.isEqual(t)}))),void this.Wd.delete(t))]:this.Zd?(this.qd.Yl(e.targetId),this.qd.Ql(e.targetId)?[3,2]:[4,this.F_.Qu(e.targetId,!1).then((function(){r.qd.Xl(e.targetId),r.Nd.nl(e.targetId),r.if(e.targetId)})).catch(Th)]):[3,3];case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return this.if(e.targetId),[4,this.F_.Qu(e.targetId,!0)];case 4:i.sent(),i.label=5;case 5:return[2]}}))}))},Df.prototype.write=function(t,e){return u(this,void 0,void 0,(function(){var n,r;return a(this,(function(i){switch(i.label){case 0:this.tf("write()"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.F_.Nu(t)];case 2:return n=i.sent(),[3,4];case 3:if("IndexedDbTransactionError"===(r=i.sent()).name)return[2,(Xs("SyncEngine","Dropping write that cannot be persisted: "+r),void e.reject(new kr(Sr.UNAVAILABLE,"Failed to persist write: "+r)))];throw r;case 4:return this.qd.Wl(n.batchId),this.nf(n.batchId,e),[4,this.rf(n.Dn)];case 5:return i.sent(),[4,this.Nd.tl()];case 6:return i.sent(),[2]}}))}))},Df.prototype.runTransaction=function(t,e,n){new yf(t,this.Nd,e,n).$d()},Df.prototype.Mu=function(t){return u(this,void 0,void 0,(function(){var e,n=this;return a(this,(function(r){switch(r.label){case 0:this.tf("applyRemoteEvent()"),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.F_.Mu(t)];case 2:return e=r.sent(),t.as.forEach((function(t,e){var r=n.zd.get(e);r&&(Zs(t.Ts.size+t.Es.size+t.Is.size<=1),0<t.Ts.size?r.Bd=!0:0<t.Es.size?Zs(r.Bd):0<t.Is.size&&(Zs(r.Bd),r.Bd=!1))})),[4,this.rf(e,t)];case 3:return r.sent(),[3,6];case 4:return[4,Th(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},Df.prototype.Sd=function(t,e){this.tf("applyOnlineStateChange()");var n=[];this.Wd.forEach((function(e,r){var i=r.view.Sd(t);i.snapshot&&n.push(i.snapshot)})),this.Qd.hf(t),this.Qd.s_(n),this.onlineState=t},Df.prototype.cl=function(t,e){return u(this,void 0,void 0,(function(){var n,r,i,o,s,u=this;return a(this,(function(a){switch(a.label){case 0:return this.tf("rejectListens()"),this.qd.Zl(t,"rejected",e),n=this.zd.get(t),(r=n&&n.key)?(this.Gd=this.Gd.remove(r),this.zd.delete(t),this.af(),i=(i=new Jo(Xr.N)).Ae(r,new Io(r,Vr.min())),o=gs().add(r),s=new _s(Vr.min(),new Map,new os(nu),i,o),[2,this.Mu(s)]):[4,this.F_.Qu(t,!1).then((function(){return u.if(t,e)})).catch(Th)];case 1:return a.sent(),[2]}}))}))},Df.prototype.El=function(t){return u(this,void 0,void 0,(function(){var e,n;return a(this,(function(r){switch(r.label){case 0:this.tf("applySuccessfulWrite()"),e=t.batch.batchId,this.uf(e,null),this.cf(e),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.F_._o(t)];case 2:return n=r.sent(),this.qd.Kl(e,"acknowledged"),[4,this.rf(n)];case 3:return r.sent(),[3,6];case 4:return[4,Th(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},Df.prototype.Rl=function(t,e){return u(this,void 0,void 0,(function(){var n;return a(this,(function(r){switch(r.label){case 0:this.tf("rejectFailedWrite()"),this.uf(t,e),this.cf(t),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.F_.$u(t)];case 2:return n=r.sent(),this.qd.Kl(t,"rejected",e),[4,this.rf(n)];case 3:return r.sent(),[3,6];case 4:return[4,Th(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},Df.prototype._f=function(t){return u(this,void 0,void 0,(function(){var e,n;return a(this,(function(r){switch(r.label){case 0:return this.Nd.B_()||Ys("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.F_.Po()];case 1:return-1===(e=r.sent())?[2,void t.resolve()]:((n=this.Jd.get(e)||[]).push(t),this.Jd.set(e,n),[2])}}))}))},Df.prototype.cf=function(t){(this.Jd.get(t)||[]).forEach((function(t){t.resolve()})),this.Jd.delete(t)},Df.prototype.lf=function(t){this.Jd.forEach((function(e){e.forEach((function(e){e.reject(new kr(Sr.CANCELLED,t))}))})),this.Jd.clear()},Df.prototype.nf=function(t,e){var n=this.Yd[this.currentUser.s()];n=(n=n||new Jo(nu)).Ae(t,e),this.Yd[this.currentUser.s()]=n},Df.prototype.uf=function(t,e){var n=this.Yd[this.currentUser.s()];if(n){var r=n.get(t);r&&(e?r.reject(e):r.resolve(),n=n.remove(t)),this.Yd[this.currentUser.s()]=n}},Df.prototype.if=function(t,e){var n=this;void 0===e&&(e=null),this.qd.Yl(t);for(var r=0,i=this.jd.get(t);r<i.length;r++){var o=i[r];this.Wd.delete(o),e&&this.Qd.df(o,e)}this.jd.delete(t),this.Zd&&this.Hd.ic(t).forEach((function(t){n.Hd.Co(t)||n.ff(t)}))},Df.prototype.ff=function(t){var e=this.Gd.get(t);null!==e&&(this.Nd.nl(e),this.Gd=this.Gd.remove(t),this.zd.delete(e),this.af())},Df.prototype.sf=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof Zc?(this.Hd.Xo(i.key,t),this.Tf(i)):i instanceof tf?(Ys("SyncEngine","Document no longer in limbo: "+i.key),this.Hd.ta(i.key,t),this.Hd.Co(i.key)||this.ff(i.key)):Js()}},Df.prototype.Tf=function(t){var e=t.key;this.Gd.get(e)||(Ys("SyncEngine","New document in limbo: "+e),this.Kd.push(e),this.af())},Df.prototype.af=function(){for(;0<this.Kd.length&&this.Gd.size<this.Ud;){var t=this.Kd.shift(),e=this.Xd.next();this.zd.set(e,new nf(t)),this.Gd=this.Gd.Ae(t,e),this.Nd.listen(new Lo(_o.Wt(t.path).ee(),e,2,vu.dr))}},Df.prototype.Ef=function(){return this.Gd},Df.prototype.If=function(){return this.Kd},Df.prototype.rf=function(t,e){return u(this,void 0,void 0,(function(){var n,r,i,o=this;return a(this,(function(s){switch(s.label){case 0:return n=[],r=[],i=[],this.Wd.forEach((function(s,u){i.push(Promise.resolve().then((function(){var e=u.view.Pd(t);return e.pd?o.F_.Wu(u.query,!1).then((function(t){var n=t.documents;return u.view.Pd(n,e)})):e})).then((function(t){var i=e&&e.as.get(u.targetId),s=u.view.xn(t,o.Zd,i);if(o.sf(u.targetId,s.vd),s.snapshot){o.Zd&&o.qd.Zl(u.targetId,s.snapshot.fromCache?"not-current":"current"),n.push(s.snapshot);var a=yu.ar(u.targetId,s.snapshot);r.push(a)}})))})),[4,Promise.all(i)];case 1:return s.sent(),this.Qd.s_(n),[4,this.F_.xu(r)];case 2:return s.sent(),[2]}}))}))},Df.prototype.tf=function(t){},Df.prototype.ml=function(t){return u(this,void 0,void 0,(function(){var e,n;return a(this,(function(r){switch(r.label){case 0:return e=!this.currentUser.isEqual(t),this.currentUser=t,e?(this.lf("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.F_.Su(t)]):[3,3];case 1:return n=r.sent(),this.qd.Su(t,n.Cu,n.Fu),[4,this.rf(n.Du)];case 2:r.sent(),r.label=3;case 3:return[4,this.Nd.ml()];case 4:return r.sent(),[2]}}))}))},Df.prototype.enableNetwork=function(){return this.Nd.enableNetwork()},Df.prototype.disableNetwork=function(){return this.Nd.disableNetwork()},Df.prototype.ei=function(t){var e=this.zd.get(t);if(e&&e.Bd)return gs().add(e.key);var n=gs(),r=this.jd.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++){var s=o[i],u=this.Wd.get(s);n=n.He(u.view.md)}return n},Df),gf=(s(kf,of=vf),Object.defineProperty(kf.prototype,"Zd",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),kf.prototype.enableNetwork=function(){return this.F_.za(!0),of.prototype.enableNetwork.call(this)},kf.prototype.disableNetwork=function(){return this.F_.za(!1),of.prototype.disableNetwork.call(this)},kf.prototype.wf=function(t){return u(this,void 0,void 0,(function(){var e,n;return a(this,(function(r){switch(r.label){case 0:return[4,this.F_.Wu(t.query,!0)];case 1:return e=r.sent(),n=t.view.Cd(e),[2,(this.isPrimary&&this.sf(t.targetId,n.vd),n)]}}))}))},kf.prototype.Sd=function(t,e){this.Zd&&0===e&&(of.prototype.Sd.call(this,t,e),this.qd.ed(t)),this.Zd||1!==e||of.prototype.Sd.call(this,t,e)},kf.prototype.ld=function(t,e,n){return u(this,void 0,void 0,(function(){var r;return a(this,(function(i){switch(i.label){case 0:return this.tf("applyBatchState()"),[4,this.F_.Gu(t)];case 1:return null===(r=i.sent())?[3,6]:"pending"!==e?[3,3]:[4,this.Nd.tl()];case 2:return i.sent(),[3,4];case 3:"acknowledged"===e||"rejected"===e?(this.uf(t,n||null),this.F_.zu(t)):Js(),i.label=4;case 4:return[4,this.rf(r)];case 5:return i.sent(),[3,7];case 6:Ys("SyncEngine","Cannot apply mutation batch with id: "+t),i.label=7;case 7:return[2]}}))}))},kf.prototype.Pl=function(t){return u(this,void 0,void 0,(function(){var e,n,r,i,o,s,u,h=this;return a(this,(function(a){switch(a.label){case 0:return!0!==t||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.Nd.Pl(!0)]);case 1:return a.sent(),e=this.qd.ql(),[4,this.Rf(e.W())];case 2:for(n=a.sent(),r=0,i=n;r<i.length;r++)o=i[r],this.Nd.listen(o);return[3,7];case 3:return!1!==t||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,s=[],u=Promise.resolve(),this.jd.forEach((function(t,e){h.qd.Jl(e)?s.push(e):u=u.then((function(){return h.if(e),h.F_.Qu(e,!0)})),h.Nd.nl(e)})),[4,u]);case 4:return a.sent(),[4,this.Rf(s)];case 5:return a.sent(),this.Af(),[4,this.Nd.Pl(!1)];case 6:a.sent(),a.label=7;case 7:return[2]}}))}))},kf.prototype.Af=function(){var t=this;this.zd.forEach((function(e,n){t.Nd.nl(n)})),this.Hd.nc(),this.zd=new Map,this.Gd=new Jo(Xr.N)},kf.prototype.Rf=function(t){return u(this,void 0,void 0,(function(){var e,n,r,i,o,s,u,h,c,f,l,p,d;return a(this,(function(a){switch(a.label){case 0:e=[],n=[],r=0,i=t,a.label=1;case 1:return r<i.length?(o=i[r],s=void 0,(u=this.jd.get(o))&&0!==u.length?[4,this.F_.Qu(o,!0)]:[3,8]):[3,14];case 2:return a.sent(),[4,this.F_.Uu(u[0].ee())];case 3:s=a.sent(),h=0,c=u,a.label=4;case 4:return h<c.length?(f=c[h],l=this.Wd.get(f),[4,this.wf(l)]):[3,7];case 5:(p=a.sent()).snapshot&&n.push(p.snapshot),a.label=6;case 6:return h++,[3,4];case 7:return[3,12];case 8:return[4,this.F_.Hu(o)];case 9:return d=a.sent(),[4,this.F_.Uu(d)];case 10:return s=a.sent(),[4,this.ef(this.mf(d),o,!1)];case 11:a.sent(),a.label=12;case 12:e.push(s),a.label=13;case 13:return r++,[3,1];case 14:return[2,(this.Qd.s_(n),e)]}}))}))},kf.prototype.mf=function(t){return new _o(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)},kf.prototype._u=function(){return this.F_._u()},kf.prototype.dd=function(t,e,n){return u(this,void 0,void 0,(function(){var r,i;return a(this,(function(o){switch(o.label){case 0:return this.isPrimary?(Ys("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!this.jd.has(t))return[3,8];switch(e){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,this.F_.la()];case 3:return r=o.sent(),i=_s.ls(t,"current"===e),[4,this.rf(r,i)];case 4:return o.sent(),[3,8];case 5:return[4,this.F_.Qu(t,!0)];case 6:return o.sent(),this.if(t,n),[3,8];case 7:Js(),o.label=8;case 8:return[2]}}))}))},kf.prototype.fd=function(t,e){return u(this,void 0,void 0,(function(){var n,r,i,o,s,u,h,c,f,l,p=this;return a(this,(function(d){switch(d.label){case 0:if(!this.isPrimary)return[3,10];n=0,r=t,d.label=1;case 1:return n<r.length?(i=r[n],this.jd.has(i)?(Ys("SyncEngine","Adding an already active target "+i),[3,5]):[4,this.F_.Hu(i)]):[3,6];case 2:return o=d.sent(),[4,this.F_.Uu(o)];case 3:return s=d.sent(),[4,this.ef(this.mf(o),s.targetId,!1)];case 4:d.sent(),this.Nd.listen(s),d.label=5;case 5:return n++,[3,1];case 6:u=function(t){return a(this,(function(e){switch(e.label){case 0:return h.jd.has(t)?[4,h.F_.Qu(t,!1).then((function(){p.Nd.nl(t),p.if(t)})).catch(Th)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},h=this,c=0,f=e,d.label=7;case 7:return c<f.length?(l=f[c],[5,u(l)]):[3,10];case 8:d.sent(),d.label=9;case 9:return c++,[3,7];case 10:return[2]}}))}))},kf),mf=(Sf.prototype.listen=function(t){return u(this,void 0,void 0,(function(){var e,n,r,i,o,s;return a(this,(function(u){switch(u.label){case 0:if(e=t.query,n=!1,(r=this.gf.get(e))||(n=!0,r=new rf),!n)return[3,4];u.label=1;case 1:return u.trys.push([1,3,,4]),i=r,[4,this.hl.listen(e)];case 2:return i.Pf=u.sent(),[3,4];case 3:if(o=u.sent(),Xs("EventManager",s="Initialization of query '"+e+"' failed: "+o),"IndexedDbTransactionError"!==o.name)throw o;return[2,void t.onError(new kr(Sr.UNAVAILABLE,s))];case 4:return this.gf.set(e,r),r.Vf.push(t),t.Sd(this.onlineState),r.Pf&&t.yf(r.Pf)&&this.bf(),[2]}}))}))},Sf.prototype.nl=function(t){return u(this,void 0,void 0,(function(){var e,n,r,i;return a(this,(function(o){return e=t.query,n=!1,(r=this.gf.get(e))&&0<=(i=r.Vf.indexOf(t))&&(r.Vf.splice(i,1),n=0===r.Vf.length),n?[2,(this.gf.delete(e),this.hl.nl(e))]:[2]}))}))},Sf.prototype.s_=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.gf.get(o);if(s){for(var u=0,a=s.Vf;u<a.length;u++)a[u].yf(i)&&(e=!0);s.Pf=i}}e&&this.bf()},Sf.prototype.df=function(t,e){var n=this.gf.get(t);if(n)for(var r=0,i=n.Vf;r<i.length;r++)i[r].onError(e);this.gf.delete(t)},Sf.prototype.hf=function(t){this.onlineState=t;var e=!1;this.gf.forEach((function(n,r){for(var i=0,o=r.Vf;i<o.length;i++)o[i].Sd(t)&&(e=!0)})),e&&this.bf()},Sf.prototype.vf=function(t){this.pf.add(t),t.next()},Sf.prototype.Sf=function(t){this.pf.delete(t)},Sf.prototype.bf=function(){this.pf.forEach((function(t){t.next()}))},Sf),wf=(_f.prototype.yf=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new As(t.query,t.docs,t.ss,e,t.ns,t.fromCache,t.rs,!0)}var o=!1;return this.Cf?this.Nf(t)&&(this.Df.next(t),o=!0):this.kf(t,this.onlineState)&&(this.$f(t),o=!0),this.Ff=t,o},_f.prototype.onError=function(t){this.Df.error(t)},_f.prototype.Sd=function(t){this.onlineState=t;var e=!1;return this.Ff&&!this.Cf&&this.kf(this.Ff,t)&&(this.$f(this.Ff),e=!0),e},_f.prototype.kf=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Mf&&n||t.docs.B()&&"Offline"!==e)},_f.prototype.Nf=function(t){if(0<t.docChanges.length)return!0;var e=this.Ff&&this.Ff.hasPendingWrites!==t.hasPendingWrites;return!(!t.rs&&!e)&&!0===this.options.includeMetadataChanges},_f.prototype.$f=function(t){t=As.os(t.query,t.docs,t.ns,t.fromCache),this.Cf=!0,this.Df.next(t)},_f),bf=(Af.prototype.vu=function(t){this.Lf=t},Af.prototype.Zn=function(t,e,n,i){var o=this;return e.te()||n.isEqual(Vr.min())?this.Of(t,e):this.Lf.Yn(t,i).next((function(s){var u=o.xf(e,s);return(e.oe()||e.ae())&&o.pd(e.Bt,u,i,n)?o.Of(t,e):(Ks()<=r.DEBUG&&Ys("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),e.toString()),o.Lf.Zn(t,e,n).next((function(t){return u.forEach((function(e){t=t.Ae(e.key,e)})),t})))}))},Af.prototype.xf=function(t,e){var n=new os((function(e,n){return t.se(e,n)}));return e.forEach((function(e,r){r instanceof To&&t.matches(r)&&(n=n.add(r))})),n},Af.prototype.pd=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.S(r))},Af.prototype.Of=function(t,e){return Ks()<=r.DEBUG&&Ys("IndexFreeQueryEngine","Using full collection scan to execute query: %s",e.toString()),this.Lf.Zn(t,e,Vr.min())},Af),Ef=(Nf.prototype.co=function(t){return cu.resolve(0===this.Wn.length)},Nf.prototype._o=function(t,e,n){var r=e.batchId,i=this.Uf(r,"acknowledged");return Zs(0===i),this.Wn[i],this.lastStreamToken=n,cu.resolve()},Nf.prototype.do=function(t){return cu.resolve(this.lastStreamToken)},Nf.prototype.fo=function(t,e){return this.lastStreamToken=e,cu.resolve()},Nf.prototype.To=function(t,e,n,r){var i=this.Bf;this.Bf++,0<this.Wn.length&&this.Wn[this.Wn.length-1];var o=new au(i,e,n,r);this.Wn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.qf=this.qf.add(new Nh(a.key,i)),this.jn.Io(t,a.key.path.M())}return cu.resolve(o)},Nf.prototype.wo=function(t,e){return cu.resolve(this.Qf(e))},Nf.prototype.mo=function(t,e){var n=e+1,r=this.Wf(n),i=r<0?0:r;return cu.resolve(this.Wn.length>i?this.Wn[i]:null)},Nf.prototype.Po=function(){return cu.resolve(0===this.Wn.length?-1:this.Bf-1)},Nf.prototype.Vo=function(t){return cu.resolve(this.Wn.slice())},Nf.prototype.Gn=function(t,e){var n=this,r=new Nh(e,0),i=new Nh(e,Number.POSITIVE_INFINITY),o=[];return this.qf.Ke([r,i],(function(t){var e=n.Qf(t.hc);o.push(e)})),cu.resolve(o)},Nf.prototype.Xn=function(t,e){var n=this,r=new os(nu);return e.forEach((function(t){var e=new Nh(t,0),i=new Nh(t,Number.POSITIVE_INFINITY);n.qf.Ke([e,i],(function(t){r=r.add(t.hc)}))})),cu.resolve(this.jf(r))},Nf.prototype.nr=function(t,e){var n=e.path,r=n.length+1,i=n;Xr.et(i)||(i=i.child(""));var o=new Nh(new Xr(i),0),s=new os(nu);return this.qf.Ge((function(t){var e=t.key.path;return!!n.q(e)&&(e.length===r&&(s=s.add(t.hc)),!0)}),o),cu.resolve(this.jf(s))},Nf.prototype.jf=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.Qf(t);null!==r&&n.push(r)})),n},Nf.prototype.yo=function(t,e){var n=this;Zs(0===this.Uf(e.batchId,"removed")),this.Wn.shift();var r=this.qf;return cu.forEach(e.mutations,(function(i){var o=new Nh(i.key,e.batchId);return r=r.delete(o),n.oo.So(t,i.key)})).next((function(){n.qf=r}))},Nf.prototype.vo=function(t){},Nf.prototype.Co=function(t,e){var n=new Nh(e,0),r=this.qf.ze(n);return cu.resolve(e.isEqual(r&&r.key))},Nf.prototype.Do=function(t){return this.Wn.length,cu.resolve()},Nf.prototype.Uf=function(t,e){return this.Wf(t)},Nf.prototype.Wf=function(t){return 0===this.Wn.length?0:t-this.Wn[0].batchId},Nf.prototype.Qf=function(t){var e=this.Wf(t);return e<0||e>=this.Wn.length?null:this.Wn[e]},Nf),Tf=(If.prototype.Nn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Kf(e);return this.docs=this.docs.Ae(r,{ra:e,size:s,readTime:n}),this.size+=s-o,this.jn.Io(t,r.path.M())},If.prototype.$n=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},If.prototype.Mn=function(t,e){var n=this.docs.get(e);return cu.resolve(n?n.ra:null)},If.prototype.getEntries=function(t,e){var n=this,r=fs();return e.forEach((function(t){var e=n.docs.get(t);r=r.Ae(t,e?e.ra:null)})),cu.resolve(r)},If.prototype.Zn=function(t,e,n){for(var r=ps(),i=new Xr(e.path.child("")),o=this.docs.ve(i);o.ke();){var s=o.Ne(),u=s.key,a=s.value,h=a.ra,c=a.readTime;if(!e.path.q(u.path))break;c.S(n)<=0||h instanceof To&&e.matches(h)&&(r=r.Ae(h.key,h))}return cu.resolve(r)},If.prototype.Gf=function(t,e){return cu.forEach(this.docs,(function(t){return e(t)}))},If.prototype.Ea=function(t){return new If.Ia(this)},If.prototype.Ra=function(t){return cu.resolve(this.size)},If);function If(t,e){this.jn=t,this.Kf=e,this.docs=new Jo(Xr.N),this.size=0}function Nf(t,e){this.jn=t,this.oo=e,this.Wn=[],this.Bf=1,this.lastStreamToken=ei.ht,this.qf=new os(Nh.Ju)}function Af(){}function _f(t,e,n){this.query=t,this.Df=e,this.Cf=!1,this.Ff=null,this.onlineState="Unknown",this.options=n||{}}function Sf(t){this.hl=t,this.gf=new uu((function(t){return t.canonicalId()})),this.onlineState="Unknown",this.pf=new Set,this.hl.subscribe(this)}function kf(t,e,n,r,i){var o=this;return(o=of.call(this,t,e,n,r,i)||this).F_=t,o.isPrimary=void 0,o}function Df(t,e,n,r,i){this.F_=t,this.Nd=e,this.qd=n,this.currentUser=r,this.Ud=i,this.Qd=null,this.Wd=new uu((function(t){return t.canonicalId()})),this.jd=new Map,this.Kd=[],this.Gd=new Jo(Xr.N),this.zd=new Map,this.Hd=new Ih,this.Yd={},this.Jd=new Map,this.Xd=ya.ko(),this.onlineState="Unknown"}function xf(t,e,n,r){this.br=t,this.Nd=e,this.updateFunction=n,this.Dr=r,this.kd=5,this.Qr=new ku(this.br,"transaction_retry")}function Of(t,e){this.query=t,this.Id=e,this.wd=null,this.fs=!1,this.Rd=gs(),this.ns=gs(),this.Ad=new Is(t.se.bind(t))}function Rf(){this.Td=new ff,this.Ed={},this.hl=null,this.V_=null,this.ur=null}function Pf(t,e,n,r,i){if(this.Tr=t,this.platform=e,this.persistenceKey=n,this.bl=r,this.hl=null,this.V_=null,this.ur=null,this.vl=this.Sl.bind(this),this.Dl=new Jo(nu),this.vh=!1,this.Cl=[],!Pf.Uh(this.platform))throw new kr(Sr.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=i,this.Fl=Xc(this.persistenceKey,this.bl),this.Nl="firestore_sequence_number_"+this.persistenceKey,this.Dl=this.Dl.Ae(this.bl,new ff),this.kl=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.$l=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Ml=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Ll="firestore_online_state_"+this.persistenceKey,this.platform.window.addEventListener("storage",this.vl)}function Vf(){this.activeTargetIds=ws()}function Lf(t,e){this.clientId=t,this.onlineState=e}function Cf(t,e){this.clientId=t,this.activeTargetIds=e}function Mf(t,e,n){this.targetId=t,this.state=e,this.error=n}function Uf(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function jf(t){var e=this;return(e=sf.call(this)||this).Aa=t,e}Tf.Ia=(s(jf,sf=fu),jf.prototype.xn=function(t){var e=this,n=[];return this.Dn.forEach((function(r,i){i?n.push(e.Aa.Nn(t,i,e.readTime)):e.Aa.$n(r)})),cu.vn(n)},jf.prototype.Ln=function(t,e){return this.Aa.Mn(t,e)},jf.prototype.On=function(t,e){return this.Aa.getEntries(t,e)},jf);var qf,Ff,Bf=(rl.prototype.js=function(t,e){return this.zf.forEach((function(t,n){return e(n)})),cu.resolve()},rl.prototype.Oo=function(t){return cu.resolve(this.lastRemoteSnapshotVersion)},rl.prototype.xo=function(t){return cu.resolve(this.Hf)},rl.prototype.$o=function(t){return this.highestTargetId=this.Jf.next(),cu.resolve(this.highestTargetId)},rl.prototype.Bo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hf&&(this.Hf=e),cu.resolve()},rl.prototype.Uo=function(t){this.zf.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Jf=new ya(e),this.highestTargetId=e),t.sequenceNumber>this.Hf&&(this.Hf=t.sequenceNumber)},rl.prototype.qo=function(t,e){return this.Uo(e),this.targetCount+=1,cu.resolve()},rl.prototype.Wo=function(t,e){return this.Uo(e),cu.resolve()},rl.prototype.jo=function(t,e){return this.zf.delete(e.target),this.Yf.ic(e.targetId),--this.targetCount,cu.resolve()},rl.prototype.$h=function(t,e,n){var r=this,i=0,o=[];return this.zf.forEach((function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.zf.delete(s),o.push(r.Ko(t,u.targetId)),i++)})),cu.vn(o).next((function(){return i}))},rl.prototype.Ho=function(t){return cu.resolve(this.targetCount)},rl.prototype.Yo=function(t,e){var n=this.zf.get(e)||null;return cu.resolve(n)},rl.prototype.Jo=function(t,e,n){return this.Yf.tc(e,n),cu.resolve()},rl.prototype.Zo=function(t,e,n){this.Yf.sc(e,n);var r=this.persistence.oo,i=[];return r&&e.forEach((function(e){i.push(r.So(t,e))})),cu.vn(i)},rl.prototype.Ko=function(t,e){return this.Yf.ic(e),cu.resolve()},rl.prototype.ea=function(t,e){var n=this.Yf.rc(e);return cu.resolve(n)},rl.prototype.Co=function(t,e){return cu.resolve(this.Yf.Co(e))},rl),Gf=(nl.prototype.start=function(){return Promise.resolve()},nl.prototype.hu=function(){return this.Da=!1,Promise.resolve()},Object.defineProperty(nl.prototype,"vh",{get:function(){return this.Da},enumerable:!0,configurable:!0}),nl.prototype.Ga=function(){},nl.prototype.Tu=function(){return this.jn},nl.prototype.lu=function(t){var e=this.Xf[t.s()];return e||(e=new Ef(this.jn,this.oo),this.Xf[t.s()]=e),e},nl.prototype.du=function(){return this.Oa},nl.prototype.fu=function(){return this.Qn},nl.prototype.runTransaction=function(t,e,n){var r=this;Ys("MemoryPersistence","Starting transaction:",t);var i=new zf(this.ja.next());return this.oo.tT(),n(i).next((function(t){return r.oo.eT(i).next((function(){return t}))})).yn().then((function(t){return i.Un(),t}))},nl.prototype.sT=function(t,e){return cu.Sn(Object.values(this.Xf).map((function(n){return function(){return n.Co(t,e)}})))},nl),zf=(s(el,Ff=pu),el),Wf=(tl.rT=function(t){return new tl(t)},Object.defineProperty(tl.prototype,"hT",{get:function(){if(this.nT)return this.nT;throw Js()},enumerable:!0,configurable:!0}),tl.prototype.Xo=function(t,e,n){return this.iT.Xo(n,e),this.hT.delete(n),cu.resolve()},tl.prototype.ta=function(t,e,n){return this.iT.ta(n,e),this.hT.add(n),cu.resolve()},tl.prototype.So=function(t,e){return this.hT.add(e),cu.resolve()},tl.prototype.removeTarget=function(t,e){var n=this;this.iT.ic(e.targetId).forEach((function(t){return n.hT.add(t)}));var r=this.persistence.du();return r.ea(t,e.targetId).next((function(t){t.forEach((function(t){return n.hT.add(t)}))})).next((function(){return r.jo(t,e)}))},tl.prototype.tT=function(){this.nT=new Set},tl.prototype.eT=function(t){var e=this,n=this.persistence.fu().Ea();return cu.forEach(this.hT,(function(r){return e.oT(t,r).next((function(t){t||n.$n(r)}))})).next((function(){return e.nT=null,n.apply(t)}))},tl.prototype.mu=function(t,e){var n=this;return this.oT(t,e).next((function(t){t?n.hT.delete(e):n.hT.add(e)}))},tl.prototype.Zf=function(t){return 0},tl.prototype.oT=function(t,e){var n=this;return cu.Sn([function(){return cu.resolve(n.iT.Co(e))},function(){return n.persistence.du().Co(t,e)},function(){return n.persistence.sT(t,e)}])},tl),Qf=(Zf.prototype.initialize=function(t){return u(this,void 0,void 0,(function(){var e=this;return a(this,(function(n){switch(n.label){case 0:return this.qd=this.aT(t),this.persistence=this.uT(t),[4,this.persistence.start()];case 1:return n.sent(),this.cT=this._T(t),this.F_=this.lT(t),this.Nd=this.dT(t),this.hl=this.fT(t),this.TT=this.ET(t),this.qd.V_=function(t){return e.hl.Sd(t,1)},this.Nd.hl=this.hl,[4,this.F_.start()];case 2:return n.sent(),[4,this.qd.start()];case 3:return n.sent(),[4,this.Nd.start()];case 4:return n.sent(),[4,this.Nd.Pl(this.hl.Zd)];case 5:return n.sent(),[2]}}))}))},Zf.prototype.ET=function(t){return new mf(this.hl)},Zf.prototype._T=function(t){return null},Zf.prototype.lT=function(t){return new gh(this.persistence,new bf,t.IT)},Zf.prototype.uT=function(t){return new Gf(Wf.rT)},Zf.prototype.dT=function(t){var e=this;return new Bc(this.F_,t.f_,t.br,(function(t){return e.hl.Sd(t,0)}),t.platform.wT())},Zf.prototype.aT=function(t){return new pf},Zf.prototype.fT=function(t){return new vf(this.F_,this.Nd,this.qd,t.IT,t.Ud)},Zf.prototype.clearPersistence=function(t){throw new kr(Sr.FAILED_PRECONDITION,"You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.")},Zf),Kf=(s(Jf,qf=Qf),Jf.prototype.initialize=function(t){return u(this,void 0,void 0,(function(){var e=this;return a(this,(function(n){switch(n.label){case 0:return[4,qf.prototype.initialize.call(this,t)];case 1:return n.sent(),[4,this.persistence.Ka((function(t){return u(e,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.hl.Pl(t)];case 1:return e.sent(),this.cT&&(t&&!this.cT.vh?this.cT.start(this.F_):t||this.cT.stop()),[2]}}))}))}))];case 2:return n.sent(),[2]}}))}))},Jf.prototype.lT=function(t){return new bh(this.persistence,new bf,t.IT)},Jf.prototype.fT=function(t){var e=new gf(this.F_,this.Nd,this.qd,t.IT,t.Ud);return this.qd instanceof lf&&(this.qd.hl=e),e},Jf.prototype._T=function(t){var e=this.persistence.oo.Vh;return new qu(e,t.br)},Jf.prototype.uT=function(t){var e=ah.Iu(t.RT),n=t.platform.yc(t.RT.ii);return new ah(t.AT.synchronizeTabs,e,t.clientId,t.platform,Mu.Eh(t.AT.cacheSizeBytes),t.br,n,this.qd)},Jf.prototype.aT=function(t){if(t.AT.mT&&t.AT.synchronizeTabs){if(!lf.Uh(t.platform))throw new kr(Sr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var e=ah.Iu(t.RT);return new lf(t.br,t.platform,e,t.clientId,t.IT)}return new pf},Jf.prototype.clearPersistence=function(t){var e=ah.Iu(t);return ah.clearPersistence(e)},Jf),Hf=($f.prototype.start=function(t,e){var n=this;this.PT();var r=new Su,i=new Su,o=!1;return this.credentials.l((function(s){if(!o)return o=!0,Ys("FirestoreClient","Initializing. user=",s.uid),n.VT(t,e,s,i).then(r.resolve,r.reject);n.br.$r((function(){return n.ml(s)}))})),this.br.$r((function(){return r.promise})),i.promise},$f.prototype.enableNetwork=function(){var t=this;return this.PT(),this.br.enqueue((function(){return t.hl.enableNetwork()}))},$f.prototype.VT=function(t,e,n,r){return u(this,void 0,void 0,(function(){var i,o,s,h,c=this;return a(this,(function(f){switch(f.label){case 0:return f.trys.push([0,3,,4]),[4,this.platform.gT(this.RT)];case 1:return i=f.sent(),o=this.platform.yc(this.RT.ii),l=i,p=this.credentials,s=new jc(l,p,o),[4,t.initialize({br:this.br,RT:this.RT,platform:this.platform,f_:s,clientId:this.clientId,IT:n,Ud:100,AT:e})];case 2:return f.sent(),this.persistence=t.persistence,this.qd=t.qd,this.F_=t.F_,this.Nd=t.Nd,this.hl=t.hl,this.cT=t.cT,this.pT=t.TT,this.persistence.Ga((function(){return u(c,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}}))}))})),r.resolve(),[3,4];case 3:if(h=f.sent(),r.reject(h),!this.yT(h))throw h;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+h),this.VT(new Qf,{mT:!1},n,r))];case 4:return[2]}var l,p}))}))},$f.prototype.yT=function(t){return"FirebaseError"===t.name?t.code===Sr.FAILED_PRECONDITION||t.code===Sr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},$f.prototype.PT=function(){if(this.br.Kr)throw new kr(Sr.FAILED_PRECONDITION,"The client has already been terminated.")},$f.prototype.ml=function(t){return this.br.th(),Ys("FirestoreClient","Credential Changed. Current user: "+t.uid),this.hl.ml(t)},$f.prototype.disableNetwork=function(){var t=this;return this.PT(),this.br.enqueue((function(){return t.hl.disableNetwork()}))},$f.prototype.terminate=function(){var t=this;return this.br.Jr((function(){return u(t,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return this.cT&&this.cT.stop(),[4,this.Nd.hu()];case 1:return t.sent(),[4,this.qd.hu()];case 2:return t.sent(),[4,this.persistence.hu()];case 3:return t.sent(),this.credentials.T(),[2]}}))}))}))},$f.prototype.waitForPendingWrites=function(){var t=this;this.PT();var e=new Su;return this.br.$r((function(){return t.hl._f(e)})),e.promise},$f.prototype.listen=function(t,e,n){var r=this;this.PT();var i=new wf(t,e,n);return this.br.$r((function(){return r.pT.listen(i)})),i},$f.prototype.nl=function(t){var e=this;this.bT||this.br.$r((function(){return e.pT.nl(t)}))},$f.prototype.vT=function(t){var e=this;return this.PT(),this.br.enqueue((function(){return e.F_.qu(t)})).then((function(t){if(t instanceof To)return t;if(t instanceof Io)return null;throw new kr(Sr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")}))},$f.prototype.ST=function(t){var e=this;return this.PT(),this.br.enqueue((function(){return u(e,void 0,void 0,(function(){var e,n,r;return a(this,(function(i){switch(i.label){case 0:return[4,this.F_.Wu(t,!0)];case 1:return e=i.sent(),n=new df(t,e.ju),r=n.Pd(e.documents),[2,n.xn(r,!1).snapshot]}}))}))}))},$f.prototype.write=function(t){var e=this;this.PT();var n=new Su;return this.br.$r((function(){return e.hl.write(t,n)})),n.promise},$f.prototype.ii=function(){return this.RT.ii},$f.prototype.vf=function(t){var e=this;this.PT(),this.br.$r((function(){return e.pT.vf(t),Promise.resolve()}))},$f.prototype.Sf=function(t){this.bT||this.pT.Sf(t)},Object.defineProperty($f.prototype,"bT",{get:function(){return this.br.Kr},enumerable:!0,configurable:!0}),$f.prototype.transaction=function(t){var e=this;this.PT();var n=new Su;return this.br.$r((function(){return e.hl.runTransaction(e.br,t,n),Promise.resolve()})),n.promise},$f),Yf=(Xf.prototype.next=function(t){this.DT(this.observer.next,t)},Xf.prototype.error=function(t){this.DT(this.observer.error,t)},Xf.prototype.CT=function(){this.muted=!0},Xf.prototype.DT=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},Xf);function Xf(t){this.observer=t,this.muted=!1}function $f(t,e,n,r){this.platform=t,this.RT=e,this.credentials=n,this.br=r,this.clientId=tu.cn()}function Jf(){return null!==qf&&qf.apply(this,arguments)||this}function Zf(){}function tl(t){this.persistence=t,this.iT=new Ih,this.nT=null}function el(t){var e=this;return(e=Ff.call(this)||this).va=t,e}function nl(t){var e=this;this.Xf={},this.ja=new vu(0),this.Da=!1,this.Da=!0,this.oo=t(this),this.Oa=new Bf(this),this.jn=new Ra,this.Qn=new Tf(this.jn,(function(t){return e.oo.Zf(t)}))}function rl(t){this.persistence=t,this.zf=new uu((function(t){return t.canonicalId()})),this.lastRemoteSnapshotVersion=Vr.min(),this.highestTargetId=0,this.Hf=0,this.Yf=new Ih,this.targetCount=0,this.Jf=ya.No()}function il(t){return function(){if("object"==typeof t&&null!==t)for(var e=t,n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return 1}}()}var ol,sl,ul=(Ol.prototype.NT=function(t){switch(hi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return vi(t.integerValue||t.doubleValue);case 3:return this.kT(t.timestampValue);case 4:return this.$T(t);case 5:return t.stringValue;case 6:return new Kh(gi(t.bytesValue));case 7:return this.MT(t.referenceValue);case 8:return this.LT(t.geoPointValue);case 9:return this.OT(t.arrayValue);case 10:return this.xT(t.mapValue);default:throw Js()}},Ol.prototype.xT=function(t){var e=this,n={};return Zr(t.fields||{},(function(t,r){n[t]=e.NT(r)})),n},Ol.prototype.LT=function(t){return new hc(vi(t.latitude),vi(t.longitude))},Ol.prototype.OT=function(t){var e=this;return(t.values||[]).map((function(t){return e.NT(t)}))},Ol.prototype.$T=function(t){switch(this.FT){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return si(n)?t(n):n}(t);return null==e?null:this.NT(e);case"estimate":return this.kT(ui(t));default:return null}},Ol.prototype.kT=function(t){var e=yi(t),n=new Pr(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Ol.prototype.MT=function(t){var e=Cr.K(t);Zs(Gs(e));var n=new su(e.get(1),e.get(3)),r=new Xr(e.$(5));return n.isEqual(this.firestore.Nc)||Xs("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.firestore.Nc.projectId+"/"+this.firestore.Nc.database+") instead."),new pl(r,this.firestore,this.converter)},Ol),al=Mu.Rh,hl=(xl.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},xl),cl=(Dl.prototype.settings=function(t){kh("Firestore.settings",arguments,1),Oh("Firestore.settings","object",1,t);var e=new hl(t);if(this.QT&&!this.zT.isEqual(e))throw new kr(Sr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.zT=e).credentials&&(this.KT=function(t){if(!t)return new Dr;switch(t.type){case"gapi":var e=t.YT;return Zs(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Rr(e,t.V||"0");case"provider":return t.YT;default:throw new kr(Sr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Dl.prototype.enableNetwork=function(){return this.UT(),this.QT.enableNetwork()},Dl.prototype.disableNetwork=function(){return this.UT(),this.QT.disableNetwork()},Dl.prototype.enablePersistence=function(t){var e,n;if(this.QT)throw new kr(Sr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1;return t&&(void 0!==t.experimentalTabSynchronization&&Xs("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n),this.JT(this.GT,{mT:!0,cacheSizeBytes:this.zT.cacheSizeBytes,synchronizeTabs:r})},Dl.prototype.clearPersistence=function(){return u(this,void 0,void 0,(function(){var t,e=this;return a(this,(function(n){if(void 0!==this.QT&&!this.QT.bT)throw new kr(Sr.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return t=new Su,[2,(this.qT.Gr((function(){return u(e,void 0,void 0,(function(){var e,n;return a(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),e=this.XT(),[4,this.GT.clearPersistence(e)];case 1:return r.sent(),t.resolve(),[3,3];case 2:return n=r.sent(),t.reject(n),[3,3];case 3:return[2]}}))}))})),t.promise)]}))}))},Dl.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Dl.prototype,"ZT",{get:function(){return this.UT(),this.QT.bT},enumerable:!0,configurable:!0}),Dl.prototype.waitForPendingWrites=function(){return this.UT(),this.QT.waitForPendingWrites()},Dl.prototype.onSnapshotsInSync=function(t){if(this.UT(),il(t))return this.tE(t);Oh("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.tE(e)},Dl.prototype.tE=function(t){var e=this,n=new Yf({next:function(){t.next&&t.next()},error:function(t){throw Js()}});return this.QT.vf(n),function(){n.CT(),e.QT.Sf(n)}},Dl.prototype.UT=function(){return this.QT||this.JT(new Qf,{mT:!1}),this.QT},Dl.prototype.XT=function(){return new ou(this.Nc,this.jT,this.zT.host,this.zT.ssl,this.zT.forceLongPolling)},Dl.prototype.JT=function(t,e){var n=this.XT();return this.QT=new Hf(zs.nt(),n,this.KT,this.qT),this.QT.start(t,e)},Dl.WT=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new kr(Sr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new kr(Sr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new su(n)},Object.defineProperty(Dl.prototype,"app",{get:function(){if(!this.BT)throw new kr(Sr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.BT},enumerable:!0,configurable:!0}),Dl.prototype.collection=function(t){return kh("Firestore.collection",arguments,1),Oh("Firestore.collection","non-empty string",1,t),this.UT(),new wl(Cr.K(t),this)},Dl.prototype.doc=function(t){return kh("Firestore.doc",arguments,1),Oh("Firestore.doc","non-empty string",1,t),this.UT(),pl.eE(Cr.K(t),this)},Dl.prototype.collectionGroup=function(t){if(kh("Firestore.collectionGroup",arguments,1),Oh("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new kr(Sr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.UT(),new gl(new _o(Cr.G,t),this)},Dl.prototype.runTransaction=function(t){var e=this;return kh("Firestore.runTransaction",arguments,1),Oh("Firestore.runTransaction","function",1,t),this.UT().transaction((function(n){return t(new fl(e,n))}))},Dl.prototype.batch=function(){return this.UT(),new ll(this)},Object.defineProperty(Dl,"logLevel",{get:function(){switch(Ks()){case r.DEBUG:return"debug";case r.SILENT:return"silent";default:return"error"}},enumerable:!0,configurable:!0}),Dl.setLogLevel=function(t){switch(kh("Firestore.setLogLevel",arguments,1),Oh("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":Hs(r.DEBUG);break;case"error":Hs(r.ERROR);break;case"silent":Hs(r.SILENT);break;default:throw new kr(Sr.INVALID_ARGUMENT,"Invalid log level: "+t)}},Dl.prototype.sE=function(){return this.zT.timestampsInSnapshots},Dl),fl=(kl.prototype.get=function(t){var e=this;kh("Transaction.get",arguments,1);var n=Ll("Transaction.get",t,this.iE);return this.nE.R_([n.kc]).then((function(t){if(!t||1!==t.length)return Js();var r=t[0];if(r instanceof Io)return new yl(e.iE,n.kc,null,!1,!1,n.rE);if(r instanceof To)return new yl(e.iE,n.kc,r,!1,!1,n.rE);throw Js()}))},kl.prototype.set=function(t,e,n){xh("Transaction.set",arguments,2,3);var r=Ll("Transaction.set",t,this.iE);n=Rl("Transaction.set",n);var i=Cl(r.rE,e,"Transaction.set"),o=i[0],s=i[1],u=n.merge||n.mergeFields?this.iE.HT.Sc(s,o,n.mergeFields):this.iE.HT.bc(s,o);return this.nE.set(r.kc,u),this},kl.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof Hh?(Dh("Transaction.update",arguments,3),r=Ll("Transaction.update",t,this.iE),this.iE.HT.Cc("Transaction.update",e,n,o)):(kh("Transaction.update",arguments,2),r=Ll("Transaction.update",t,this.iE),this.iE.HT.Dc("Transaction.update",e)),this.nE.update(r.kc,i),this},kl.prototype.delete=function(t){kh("Transaction.delete",arguments,1);var e=Ll("Transaction.delete",t,this.iE);return this.nE.delete(e.kc),this},kl),ll=(Sl.prototype.set=function(t,e,n){xh("WriteBatch.set",arguments,2,3),this.aE();var r=Ll("WriteBatch.set",t,this.iE);n=Rl("WriteBatch.set",n);var i=Cl(r.rE,e,"WriteBatch.set"),o=i[0],s=i[1],u=n.merge||n.mergeFields?this.iE.HT.Sc(s,o,n.mergeFields):this.iE.HT.bc(s,o);return this.hE=this.hE.concat(u.Rc(r.kc,Fi.ft())),this},Sl.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.aE(),i="string"==typeof e||e instanceof Hh?(Dh("WriteBatch.update",arguments,3),r=Ll("WriteBatch.update",t,this.iE),this.iE.HT.Cc("WriteBatch.update",e,n,o)):(kh("WriteBatch.update",arguments,2),r=Ll("WriteBatch.update",t,this.iE),this.iE.HT.Dc("WriteBatch.update",e)),this.hE=this.hE.concat(i.Rc(r.kc,Fi.exists(!0))),this},Sl.prototype.delete=function(t){kh("WriteBatch.delete",arguments,1),this.aE();var e=Ll("WriteBatch.delete",t,this.iE);return this.hE=this.hE.concat(new Qi(e.kc,Fi.ft())),this},Sl.prototype.commit=function(){return this.aE(),this.oE=!0,0<this.hE.length?this.iE.UT().write(this.hE):Promise.resolve()},Sl.prototype.aE=function(){if(this.oE)throw new kr(Sr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Sl),pl=(_l.eE=function(t,e,n){if(t.length%2!=0)throw new kr(Sr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.j()+" has "+t.length);return new _l(new Xr(t),e,n)},Object.defineProperty(_l.prototype,"id",{get:function(){return this.kc.path.O()},enumerable:!0,configurable:!0}),Object.defineProperty(_l.prototype,"parent",{get:function(){return new wl(this.kc.path.M(),this.firestore,this.rE)},enumerable:!0,configurable:!0}),Object.defineProperty(_l.prototype,"path",{get:function(){return this.kc.path.j()},enumerable:!0,configurable:!0}),_l.prototype.collection=function(t){if(kh("DocumentReference.collection",arguments,1),Oh("DocumentReference.collection","non-empty string",1,t),!t)throw new kr(Sr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Cr.K(t);return new wl(this.kc.path.child(e),this.firestore)},_l.prototype.isEqual=function(t){if(!(t instanceof _l))throw Fh("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.kc.isEqual(t.kc)&&this.rE===t.rE},_l.prototype.set=function(t,e){xh("DocumentReference.set",arguments,1,2),e=Rl("DocumentReference.set",e);var n=Cl(this.rE,t,"DocumentReference.set"),r=n[0],i=n[1],o=e.merge||e.mergeFields?this.firestore.HT.Sc(i,r,e.mergeFields):this.firestore.HT.bc(i,r);return this.QT.write(o.Rc(this.kc,Fi.ft()))},_l.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof Hh?(Dh("DocumentReference.update",arguments,2),this.firestore.HT.Cc("DocumentReference.update",t,e,r)):(kh("DocumentReference.update",arguments,1),this.firestore.HT.Dc("DocumentReference.update",t)),this.QT.write(n.Rc(this.kc,Fi.exists(!0)))},_l.prototype.delete=function(){return kh("DocumentReference.delete",arguments,0),this.QT.write([new Qi(this.kc,Fi.ft())])},_l.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];xh("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof t[i]||il(t[i])||(qh("DocumentReference.onSnapshot",r=t[i],["includeMetadataChanges"]),Vh("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return n=il(t[i])?t[i]:(Oh("DocumentReference.onSnapshot","function",i,t[i]),Rh("DocumentReference.onSnapshot","function",i+1,t[i+1]),Rh("DocumentReference.onSnapshot","function",i+2,t[i+2]),{next:t[i],error:t[i+1],complete:t[i+2]}),this.uE(o,n)},_l.prototype.uE=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Yf({next:function(t){if(e.next){var r=t.docs.get(n.kc);e.next(new yl(n.firestore,n.kc,r,t.fromCache,t.hasPendingWrites,n.rE))}},error:r}),o=this.QT.listen(_o.Wt(this.kc.path),i,t);return function(){i.CT(),n.QT.nl(o)}},_l.prototype.get=function(t){var e=this;return xh("DocumentReference.get",arguments,0,1),Vl("DocumentReference.get",t),new Promise((function(n,r){t&&"cache"===t.source?e.firestore.UT().vT(e.kc).then((function(t){n(new yl(e.firestore,e.kc,t,!0,t instanceof To&&t.At,e.rE))}),r):e.cE(n,r,t)}))},_l.prototype.cE=function(t,e,n){var r=this.uE({includeMetadataChanges:!0,Mf:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?e(new kr(Sr.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?e(new kr(Sr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):t(i)},error:e})},_l.prototype.withConverter=function(t){return new _l(this.kc,this.firestore,t)},_l),dl=(Al.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Al),yl=(Nl.prototype.data=function(t){if(xh("DocumentSnapshot.data",arguments,0,1),t=Pl("DocumentSnapshot.data",t),this._E){if(this.rE){var e=new vl(this.iE,this.kc,this._E,this.lE,this.dE);return this.rE.fromFirestore(e,t)}return new ul(this.iE,this.iE.sE(),t.serverTimestamps,void 0).NT(this._E.Mt())}},Nl.prototype.get=function(t,e){if(xh("DocumentSnapshot.get",arguments,1,2),e=Pl("DocumentSnapshot.get",e),this._E){var n=this._E.data().field(xc("DocumentSnapshot.get",t));if(null!==n)return new ul(this.iE,this.iE.sE(),e.serverTimestamps,this.rE).NT(n)}},Object.defineProperty(Nl.prototype,"id",{get:function(){return this.kc.path.O()},enumerable:!0,configurable:!0}),Object.defineProperty(Nl.prototype,"ref",{get:function(){return new pl(this.kc,this.iE,this.rE)},enumerable:!0,configurable:!0}),Object.defineProperty(Nl.prototype,"exists",{get:function(){return null!==this._E},enumerable:!0,configurable:!0}),Object.defineProperty(Nl.prototype,"metadata",{get:function(){return new dl(this.dE,this.lE)},enumerable:!0,configurable:!0}),Nl.prototype.isEqual=function(t){if(!(t instanceof Nl))throw Fh("isEqual","DocumentSnapshot",1,t);return this.iE===t.iE&&this.lE===t.lE&&this.kc.isEqual(t.kc)&&(null===this._E?null===t._E:this._E.isEqual(t._E))&&this.rE===t.rE},Nl),vl=(s(Il,sl=yl),Il.prototype.data=function(t){return sl.prototype.data.call(this,t)},Il),gl=(Tl.prototype.where=function(t,e,n){kh("Query.where",arguments,3),jh("Query.where",3,n);var r,i=function(t,e){if(!t.some((function(t){return t===e})))throw new kr(Sr.INVALID_ARGUMENT,"Invalid value "+Uh(e)+" provided to function Query.where() for its "+Gh(2)+" argument. Acceptable values: "+t.join(", "));return e}(["<","<=","==",">=",">","array-contains","in","array-contains-any"],e),o=xc("Query.where",t);if(o.Y()){if("array-contains"===i||"array-contains-any"===i)throw new kr(Sr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i){this.TE(n,i);for(var s=[],u=0,a=n;u<a.length;u++){var h=a[u];s.push(this.EE(h))}r={arrayValue:{values:s}}}else r=this.EE(n)}else"in"!==i&&"array-contains-any"!==i||this.TE(n,i),r=this.firestore.HT.Fc("Query.where",n,"in"===i);var c=So.create(o,i,r);return this.IE(c),new Tl(this.fE.Gt(c),this.firestore,this.rE)},Tl.prototype.orderBy=function(t,e){var n;if(xh("Query.orderBy",arguments,1,2),Rh("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new kr(Sr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}if(null!==this.fE.startAt)throw new kr(Sr.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.fE.endAt)throw new kr(Sr.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var r=xc("Query.orderBy",t),i=new Vo(r,n);return this.wE(i),new Tl(this.fE.zt(i),this.firestore,this.rE)},Tl.prototype.limit=function(t){return kh("Query.limit",arguments,1),Oh("Query.limit","number",1,t),Bh("Query.limit",1,t),new Tl(this.fE.Ht(t),this.firestore,this.rE)},Tl.prototype.limitToLast=function(t){return kh("Query.limitToLast",arguments,1),Oh("Query.limitToLast","number",1,t),Bh("Query.limitToLast",1,t),new Tl(this.fE.Yt(t),this.firestore,this.rE)},Tl.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Dh("Query.startAt",arguments,1);var r=this.RE("Query.startAt",t,e,!0);return new Tl(this.fE.Jt(r),this.firestore,this.rE)},Tl.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Dh("Query.startAfter",arguments,1);var r=this.RE("Query.startAfter",t,e,!1);return new Tl(this.fE.Jt(r),this.firestore,this.rE)},Tl.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Dh("Query.endBefore",arguments,1);var r=this.RE("Query.endBefore",t,e,!0);return new Tl(this.fE.Xt(r),this.firestore,this.rE)},Tl.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Dh("Query.endAt",arguments,1);var r=this.RE("Query.endAt",t,e,!1);return new Tl(this.fE.Xt(r),this.firestore,this.rE)},Tl.prototype.isEqual=function(t){if(!(t instanceof Tl))throw Fh("isEqual","Query",1,t);return this.firestore===t.firestore&&this.fE.isEqual(t.fE)},Tl.prototype.withConverter=function(t){return new Tl(this.fE,this.firestore,t)},Tl.prototype.RE=function(t,e,n,r){if(jh(t,1,e),e instanceof yl){if(0<n.length)throw new kr(Sr.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new kr(Sr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.AE(i._E,r)}var o=[e].concat(n);return this.mE(t,o,r)},Tl.prototype.AE=function(t,e){for(var n=[],r=0,i=this.fE.orderBy;r<i.length;r++){var o=i[r];if(o.field.Y())n.push(mi(this.firestore.Nc,t.key));else{var s=t.field(o.field);if(si(s))throw new kr(Sr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=o.field.j();throw new kr(Sr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}n.push(s)}}return new Po(n,e)},Tl.prototype.mE=function(t,e,n){var r=this.fE.xt;if(e.length>r.length)throw new kr(Sr.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var s=e[o];if(r[o].field.Y()){if("string"!=typeof s)throw new kr(Sr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.fE._e()&&-1!==s.indexOf("/"))throw new kr(Sr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var u=this.fE.path.child(Cr.K(s));if(!Xr.et(u))throw new kr(Sr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var a=new Xr(u);i.push(mi(this.firestore.Nc,a))}else{var h=this.firestore.HT.Fc(t,s);i.push(h)}}return new Po(i,n)},Tl.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];xh("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||il(t[i])||(qh("Query.onSnapshot",r=t[i],["includeMetadataChanges"]),Vh("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),n=il(t[i])?t[i]:(Oh("Query.onSnapshot","function",i,t[i]),Rh("Query.onSnapshot","function",i+1,t[i+1]),Rh("Query.onSnapshot","function",i+2,t[i+2]),{next:t[i],error:t[i+1],complete:t[i+2]}),this.PE(this.fE),this.uE(r,n)},Tl.prototype.uE=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Yf({next:function(t){e.next&&e.next(new ml(n.firestore,n.fE,t,n.rE))},error:r}),o=this.firestore.UT(),s=o.listen(this.fE,i,t);return function(){i.CT(),o.nl(s)}},Tl.prototype.PE=function(t){if(t.ae()&&0===t.xt.length)throw new kr(Sr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},Tl.prototype.get=function(t){var e=this;return xh("Query.get",arguments,0,1),Vl("Query.get",t),this.PE(this.fE),new Promise((function(n,r){t&&"cache"===t.source?e.firestore.UT().ST(e.fE).then((function(t){n(new ml(e.firestore,e.fE,t,e.rE))}),r):e.cE(n,r,t)}))},Tl.prototype.cE=function(t,e,n){var r=this.uE({includeMetadataChanges:!0,Mf:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?e(new kr(Sr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):t(i)},error:e})},Tl.prototype.EE=function(t){if("string"==typeof t){if(""===t)throw new kr(Sr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.fE._e()&&-1!==t.indexOf("/"))throw new kr(Sr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.fE.path.child(Cr.K(t));if(!Xr.et(e))throw new kr(Sr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return mi(this.firestore.Nc,new Xr(e))}if(t instanceof pl){var n=t;return mi(this.firestore.Nc,n.kc)}throw new kr(Sr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Uh(t)+".")},Tl.prototype.TE=function(t,e){if(!Array.isArray(t)||0===t.length)throw new kr(Sr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new kr(Sr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new kr(Sr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter((function(t){return Number.isNaN(t)})).length)throw new kr(Sr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},Tl.prototype.IE=function(t){if(t instanceof So){var e=["array-contains","array-contains-any"],n=["in","array-contains-any"],r=0<=e.indexOf(t.op),i=0<=n.indexOf(t.op);if(t.ue()){var o=this.fE.jt();if(null!==o&&!o.isEqual(t.field))throw new kr(Sr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.fE.Kt();null!==s&&this.VE(t.field,s)}else if(i||r){var u=null;if(i&&(u=this.fE.ce(n)),null===u&&r&&(u=this.fE.ce(e)),null!=u)throw u===t.op?new kr(Sr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new kr(Sr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+u.toString()+"' filters.")}}},Tl.prototype.wE=function(t){if(null===this.fE.Kt()){var e=this.fE.jt();null!==e&&this.VE(e,t.field)}},Tl.prototype.VE=function(t,e){if(!e.isEqual(t))throw new kr(Sr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},Tl),ml=(Object.defineProperty(El.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!0,configurable:!0}),Object.defineProperty(El.prototype,"empty",{get:function(){return this.pE.docs.B()},enumerable:!0,configurable:!0}),Object.defineProperty(El.prototype,"size",{get:function(){return this.pE.docs.size},enumerable:!0,configurable:!0}),El.prototype.forEach=function(t,e){var n=this;xh("QuerySnapshot.forEach",arguments,1,2),Oh("QuerySnapshot.forEach","function",1,t),this.pE.docs.forEach((function(r){t.call(e,n.vE(r))}))},Object.defineProperty(El.prototype,"query",{get:function(){return new gl(this.gE,this.iE,this.rE)},enumerable:!0,configurable:!0}),El.prototype.docChanges=function(t){t&&(qh("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Vh("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.pE.hs)throw new kr(Sr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.yE&&this.bE===e||(this.yE=function(t,e,n,r){if(n.ss.B()){var i=0;return n.docChanges.map((function(e){var o=new vl(t,e.doc.key,e.doc,n.fromCache,n.ns.has(e.doc.key),r);return e.doc,{type:"added",doc:o,oldIndex:-1,newIndex:i++}}))}var o=n.ss;return n.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var i=new vl(t,e.doc.key,e.doc,n.fromCache,n.ns.has(e.doc.key),r),s=-1,u=-1;return 0!==e.type&&(s=o.indexOf(e.doc.key),o=o.delete(e.doc.key)),1!==e.type&&(u=(o=o.add(e.doc)).indexOf(e.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Js()}}(e.type),doc:i,oldIndex:s,newIndex:u}}))}(this.iE,e,this.pE,this.rE),this.bE=e),this.yE},El.prototype.isEqual=function(t){if(!(t instanceof El))throw Fh("isEqual","QuerySnapshot",1,t);return this.iE===t.iE&&this.gE.isEqual(t.gE)&&this.pE.isEqual(t.pE)&&this.rE===t.rE},El.prototype.vE=function(t){return new vl(this.iE,t.key,t,this.metadata.fromCache,this.pE.ns.has(t.key),this.rE)},El),wl=(s(bl,ol=gl),Object.defineProperty(bl.prototype,"id",{get:function(){return this.fE.path.O()},enumerable:!0,configurable:!0}),Object.defineProperty(bl.prototype,"parent",{get:function(){var t=this.fE.path.M();return t.B()?null:new pl(new Xr(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(bl.prototype,"path",{get:function(){return this.fE.path.j()},enumerable:!0,configurable:!0}),bl.prototype.doc=function(t){if(xh("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=tu.cn()),Oh("CollectionReference.doc","non-empty string",1,t),""===t)throw new kr(Sr.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=Cr.K(t);return pl.eE(this.fE.path.child(e),this.firestore,this.rE)},bl.prototype.add=function(t){kh("CollectionReference.add",arguments,1),Oh("CollectionReference.add","object",1,this.rE?this.rE.toFirestore(t):t);var e=this.doc();return e.set(t).then((function(){return e}))},bl.prototype.withConverter=function(t){return new bl(this.SE,this.firestore,t)},bl);function bl(t,e,n){var r=this;if(((r=ol.call(this,_o.Wt(t),e,n)||this).SE=t).length%2!=1)throw new kr(Sr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.j()+" has "+t.length);return r}function El(t,e,n,r){this.iE=t,this.gE=e,this.pE=n,this.rE=r,this.yE=null,this.bE=null,this.metadata=new dl(n.hasPendingWrites,n.fromCache)}function Tl(t,e,n){this.fE=t,this.firestore=e,this.rE=n}function Il(){return null!==sl&&sl.apply(this,arguments)||this}function Nl(t,e,n,r,i,o){this.iE=t,this.kc=e,this._E=n,this.lE=r,this.dE=i,this.rE=o}function Al(t,e){this.hasPendingWrites=t,this.fromCache=e}function _l(t,e,n){this.kc=t,this.firestore=e,this.rE=n,this.QT=this.firestore.UT()}function Sl(t){this.iE=t,this.hE=[],this.oE=!1}function kl(t,e){this.iE=t,this.nE=e}function Dl(t,e,n){var r=this;if(void 0===n&&(n=new Qf),this.BT=null,this.qT=new xu,this.INTERNAL={delete:function(){return u(r,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return this.UT(),[4,this.QT.terminate()];case 1:return t.sent(),[2]}}))}))}},"object"==typeof t.options){var i=t;this.BT=i,this.Nc=Dl.WT(i),this.jT=i.name,this.KT=new xr(e)}else{var o=t;if(!o.projectId)throw new kr(Sr.INVALID_ARGUMENT,"Must provide projectId");this.Nc=new su(o.projectId,o.database),this.jT="[DEFAULT]",this.KT=new Dr}this.GT=n,this.zT=new hl({}),this.HT=new Ic(this.Nc)}function xl(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new kr(Sr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Ph("settings","non-empty string","host",t.host),this.host=t.host,Vh("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(qh("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),Vh("settings","object","credentials",t.credentials),this.credentials=t.credentials,Vh("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?Xs("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Xs("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,Vh("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Mu.mh;else{if(t.cacheSizeBytes!==al&&t.cacheSizeBytes<Mu.Ah)throw new kr(Sr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Mu.Ah);this.cacheSizeBytes=t.cacheSizeBytes}Vh("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0!==t.experimentalForceLongPolling&&t.experimentalForceLongPolling}function Ol(t,e,n,r){this.firestore=t,this.timestampsInSnapshots=e,this.FT=n,this.converter=r}function Rl(t,e){if(void 0===e)return{merge:!1};if(qh(t,e,["merge","mergeFields"]),Vh(t,"boolean","merge",e.merge),n=t,void 0!==(r=e.mergeFields)&&function(t,e,n,r){if(!(n instanceof Array))throw new kr(Sr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Uh(n));for(var i=0;i<n.length;++i)if(!r(n[i]))throw new kr(Sr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+Uh(n[i]))}(n,"mergeFields",r,(function(t){return"string"==typeof t||t instanceof Hh})),void 0!==e.mergeFields&&void 0!==e.merge)throw new kr(Sr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n,r;return e}function Pl(t,e){return void 0===e?{}:(qh(t,e,["serverTimestamps"]),Lh(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Vl(t,e){Rh(t,"object",1,e),e&&(qh(t,e,["source"]),Lh(t,0,"source",e.source,["default","server","cache"]))}function Ll(t,e,n){if(e instanceof pl){if(e.firestore!==n)throw new kr(Sr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Fh(t,"DocumentReference",1,e)}function Cl(t,e,n){var r;return t?(r=t.toFirestore(e),n="toFirestore() in "+n):r=e,[r,n]}function Ml(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new kr(Sr.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}var Ul,jl=Ml(cl,"Use firebase.firestore() instead."),ql=Ml(fl,"Use firebase.firestore().runTransaction() instead."),Fl=Ml(ll,"Use firebase.firestore().batch() instead."),Bl=Ml(pl,"Use firebase.firestore().doc() instead."),Gl=Ml(yl),zl=Ml(vl),Wl=Ml(gl),Ql=Ml(ml),Kl=Ml(wl,"Use firebase.firestore().collection() instead."),Hl=Ml((up.delete=function(){return Sh("FieldValue.delete",arguments),new ic},up.serverTimestamp=function(){return Sh("FieldValue.serverTimestamp",arguments),new oc},up.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Dh("FieldValue.arrayUnion",arguments,1),new sc(t)},up.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Dh("FieldValue.arrayRemove",arguments,1),new uc(t)},up.increment=function(t){return Oh("FieldValue.increment","number",1,t),kh("FieldValue.increment",arguments,1),new ac(t)},up.prototype.isEqual=function(t){return this===t},up),"Use FieldValue.<field>() instead."),Yl=Ml(Kh,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),Xl={Firestore:jl,GeoPoint:hc,Timestamp:Pr,Blob:Yl,Transaction:ql,WriteBatch:Fl,DocumentReference:Bl,DocumentSnapshot:Gl,Query:Wl,QueryDocumentSnapshot:zl,QuerySnapshot:Ql,CollectionReference:Kl,FieldPath:Hh,FieldValue:Hl,setLogLevel:cl.setLogLevel,CACHE_SIZE_UNLIMITED:al},$l=(sp.prototype.x_=function(t){},sp.prototype.hu=function(){},sp),Jl=(op.prototype.x_=function(t){this.kE.push(t)},op.prototype.hu=function(){window.removeEventListener("online",this.DE),window.removeEventListener("offline",this.FE)},op.prototype.$E=function(){window.addEventListener("online",this.DE),window.addEventListener("offline",this.FE)},op.prototype.CE=function(){Ys("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.kE;t<e.length;t++)(0,e[t])(0)},op.prototype.NE=function(){Ys("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.kE;t<e.length;t++)(0,e[t])(1)},op.Uh=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},op),Zl=(ip.prototype.t_=function(t){this.OE=t},ip.prototype.Hc=function(t){this.xE=t},ip.prototype.onMessage=function(t){this.BE=t},ip.prototype.close=function(){this.LE()},ip.prototype.send=function(t){this.ME(t)},ip.prototype.qE=function(){this.OE()},ip.prototype.UE=function(t){this.xE(t)},ip.prototype.QE=function(t){this.BE(t)},ip),tp={BatchGetDocuments:"batchGet",Commit:"commit"},ep="gl-js/ fire/"+Er,np=(rp.prototype.jE=function(t,e){if(e)for(var n in e.o)e.o.hasOwnProperty(n)&&(t[n]=e.o[n]);t["X-Goog-Api-Client"]=ep},rp.prototype.l_=function(t,e,n){var r=this,i=this.KE(t);return new Promise((function(o,s){var u=new br;u.listenOnce(mr.COMPLETE,(function(){try{switch(u.getLastErrorCode()){case gr.NO_ERROR:var e=u.getResponseJson();Ys("Connection","XHR received:",JSON.stringify(e)),o(e);break;case gr.TIMEOUT:Ys("Connection",'RPC "'+t+'" timed out'),s(new kr(Sr.DEADLINE_EXCEEDED,"Request time out"));break;case gr.HTTP_ERROR:var n=u.getStatus();if(Ys("Connection",'RPC "'+t+'" failed with status:',n,"response text:",u.getResponseText()),0<n){var r=u.getResponseJson().error;if(r&&r.status&&r.message){var i=(a=r.status.toLowerCase().replace("_","-"),0<=Object.values(Sr).indexOf(a)?a:Sr.UNKNOWN);s(new kr(i,r.message))}else s(new kr(Sr.UNKNOWN,"Server responded with status "+u.getStatus()))}else Ys("Connection",'RPC "'+t+'" failed'),s(new kr(Sr.UNAVAILABLE,"Connection failed."));break;default:Js()}}finally{Ys("Connection",'RPC "'+t+'" completed.')}var a}));var a=Object.assign({},e);delete a.database;var h=JSON.stringify(a);Ys("Connection","XHR sending: ",i+" "+h);var c={"Content-Type":"text/plain"};r.jE(c,n),u.send(i,"POST",h,c,15)}))},rp.prototype.d_=function(t,e,n){return this.l_(t,e,n)},rp.prototype.e_=function(t,e){var n,r,i=[this.WE,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=vr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.ii.projectId+"/databases/"+this.ii.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.jE(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(v())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=v().indexOf("Electron/")||0<=(r=v()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=v().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){h.listen(t,(function(t){try{e(t)}catch(t){setTimeout((function(){throw t}),0)}}))}Ys("Connection","Creating WebChannel: "+u+" "+s);var h=o.createWebChannel(u,s),c=!1,f=!1,l=new Zl({ME:function(t){f?Ys("Connection","Not sending because WebChannel is closed:",t):(c||(Ys("Connection","Opening WebChannel transport."),h.open(),c=!0),Ys("Connection","WebChannel sending:",t),h.send(t))},LE:function(){return h.close()}});return a(wr.EventType.OPEN,(function(){f||Ys("Connection","WebChannel transport opened.")})),a(wr.EventType.CLOSE,(function(){f||(f=!0,Ys("Connection","WebChannel transport closed"),l.UE())})),a(wr.EventType.ERROR,(function(t){f||(f=!0,Ys("Connection","WebChannel transport errored:",t),l.UE(new kr(Sr.UNAVAILABLE,"The operation could not be completed")))})),a(wr.EventType.MESSAGE,(function(t){var e;if(!f){var n=t.data[0];Zs(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){Ys("Connection","WebChannel received error:",r);var i=r.status,o=function(){var t=co[i];if(void 0!==t)return $o(t)}(),s=r.message;void 0===o&&(o=Sr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),f=!0,l.UE(new kr(o,s)),h.close()}else Ys("Connection","WebChannel received:",n),l.QE(n)}})),setTimeout((function(){l.qE()}),0),l},rp.prototype.KE=function(t){var e=tp[t];return this.WE+"/v1/projects/"+this.ii.projectId+"/databases/"+this.ii.database+"/documents:"+e},rp);function rp(t){this.ii=t.ii;var e=t.ssl?"https":"http";this.WE=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function ip(t){this.ME=t.ME,this.LE=t.LE}function op(){var t=this;this.DE=function(){return t.CE()},this.FE=function(){return t.NE()},this.kE=[],this.$E()}function sp(){}function up(){}function ap(){this.oc="undefined"!=typeof atob}zs.an((Object.defineProperty(ap.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(ap.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),ap.prototype.gT=function(t){return Promise.resolve(new np(t))},ap.prototype.wT=function(){return new(Jl.Uh()?Jl:$l)},ap.prototype.yc=function(t){return new Fs(t,{hi:!0})},ap.prototype.un=function(t){return JSON.stringify(t)},ap.prototype.atob=function(t){return atob(t)},ap.prototype.btoa=function(t){return btoa(t)},ap.prototype._n=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n},new ap)),(Ul=e).INTERNAL.registerComponent(new I("firestore",(function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new cl(e,n,new Kf);var e,n}),"PUBLIC").setServiceProps(Object.assign({},Xl))),Ul.registerVersion("@firebase/firestore","1.14.4")}).apply(this,arguments)}catch(n){throw console.error(n),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}}(n("wj3C"))}).call(this,n("yLpj"))}}]);
//# sourceMappingURL=66eeed8d-0fb9ecbe77703376d9ce.js.map